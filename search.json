[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Base de donn√©es relationnelles",
    "section": "",
    "text": "6h de cours\n18h de TP/TD"
  },
  {
    "objectID": "index.html#contenu-du-cours",
    "href": "index.html#contenu-du-cours",
    "title": "Base de donn√©es relationnelles",
    "section": "Contenu du cours",
    "text": "Contenu du cours\n\nLes bases de donn√©es\n\nLes bases de donn√©es relationnelles\n\nIntroduction au langage SQL\n\nCr√©er des tables\nLire des tables\n\nLes Agr√©gations\nL‚ÄôAlg√©bre relationnelle\nLes jointures\nSQL avanc√© (Vues, Index, Droits, CTE)\nMod√©lisation UML\n\nFormes normales"
  },
  {
    "objectID": "index.html#tp",
    "href": "index.html#tp",
    "title": "Base de donn√©es relationnelles",
    "section": "TP",
    "text": "TP\n\nTP1 : Premi√®re requ√™tes SQL\n\nDuckDB, fichier parquet des pr√©noms\nSELECT, WHERE, ORDER BY, GROUP BY\n\nTP2 : Exercices vintages\n\nLocation de DVD, Ecole de musique, Rugby\nINNER JOIN, CREATE TABLE, DATE\n\nTP3 : Discographie\n\nHAVING, INSERT, SEQUENCE, LEFT JOIN\n\nTP4 : Chess\n\nUPDATE, LEFT JOIN, EXISTS\n\nTP5 : ?\nTD6 : Mod√©lisation\n\nD√©pendances fonctionnelles, Formes Normales, UML"
  },
  {
    "objectID": "doc/glossaire.html",
    "href": "doc/glossaire.html",
    "title": "Glossaire",
    "section": "",
    "text": "üöß"
  },
  {
    "objectID": "doc/glossaire.html#table",
    "href": "doc/glossaire.html#table",
    "title": "Glossaire",
    "section": "Table",
    "text": "Table\nStructure de donn√©es dans une base de donn√©es relationnelle qui contient :\n\ndes lignes repr√©sentant des entit√©s\ndes colonnes repr√©sentant un attribut de ces entit√©s\n\nSynonymes : Relation\n\nLigne\nUn ensemble de valeurs correspondant √† un objet ou une entit√© dans une table.\nSynonymes : Enregistrement, Entit√©, Tuple, Observation\n\n\nColonne\nUne structure verticale dans une table qui contient un type sp√©cifique de donn√©es.\nSynonymes : Attribut, Champs, Propri√©t√©, Variable, Dimension\n\n\nCl√© primaire\nUn champ ou un ensemble de champs qui identifie de mani√®re unique chaque ligne d‚Äôune table.\n\n\nCl√© √©trang√®re\nUn champ dans une table qui est une r√©f√©rence √† la cl√© primaire d‚Äôune autre table.\nElle est utilis√©e pour √©tablir une relation entre deux tables."
  },
  {
    "objectID": "doc/glossaire.html#bases-de-donn√©es",
    "href": "doc/glossaire.html#bases-de-donn√©es",
    "title": "Glossaire",
    "section": "Bases de Donn√©es",
    "text": "Bases de Donn√©es\n\nDonn√©e : information brute compos√©e d‚Äôun concept, d‚Äôun domaine des possibles, d‚Äôune valeur.\nM√©tadonn√©e : donn√©e qui d√©crit d‚Äôautres donn√©es (contenu, structure, contexte‚Ä¶). Par exemple, pour une photo, les m√©tadonn√©es pourraient inclure la date de prise de vue, le lieu, des mots-cl√©s d√©crivant le contenu‚Ä¶\n\n\n\nBase de donn√©es (BDD) : Un ensemble organis√© de donn√©es, g√©n√©ralement stock√©es et accessibles √©lectroniquement. Elle est utilis√©e pour faciliter la gestion, la r√©cup√©ration, l‚Äôajout, la mise √† jour et la suppression des donn√©es.\nSyst√®me de Gestion de Base de Donn√©es (SGBD) : Logiciel permettant de cr√©er, g√©rer et manipuler des bases de donn√©es. Il permet la gestion des donn√©es et des utilisateurs via des interfaces (commandes SQL, API, etc.).\nPostgreSQL : Un syst√®me de gestion de base de donn√©es relationnelle open-source avanc√©. Il supporte les types de donn√©es complexes, la gestion des transactions, les index, les jointures, et d‚Äôautres fonctionnalit√©s avanc√©es.\npgAdmin : Interface graphique pour administrer des bases de donn√©es PostgreSQL. Elle permet de cr√©er, modifier, supprimer des objets de base de donn√©es, et d‚Äôex√©cuter des requ√™tes SQL."
  },
  {
    "objectID": "doc/glossaire.html#sql-structured-query-language",
    "href": "doc/glossaire.html#sql-structured-query-language",
    "title": "Glossaire",
    "section": "SQL (Structured Query Language)",
    "text": "SQL (Structured Query Language)\n\nSQL : Un langage standardis√© pour interagir avec des bases de donn√©es relationnelles. SQL permet de cr√©er, lire, mettre √† jour et supprimer des donn√©es (CRUD).\n\n\nManipulation de donn√©es\n\nINSERT INTO : Ins√©rer de nouvelles lignes dans une table\nUPDATE : Modifier les donn√©es existantes dans une table\nDELETE : Supprimer des lignes dans une table.\nSELECT : S√©lectionner les colonnes √† afficher\nFROM : choisir la table contenant les donn√©es\nJOIN : joindre d‚Äôautres tables\nWHERE : Filter les lignes\nGROUP BY : Agr√©ger les lignes selon un ou plusieurs attributs\nHAVING : Filtrer les r√©sultats apr√®s agr√©gation\nORDER BY : Trier les lignes selon un ou plusieurs crit√®res\nDISTINCT : Mot-cl√© utilis√© pour √©liminer les doublons dans les r√©sultats d‚Äôune requ√™te.\nCTE (Common Table Expression) : Une sous-requ√™te qui peut √™tre utilis√©e dans une requ√™te principale pour am√©liorer la lisibilit√© et la structure des requ√™tes complexes.\n\n\n\nD√©finition de Donn√©es\n\nCREATE : Cr√©er des tables, des vues, des index‚Ä¶\nALTER : Modifier la structure d‚Äôune table\nDROP : Supprimer une table ou un autre objet dans une base de donn√©es\nINDEX : Structure de donn√©es permettant de rendre les recherches plus rapides sur des colonnes de tables\nSEQUENCE : G√©n√®re des valeurs num√©riques uniques, souvent utilis√©e pour les valeurs de cl√©s primaires auto-incr√©ment√©es\nTRIGGER\nSCHEMA : Utilis√© pour organiser une base de donn√©es. Un sch√©ma peut contenir des tables, des vues, des fonctions‚Ä¶\n\n\n\nTransaction\n\nTRANSACTION : Un bloc de commandes SQL qui peut √™tre valid√© (COMMIT) ou annul√© (ROLLBACK) dans son ensemble\nCOMMIT : Commande permettant de valider une transaction\nROLLBACK : Commande permettant d‚Äôannuler une transaction et de revenir √† l‚Äô√©tat ant√©rieur\nACID : Propri√©t√©s des transactions garantissant leur int√©grit√© : Atomicit√©, Coh√©rence, Isolation, Durabilit√©.\n\n\n\nAcc√®s aux donn√©es\n\nGRANT\nREVOKE\n\n\n\nFormes Normales\n\nhttps://formations.imt-atlantique.fr/bd_ihm/fr/normalisation/normal_forms/"
  },
  {
    "objectID": "doc/outils/datalab.html",
    "href": "doc/outils/datalab.html",
    "title": "Utilisation du Datalab",
    "section": "",
    "text": "Pour les besoin des TP, nous aurons besoin des outils suivants :\n\nune base de donn√©es (PostrgeSQL)\nun outil pour communiquer avec cette base de donn√©es (cloudBeaver)"
  },
  {
    "objectID": "doc/outils/datalab.html#introduction",
    "href": "doc/outils/datalab.html#introduction",
    "title": "Utilisation du Datalab",
    "section": "",
    "text": "Pour les besoin des TP, nous aurons besoin des outils suivants :\n\nune base de donn√©es (PostrgeSQL)\nun outil pour communiquer avec cette base de donn√©es (cloudBeaver)"
  },
  {
    "objectID": "doc/outils/datalab.html#principe",
    "href": "doc/outils/datalab.html#principe",
    "title": "Utilisation du Datalab",
    "section": "1 Principe",
    "text": "1 Principe\nLes datalabs sont compos√©s :\n\nd‚Äôune infrastructure cloud on premise (‚â† cloud propri√©taire : AWS, GCP, OVH‚Ä¶ )\n\ni.e.¬†h√©berg√©e dans les locaux de l‚ÄôINSEE et du GENES\navec des ressources √† votre disposition (CPU, GPU, RAM, Stockage)\n\nde l‚Äôapplication Onyxia\n\nelle offre une interface pour utiliser cette infrastructure pour lancer des services\nsans avoir √† utiliser de commandes ‚Äúcomplexes‚Äù\n\n\nLorsque vous en avez besoin, vous :\n\nr√©servez des ressources (en lan√ßant des services)\nlancez vos programmes, calculs‚Ä¶\nsauvegardez votre code en utilisant Git\nexportez vos r√©sultats vers le stockage objet S3\nlib√©rez les ressources une fois que vous avez termin√©\n\nPour vous aider, l‚Äôinterface Onyxia vous permet de faire cela en quelques clics."
  },
  {
    "objectID": "doc/outils/datalab.html#lancement-des-services",
    "href": "doc/outils/datalab.html#lancement-des-services",
    "title": "Utilisation du Datalab",
    "section": "2 Lancement des services",
    "text": "2 Lancement des services\nLes datalabs de l‚ÄôINSEE et du GENES proposent les services n√©cessaires.\n\n2.1 Se connecter\nConnectez-vous √† l‚Äôune des 2 instances suivantes d‚ÄôOnyxia :\n\nDatalab du GENES\nSSP Cloud de l‚ÄôINSEE\n\nsi besoin de cr√©er un compte, utilisez votre mail ENSAI : nom.prenom@eleve.ensai.fr\n\n\n\n\n\n\n\n\nTip\n\n\n\nIl est fortement recommand√© d‚Äôutiliser en priorit√© le SSP Cloud qui est plus stable.\n\n\n\n\n2.2 PostgreSQL\n\nLancez le service PostgreSQL\n\nCatalogue de services ‚û°Ô∏è Databases\n\n\nLorsque vous lancez le services, les param√®tres de connexion √† cette base de donn√©es sont affich√©s.\nUne fois le service lanc√©, vous pouvez toujours acc√©der √† ces param√®tres via le bouton README.\n\nCopiez ces param√®tres de connexion :\n\nHostname\nPort : 5432\nDatabase : defaultdb\nUsername\nPassword\n\n\nElles serviront pour vous connecter √† cette base de donn√©es depuis le service cloudBeaver\n\n\n2.3 CloudBeaver\nNous venons de cr√©er un SGBD, nous avons maintenant besoin d‚Äôun outil de gestion pour s‚Äôy connecter et envoyer des requ√™tes.\n\nLancez le service CloudBeaver\nCopiez username et password\nOuvrez ce service\n\nCollez username et password\n\n\nNormalement la connexion √† la base de donn√©es PostgreSQL est d√©tect√©e automatiquement.\nSi c‚Äôest le cas, elle apparait dans l‚Äôexplorer √† gauche qui contient la liste des connexions.\n\n\n\n\n\n\nTipSi la connexion PostgreSQL n‚Äôapparait pas\n\n\n\nDans cloudBeaver :\n\nCr√©ez une nouvelle connexion\n\ncliquez sur le + en haut √† gauche ‚û°Ô∏è New connection ‚û°Ô∏è PostgreSQL\n\nRenseignez les param√®tres de connexion de la base de donn√©es\n\nHostname, Port, Database, Username, Password\n\nTestez la connexion\nCliquez sur le bouton CREATE\n\n\n\nIl faut maintenant ouvrir la connexion :\n\nClic droit sur la connexion ‚û°Ô∏è Open\n\nEnfin, ouvrez une fen√™tre SQL pour saisir vos requ√™tes :\n\nClic droit sur la connexion ‚û°Ô∏è SQL Editor\n\nVous pouvez lancer quelques requ√™tes simples pour v√©rifier que tout fonctionne.\nSELECT 1;\n\nSELECT NOW();\n\nSELECT current_database();\n\nSELECT version();"
  },
  {
    "objectID": "doc/outils/datalab.html#arr√™t-des-services",
    "href": "doc/outils/datalab.html#arr√™t-des-services",
    "title": "Utilisation du Datalab",
    "section": "3 Arr√™t des services",
    "text": "3 Arr√™t des services\nUne fois le TP termin√©, il est important de lib√©rer les ressources r√©serv√©es i.e.¬†arr√™ter / mettre en pause vos services :\n\nCopiez votre code et collez le sur votre machine dans un fichier .sql\n\npar exemple dans P:/Cours1A/UE3-Bases-de-donnees-relationnelles/tpx.sql\nou en t√©l√©chargeant depuis CloudBeaver le fichier sql (petit bouton avec un dossier et une fl√®che vers le bas)\n\nRetournez sur le Datalab ‚û°Ô∏è Mes Services\nSupprimez vos services"
  },
  {
    "objectID": "doc/outils/tp-datalab.html",
    "href": "doc/outils/tp-datalab.html",
    "title": "D√©couverte du Datalab",
    "section": "",
    "text": "Le Datalab permet aux statisticiens de d√©couvrir, d‚Äôexp√©rimenter, d‚Äôapprendre, de se former aux outils de la data.\n\n\nDans le monde professionnel, plusieurs probl√®mes se posent au statisticien :\n\nsa machine n‚Äôest pas assez puissante\ninstaller certains logiciels est parfois interdit et bloqu√© par le syst√®me\nil doit analyser des donn√©es sensibles en toute s√©curit√©\n\n√Ä l‚ÄôINSEE, un projet est n√© pour pallier √† ce besoin : Onyxia port√© par le lab de l‚ÄôINSEE.\nLa premi√®re √©tape fut de cr√©er une infrastructure Cloud avec des CPUs, des GPUs, de la RAM et du stockage.\nEnsuite, avoir plein de ressources c‚Äôest tr√®s bien, mais encore faut-il savoir les utiliser. Or lancer des services dans le cloud n√©cessite quelques comp√©tences sp√©cifiques (Docker, Kubernetes, Helm, S3‚Ä¶) qui ne sont pas √† la port√©e de tous.\nD‚Äôo√π l‚Äôid√©e de cr√©er une interface graphique pour pouvoir lancer des services en quelques clics. Onyxia s‚Äôappuie sur des technologies sous-jacentes (Kubernetes, Helm, S3‚Ä¶) pour proposer une IHM agr√©able pour le datascientist. Cependant, la philosophie du projet Onyxia est d‚Äô√™tre une brique qui facilite le travail sans se rendre indispensable. L‚Äôid√©e est d‚Äô√©viter que les utilisateurs ne s‚Äôenferment dans un choix technologique et qu‚Äôil soit couteux d‚Äôen sortir.\n√Ä l‚ÄôINSEE, une instance de ce logiciel a √©t√© install√©e sur le Datalab SSP Cloud, ouverte √† tous les agents publics. Vous pouvez y cr√©er un compte car c‚Äôest √©galement ouvert √† tous les √©l√®ves de l‚ÄôENSAI (en utilisant votre mail ENSAI).\n\n\n\n\n\n\nWarning\n\n\n\nNe d√©posez pas de donn√©es sensibles sur cette instance, ni sur celle du GENES.\nPour celles et ceux qui iront √† l‚ÄôINSEE, une autre instance nomm√©e LS3 n‚Äôest accessible qu‚Äôen interne et autorise l‚Äôutilisation de donn√©es sensibles.\n\n\nOnyxia est un logiciel Libre et Open Source. Chacun peut installer sa propre instance sur son infra. C‚Äôest ce qu‚Äôont fait de nombreux organismes, ainsi que le GENES.\n\n\n\n\nLe principe est d‚Äôoffrir aux utilisateurs la possibilit√© de lancer de nombreux services √† la demande (Jupyter, Rstudio, VSCode, PostgreSQL‚Ä¶) avec une puissance de calcul adapt√©e aux besoins.\n\n\n\n\n\n\nCaution\n\n\n\nCes services sont √©ph√©m√®res, car si les ressources sont importantes, il faut savoir les partager !\nLe principe g√©n√©ral est le suivant :\n\nVous lancez votre service en r√©servant des ressources (CPU, GPU, RAM, Stockage)\nVous effectuez votre travail\nVous sauvegardez votre code (git) et vos r√©sultats (MinIO)\nVous supprimez votre service et lib√©rez les ressources"
  },
  {
    "objectID": "doc/outils/tp-datalab.html#introduction",
    "href": "doc/outils/tp-datalab.html#introduction",
    "title": "D√©couverte du Datalab",
    "section": "",
    "text": "Le Datalab permet aux statisticiens de d√©couvrir, d‚Äôexp√©rimenter, d‚Äôapprendre, de se former aux outils de la data.\n\n\nDans le monde professionnel, plusieurs probl√®mes se posent au statisticien :\n\nsa machine n‚Äôest pas assez puissante\ninstaller certains logiciels est parfois interdit et bloqu√© par le syst√®me\nil doit analyser des donn√©es sensibles en toute s√©curit√©\n\n√Ä l‚ÄôINSEE, un projet est n√© pour pallier √† ce besoin : Onyxia port√© par le lab de l‚ÄôINSEE.\nLa premi√®re √©tape fut de cr√©er une infrastructure Cloud avec des CPUs, des GPUs, de la RAM et du stockage.\nEnsuite, avoir plein de ressources c‚Äôest tr√®s bien, mais encore faut-il savoir les utiliser. Or lancer des services dans le cloud n√©cessite quelques comp√©tences sp√©cifiques (Docker, Kubernetes, Helm, S3‚Ä¶) qui ne sont pas √† la port√©e de tous.\nD‚Äôo√π l‚Äôid√©e de cr√©er une interface graphique pour pouvoir lancer des services en quelques clics. Onyxia s‚Äôappuie sur des technologies sous-jacentes (Kubernetes, Helm, S3‚Ä¶) pour proposer une IHM agr√©able pour le datascientist. Cependant, la philosophie du projet Onyxia est d‚Äô√™tre une brique qui facilite le travail sans se rendre indispensable. L‚Äôid√©e est d‚Äô√©viter que les utilisateurs ne s‚Äôenferment dans un choix technologique et qu‚Äôil soit couteux d‚Äôen sortir.\n√Ä l‚ÄôINSEE, une instance de ce logiciel a √©t√© install√©e sur le Datalab SSP Cloud, ouverte √† tous les agents publics. Vous pouvez y cr√©er un compte car c‚Äôest √©galement ouvert √† tous les √©l√®ves de l‚ÄôENSAI (en utilisant votre mail ENSAI).\n\n\n\n\n\n\nWarning\n\n\n\nNe d√©posez pas de donn√©es sensibles sur cette instance, ni sur celle du GENES.\nPour celles et ceux qui iront √† l‚ÄôINSEE, une autre instance nomm√©e LS3 n‚Äôest accessible qu‚Äôen interne et autorise l‚Äôutilisation de donn√©es sensibles.\n\n\nOnyxia est un logiciel Libre et Open Source. Chacun peut installer sa propre instance sur son infra. C‚Äôest ce qu‚Äôont fait de nombreux organismes, ainsi que le GENES.\n\n\n\n\nLe principe est d‚Äôoffrir aux utilisateurs la possibilit√© de lancer de nombreux services √† la demande (Jupyter, Rstudio, VSCode, PostgreSQL‚Ä¶) avec une puissance de calcul adapt√©e aux besoins.\n\n\n\n\n\n\nCaution\n\n\n\nCes services sont √©ph√©m√®res, car si les ressources sont importantes, il faut savoir les partager !\nLe principe g√©n√©ral est le suivant :\n\nVous lancez votre service en r√©servant des ressources (CPU, GPU, RAM, Stockage)\nVous effectuez votre travail\nVous sauvegardez votre code (git) et vos r√©sultats (MinIO)\nVous supprimez votre service et lib√©rez les ressources"
  },
  {
    "objectID": "doc/outils/tp-datalab.html#objectifs",
    "href": "doc/outils/tp-datalab.html#objectifs",
    "title": "D√©couverte du Datalab",
    "section": "Objectifs",
    "text": "Objectifs\nCe TP d‚Äôinitiation va vous permettre de :\n\nLancer vos premiers services\nVous familiariser avec l‚Äôespace de stockage S3\nConfigurer votre compte sur le datalab\n\n\n\n\n\n\n\nImportantFil rouge\n\n\n\nVos coll√®gues Josette et F√©lix attendent un heureux √©v√©nement. Ils avaient trouv√© le pr√©nom id√©al pour leur enfant √† na√Ætre.\nCependant, un malencontreux accident de fer √† repasser les a rendu amn√©siques tous les deux.\nVotre mission, si vous l‚Äôacceptez, est de retrouver ce fameux pr√©nom. Pour cela, vous allez devoir explorer les fonctionnalit√©s du Datalab."
  },
  {
    "objectID": "doc/outils/tp-datalab.html#se-connecter",
    "href": "doc/outils/tp-datalab.html#se-connecter",
    "title": "D√©couverte du Datalab",
    "section": "1 Se connecter",
    "text": "1 Se connecter\nVous pouvez r√©aliser ce TP soit sur :\n\nLe Datalab du GENES\nLe Datalab SSPCloud de l‚ÄôINSEE\n\nsi besoin de cr√©er un compte, utilisez votre mail ENSAI"
  },
  {
    "objectID": "doc/outils/tp-datalab.html#lancer-un-service",
    "href": "doc/outils/tp-datalab.html#lancer-un-service",
    "title": "D√©couverte du Datalab",
    "section": "2 Lancer un service",
    "text": "2 Lancer un service\n\n\n\n\n\n\nImportantFil rouge\n\n\n\nAvant de partir √† la recherche du pr√©nom, Josette a une envie de doubitchou.\nVous retrouvez la recette, mais il vous manque la quantit√© exacte en grammes de margarine.\nVous savez simplement que la valeur recherch√©e correspond √† combien il y a de nombres premiers entre 10 000 et 100 000.\nNaturellement, vous vous dites que la solution la plus simple est de cr√©er un programme Python pour trouver la r√©ponse. Or, Python n‚Äôest pas install√© sur votre machine et vous ne savez pas comment faire‚Ä¶ Mais alors : pourquoi ne pas lancer un service du Datalab qui permet d‚Äôex√©cuter du Python.\n\n\n\n2.1 Un premier service\n\nAllez dans Catalogue de services\nS√©lectionnez le service Jupyter-python, puis cliquez deux fois sur Lancer\n\nAttendez quelques secondes le temps que le service se lance.\n\nCliquez pour copier le mot de passe\nCliquez sur Ouvrir le service üöÄ\n\npassword : collez le mot de passe\n\n\nVotre service Jupyter Python s‚Äôouvre.\n\n\n\n\n\n\nNoteCe qu‚Äôil se passe sous le capot\n\n\n\n\n\nPour plus de d√©tails, vous pouvez consulter la vid√©o en bas de la page.\nPrenons l‚Äôexemple de ce qu‚Äôil se passe en arri√®re plan lorsque vous lancez un service Vscode-python :\n\nConstruction de l‚Äôimage Docker\nUne image Docker est un paquet l√©ger et autonome qui contient tout le n√©cessaire pour ex√©cuter une application : le code, les biblioth√®ques, les d√©pendances, les variables d‚Äôenvironnement et les fichiers de configuration.\nLes images Docker permettent de cr√©er des environnements isol√©s et coh√©rents, garantissant ainsi la portabilit√© et la reproductibilit√© des applications.\n\nNous partons de l‚Äôimage de base d‚ÄôOnyxia\n\nubuntu:22.04 et quelques √©l√©ments de config\n\nNous ajoutons la couche python-minimal\n\ninstallation de python et quelques packages classiques\n\nNous ajoutons la couche python-datascience\n\nJulia, Quarto et des packages de datascience (numpy, pandas‚Ä¶)\n\nNous ajoutons la couche vscode\n\nInstallation de Visual Studio Code et configuration\n\n\nVous avez maintenant une image Docker avec tout ce qu‚Äôil faut pour bien travailler.\n\n\nDockerHub\nCette image est construite et d√©pos√©e sur DockerHub onyxia-vscode-python.\nNous allons ensuite lancer une instance de cette image : un conteneur.\nUne image est comme un moule, et un conteneur est un objet fabriqu√© √† partir de ce moule. L‚Äôimage contient les instructions, et le conteneur est l‚Äôinstance concr√®te cr√©√©e √† partir de ce mod√®le. Vous verrez le m√™me principe dans le cours de POO avec les classes (mod√®les) et les objets (instances)\nPour g√©rer tous les conteneurs lanc√©s sur le datalab, nous avons besoin d‚Äôun orchestrateur : Kubernetes.\n\n\nChart Helm\nCependant, nous allons d‚Äôabord utiliser Helm pour faciliter le d√©ploiement.\nHelm simplifie le processus de d√©ploiement d‚Äôapplications sur Kubernetes en automatisant les t√¢ches r√©p√©titives et en fournissant une gestion centralis√©e des configurations.\nLe chart Helm vscode-python est un ensemble de fichiers de configuration qui facilite le d√©ploiement d‚Äôapplication dans un envrionnement Kubernetes.\n\n\nD√©ploiement sur Kube\nKubernetes (K8s) est un syst√®me open-source qui automatise le d√©ploiement, la mise √† l‚Äô√©chelle et la gestion d‚Äôapplications conteneuris√©es. C‚Äôest un orchestrateur de conteneurs.\nK8s r√©cup√©re via le chart Helm toutes les infos n√©cessaires et d√©ploie le conteneur (cr√©√© √† partir de l‚Äôimage Docker) sur l‚Äôinfra du datalab.\n\n\n\n\n\nCr√©ez un Notebook Python\n\nFile ‚û°Ô∏è New ‚û°Ô∏è Notebook\n\nDans la cellule, √©crivez un code Python qui permet de compter combien il y a de nombres premiers entre 10 000 et 100 000\n\nPour vous aider, vous pouvez utiliser cette fonction qui g√©n√©re une liste de bool√©ens.\ndef crible_eratosthene(n) -&gt; list[bool]:\n    \"\"\"G√©n√®re une liste de bool√©ens o√π True indique qu'un nombre est premier.\"\"\"\n\n    est_premier = [True] * (n + 1)\n    est_premier[0] = est_premier[1] = False  # 0 et 1 ne sont pas premiers\n\n    for i in range(2, int(n**0.5) + 1):\n        if est_premier[i]:\n            for multiple in range(i * i, n + 1, i):\n                est_premier[multiple] = False\n\n    return est_premier\n\n\n\n\n\n\nTip\n\n\n\nN‚Äôh√©sitez pas √† cr√©er plusieurs cellules pour d√©couper votre code (petites icones avec des +)\n\n\nComme vous √™tes un as de la programmation, cela ne vous prend que trois minutes. C‚Äôest beaucoup plus rapide que si vous aviez du installer Python, ainsi qu‚Äôun environnement d‚Äôex√©cution.\n\nV√©rifiez que le r√©sultat est lui m√™me un nombre premier\n\nNotez le vous en aurez besoin √† la fin\n\n\n\n\n2.2 Utiliser des donn√©es\n\n\n\n\n\n\nImportantFil rouge\n\n\n\nVous vous rendez compte qu‚Äôil faut plus de 8 kg de margarine et que vous n‚Äôen avez pas assez dans le frigo.\nF√©lix propose d‚Äôaller en chercher √† la superette du coin. Il entre dans l‚Äôascenseur pour descendre les 6 √©tages et patatra, il se retrouve bloqu√©.\nPour retrouver les 5 chiffres du num√©ro du d√©panneur, vous allez devoir r√©pondre √† 5 questions en requ√™tant le fichier des communes fran√ßaises.\n\n\n\n\n\n\n\n\nNoteCOG\n\n\n\nChaque ann√©e, l‚ÄôINSEE publie sur son site le Code officiel g√©ographique (COG).\nCe r√©f√©rentiel regroupe, au 1er janvier, les codes et libell√©s des communes, cantons, arrondissements, d√©partements, r√©gions, ainsi que ceux des pays et territoires √©trangers.\n\n\nVous allez utiliser via DuckDB du SQL dans du code Python. Commencez par importer le package et cr√©er la vue vers le fichier des communes 2024.\nimport duckdb\n\nduckdb.sql(\"\"\"\nCREATE OR REPLACE VIEW commune AS\nFROM 'https://www.insee.fr/fr/statistiques/fichier/7766585/v_commune_2024.csv';\n\"\"\")\nPour ex√©cuter une requ√™te :\nduckdb.sql(\"\"\"\nSELECT *\n  FROM commune\n\"\"\")\n\n\n\n\n\n\nTip\n\n\n\nPour avoir un affichage plus joli, vous pouvez convertir la sortie en du dataframe pandas avec la m√©thode to_df().\nimport pandas as pd\n\nduckdb.sql(\"\"\"\nSELECT *\n  FROM commune\n\"\"\").to_df()\n\n\n\nQuel est le code r√©gion de Mayotte ?\nCombien de communes y a-t-il en Guyane ?\nParmi les 3 d√©partements de la Picardie (Aisne, Oise, Somme), combien de communes ont au minimum 4 L dans leur nom ?\nAffichez le nombre de communes par d√©partement\n\nClassez par nombre de communes d√©croissant\nQuel est le num√©ro du d√©partement se classant au 20e rang ?\n\nQuel est le num√©ro du d√©partement dans lequel se trouve le nom de commune le plus long\n\n\n\n\n\n\n\nTip\n\n\n\n\n\n\nLa somme des 5 nombres vaut 149\nLes nombres sont dans l‚Äôordre croissant\n\n\n\n\nVous venez ici d‚Äôutiliser des donn√©es disponibles sur internet. Vous pouvez √©galement effectuer des traitements sur vos propres donn√©es en les stockant sur S3."
  },
  {
    "objectID": "doc/outils/tp-datalab.html#stockage-s3",
    "href": "doc/outils/tp-datalab.html#stockage-s3",
    "title": "D√©couverte du Datalab",
    "section": "3 Stockage S3",
    "text": "3 Stockage S3\n\n\n\n\n\n\nNoteD√©finition\n\n\n\nS3 : Simple Storage System.\nInvent√© par Amazon, ce syst√®me de stockage est devenu l‚Äôoutil standard du march√© pour le stockage en ligne.\nMinIO est une solution alternative de stockage d‚Äôobjets open-source qui permet de d√©ployer facilement un stockage √©volutif et performant. Elle est compatible avec l‚ÄôAPI S3 d‚ÄôAmazon, ce qui facilite l‚Äôint√©gration avec les applications existantes.\nPour faire simple, vous pouvez vous dire que c‚Äôest comme si vous allez stocker vos fichiers dans un Drive.\n\n\nLorsque l‚Äôon travaille dans le cloud, il est essentiel de s√©parer les donn√©es des programmes pour :\n\nmieux g√©rer les ressources\nrenforcer la s√©curit√© en limitant les acc√®s et les permissions\npermettre une scalabilit√© ind√©pendante des composants\n\nMinIO offre :\n\nune haute disponibilit√©\nune s√©curit√© renforc√©e gr√¢ce au chiffrement des donn√©es et des contr√¥les d‚Äôacc√®s\ndes performances √©lev√©es, particuli√®rement adapt√©es aux environnements n√©cessitant un acc√®s rapide aux donn√©es, comme le Big Data et l‚Äôintelligence artificielle\n\n\n3.1 Votre bucket\n\n\n\n\n\n\nNoteD√©finition\n\n\n\nUn bucket est un conteneur de stockage utilis√© pour regrouper des objets (fichiers et m√©tadonn√©es) dans des syst√®mes de stockage de type cloud. Il facilite l‚Äôorganisation, la gestion des permissions et l‚Äôacc√®s aux donn√©es dans un espace de stockage structur√©.\n\n\nLors de votre cr√©ation de compte, un bucket est cr√©√© avec votre nom d‚Äôutilisateur. Dans ce bucket, vous pouvez :\n\ncr√©er / supprimer des dossiers\nimporter / supprimer des fichiers\n\nVous avez plusieurs possibilit√©s pour g√©rer √† votre stockage :\n\nDepuis le Datalab, onglet Mes fichiers\nDepuis la console MinIO :\n\nhttps://minio-console.lab.sspcloud.fr/\nhttps://minio-simple.lab.groupe-genes.fr\n\nDepuis un terminal avec le client Minio\n\n\n\n3.2 Stocker vos fichiers\n\n\n\n\n\n\nImportantFil rouge\n\n\n\nF√©lix est sauv√©, il peut maintenant aller chercher de la margarine et du papier cadeau (√ßa peut toujours servir).\nEn attendant, Josette s‚Äôoccupe en confectionnant un superbe gilet gris avec son amie Th√©r√®se.\nElle se souvient qu‚Äôelle a not√© quelque part la longueur de fil n√©cessaire dans un fichier csv.\n\n\n\nT√©l√©chargez ce fichier parquet\n\nEnsuite, allez sur la page d‚Äôaccueil du Datalab :\n\nAllez dans Mes fichiers\nCr√©ez un dossier ENSAI puis √† l‚Äôint√©rieur un dossier SQL\nT√©l√©versez votre fichier parquet dans le dossier SQL\n\n\n\n\n\n\n\nTipChemin vers mes fichiers\n\n\n\nVous remarquerez √† droite, des lignes de commande du type mc cp tp3-longueur-fil.parquet s3/&lt;username&gt;/ENSAI/SQL/tp3-longueur-fil.parquet.\nCe sont des commandes pour interagir avec votre stockage depuis un terminal (voir ci-apr√®s).\nCependant, vous pouvez extraire de ces commandes une information int√©ressante : le chemin vers votre fichier : s3/&lt;username&gt;/ENSAI/SQL/tp3-longueur-fil.parquet.\n\n\nVous venez de charger un fichier, voyons maintenant comment y acc√©der dans un Service, en utilisant par exemple le notebook que vous avez d√©j√† lanc√©.\n\n\n3.3 Utiliser des donn√©es\nSur la page d‚Äôaccueil du Datalab :\n\nAllez dans Mon Compte, puis dans l‚Äôonglet Connexion au Stockage\n\nVous trouverez ici des informations pour vous connecter au stockage selon le language que vous utilisez : Python, R‚Ä¶\nD‚Äôailleurs pour chaque langage, il y a m√™me plusieurs packages qui font le job. Par exemple s3fs ou boto3 pour Python.\nRetournez dans votre service Notebook Jupyter :\n\nCr√©ez un nouveau Notebook\n\nvous pouvez par exemple le nommer S3.ipynb\n\nCr√©er 2 cellules, puis collez et ex√©cutez les 2 blocs de code ci-dessous\n\nCommencez par importer les packages n√©cessaires et r√©cup√©rer les valeurs des variables d‚Äôenvironnement pour pouvoir se connecter √† votre stockage.\nimport os\nimport polars as pl\n\ns3_endpoint = f'https://{os.environ[\"AWS_S3_ENDPOINT\"]}'\ns3_access_key = os.environ[\"AWS_ACCESS_KEY_ID\"]\ns3_secret_access_key = os.environ[\"AWS_SECRET_ACCESS_KEY\"]\ns3_session_token = os.environ[\"AWS_SESSION_TOKEN\"]\ns3_region = os.environ[\"AWS_DEFAULT_REGION\"]\n\ns3_username = os.environ[\"VAULT_TOP_DIR\"] # un peu bancal pour avoir le username\n\n\n\n\n\n\nWarning\n\n\n\nLes cl√©s et les jetons ont une dur√©e de vie limit√©e.\nSi vous laissez votre service ouvert trop longtemps (pas bien !), vos cl√©s et jetons pourraient √™tre expir√©s.\nDans ce cas, vous pouvez recharger en dur les nouvelles valeurs (voir Mon Compte &gt; Connexion au Stockage).\n\n\nD√©finissez le chemin o√π se trouve votre fichier et lisez le avec Polars.\ns3_file_path = f\"s3://{s3_username}/ENSAI/SQL/tp3-longueur-fil.parquet\"\n\nstorage_options = {\n    \"aws_endpoint\":  s3_endpoint,\n    \"aws_access_key_id\": s3_access_key,\n    \"aws_secret_access_key\": s3_secret_access_key,\n    \"aws_token\": s3_session_token,\n    \"aws_region\": s3_region\n  }\n\nfile = pl.scan_parquet(source=s3_file_path, \n                     storage_options=storage_options)\n\n\n\n\n\n\nNotePolars\n\n\n\nPolars est une biblioth√®que rapide et performante pour la manipulation de donn√©es en Python et Rust, optimis√©e pour les grands volumes de donn√©es.\nContrairement √† Pandas, Polars utilise une approche orient√©e colonnes (columnar) et tire parti du traitement parall√®le, ce qui le rend particuli√®rement adapt√© pour les op√©rations analytiques lourdes.\nSa syntaxe, proche de celle de Pandas, permet des transformations, agr√©gations et manipulations de donn√©es avec des m√©thodes performantes et expressives.\nPour plus de d√©tails : https://ssphub.netlify.app/post/polars/\n\n\n\nCr√©ez une troisi√®me cellule et affichez le fichier charg√©\n\nQue se passe-t-il ?\n\n\n\n\n\n\n\n\nImportantMode Lazy\n\n\n\nVous avez appel√© la m√©thode scan_parquet() qui correspond au mode Lazy de Polars.\nLe mode Lazy signifie que Polars va accumuler toutes les instructions que vous lui donnez sans pour autant les ex√©cuter tout de suite.\nMais quel est l‚Äôint√©r√™t ?\nImaginons que vous √™tes en train d‚Äôanalyser un tr√©s gros fichier et que vous enchainez √† la suite diverses op√©rations (filtres, s√©lections de colonnes, regroupements, agr√©gations, tri‚Ä¶), deux choix s‚Äôoffrent √† vous :\nOption 1 (mode Eager : pl.read_parquet()):\n\nvous chargez tout le fichier en RAM (dans la m√©moire de votre machine)\nvous appliquez des op√©rations dans n‚Äôimporte quel ordre\nvous lancez, c‚Äôest long et √ßa rame‚Ä¶\n\nOption 2 (mode Lazy : pl.scan_parquet()):\n\nvous scannez le fichier, i.e.¬†analyser sa structure (types de colonnes) et ses m√©tadonn√©es\nvous donnez vos op√©rations dans n‚Äôimporte quel ordre\n√† la fin, vous demandez √† Polars de vous fournir le r√©sultat\n√† ce moment, Polars va optimiser l‚Äôordre des traitements en utilisant son propre plan d‚Äôex√©cution et vous donner une r√©ponse beaucoup plus rapide\n\nEn r√©sum√©, en mode Eager, √† chaque √©tape la machine effectue b√™tement tous les calculs que vous lui demandez. En mode Lazy, la machine liste les op√©rations que vous demandez. Puis lorsque vous exigez un r√©sultat, l‚Äôordre des op√©rations est optimis√© et la r√©ponse est beaucoup plus rapide.\n\n\n\nPour demander le chargement du fichier, appelez la m√©thode collect()\n\nstockez le r√©sultat dans une variable df\n\nVous pouvez maintenant afficher le contenu de df avec un print\n\nEn appelant la m√©thode collect(), vous avez ¬´ forc√© ¬ª Polars √† charger les donn√©es en m√©moire.\n\nAppliquez au dataframe la m√©thode filter() pour trouver la longueur de fil du gilet\n\ndf.filter(pl.col(\"&lt;column_name&gt;\") == \"&lt;value&gt;\")\n\n\n\n\n3.4 Donn√©es d‚Äôautres utilisateurs\n\n\n\n\n\n\nImportantFil rouge\n\n\n\nPendant que Josette confectionne son gilet, F√©lix revient avec la margarine.\nOr, Josette n‚Äôa finalement plus faim. F√©lix se met alors √† bouder et va s‚Äôenfermer dans les toilettes pour avaler des pilules qu‚Äôil a prises au passage √† la pharmacie. Soudain, la m√©moire lui revient !\nIl se rappelle qu‚Äôils avaient trouv√© le pr√©nom en parcourant‚Ä¶ Le fichier des pr√©noms !\n\n\nCe fichier est stock√© sur le bucket d‚Äôun autre utilisateur √† l‚Äôune des adresses suivante :\n\nSSP Cloud : s3://ludo2ne/diffusion/ENSAI/SQL-TP/prenoms-nat2022.parquet\nDatalab du GENES : s3://ldeneuville-ensai/diffusion/ENSAI/SQL-TP/prenoms-nat2022.parquet\n\n\n\n\n\n\n\nImportant\n\n\n\nMalheureusement sur le Datalab du GENES, la fonctionnalit√© n‚Äôest pas encore impl√©ment√©e sur le Datalab du GENES.\nLes dossiers diffusion de chaque utilisateur ne sont pas accessibles en lecture.\nCe n‚Äôest plus trop dans la philosophie de l‚Äôexercice, mais pour contourner le probl√®me :\n\nT√©l√©chargez le fichier des prenoms\nStockez le sur votre S3\nUtilisez ce fichier pour la suite\n\n\n\n\n\n\n\n\n\nNoteDiffusion\n\n\n\n√Ä la racine de votre Bucket, vous pouvez cr√©er un dossier nomm√© diffusion.\nVous pourrez alors stocker √† l‚Äôint√©rieur les dossiers et fichiers que vous souhaitez partager aux autres utilisateurs. Ils auront un droit d‚Äôacc√®s en lecture sur votre dossier diffusion.\n\n\n\nScannez ce fichier avec Polars\n\nstockez-le dans une variable nomm√©e fichier_prenoms\n\nUtilisez le code ci-dessous pour afficher le top10 des pr√©noms f√©minins en 2022\n\ntop10f2021 = fichier_prenoms\\\n    .filter((pl.col(\"sexe\") == 2) & \n            (pl.col(\"annais\") == \"2021\") & \n            (pl.col(\"preusuel\") != \"_PRENOMS_RARES\"))\\\n    .group_by(\"preusuel\")\\\n    .agg(pl.col(\"nombre\").sum().alias(\"nombre_total\"))\\\n    .sort(\"nombre_total\", descending=True)\\\n    .limit(10)\\\n    .collect()\n\nVous pouvez effectuez les m√™mes traitements en encapsulant du sql :\n\ntop10f2021_sql = fichier_prenoms\\\n    .sql(\"\"\"\n      SELECT preusuel, \n             SUM(nombre) AS nombre_total\n        FROM self\n       WHERE preusuel &lt;&gt; '_PRENOMS_RARES'\n         AND annais = '2021'\n         AND sexe = 2\n       GROUP BY preusuel\n       ORDER BY nombre_total DESC\n       LIMIT 10\n    \"\"\")\\\n    .collect()\n\n\n\n\n\n\nImportantFil rouge\n\n\n\nAlors que vous alliez chercher le pr√©nom, votre camarade Katia vous demande en quelle ann√©e son pr√©nom a √©t√© le plus donn√© entre 1960 et 1980.\n\n\n\n√âcrivez la requ√™te SQL qui fait le m√™me travail que les instructions ci-dessous\n\nprenom = \"Katia\"\nannee_debut, annee_fin = 1960, 1980\n\ndf_prenom_annee = fichier_prenoms\\\n    .filter((pl.col(\"preusuel\") == prenom.upper()) & \n            (pl.col(\"annais\").str.to_integer(strict=False).is_not_null()) & \n            (pl.col(\"annais\").str.to_integer(strict=False) &gt;= annee_debut) & \n            (pl.col(\"annais\").str.to_integer(strict=False) &lt;= annee_fin))\\\n    .group_by(\"annais\")\\\n    .agg(pl.col(\"nombre\").sum().alias(\"nombre_total\"))\\\n    .sort(\"annais\")\\\n    .collect()\n\nprint(df_prenom_annee)\n\n\n\n\n\n\nTipDiagramme en barre\n\n\n\n\n\nVous pouvez √©galement tracer un graphique avec ces donn√©es :\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Set seaborn style for a cleaner, more appealing look\nsns.set_theme(style=\"whitegrid\")\n\n# Create the plot\nfig, ax = plt.subplots(figsize=(10, 6))\n\n# Data\nyears = df_prenom_annee[\"annais\"].to_list()         # Extracts years as a list\ncounts = df_prenom_annee[\"nombre_total\"].to_list()  # Extracts counts as a list\n\n# Bar plot with custom colors and transparency for better visuals\nax.bar(years, \n       counts, \n       color=\"#4C72B0\", \n       edgecolor=\"black\", \n       alpha=0.8)\n\n# Set labels and title with padding for readability\nax.set_xlabel(\"Ann√©e\", fontsize=12, labelpad=10)\nax.set_ylabel(\"Nombre d'occurences\", fontsize=12, labelpad=10)\nax.set_title(f\"Occurrences du pr√©nom {prenom} par ann√©e ({annee_debut}-{annee_fin})\", fontsize=14, pad=15)\n\n# Rotate x-axis labels, improve spacing, and format grid\nax.tick_params(axis='x', rotation=45)\nplt.tight_layout()  # Adjust layout for tight fit\n\n# Display the plot\nplt.show()\n\n\n\nNous y sommes presque ! Pour trouver le fameux pr√©nom :\n\nReprenez le r√©sultat du nombre de nombres premiers entre 10 000 et 100 000\nOtez 3\nDivisez par 5\n\nLe pr√©nom recherch√© est √† ce rang de classement pour les pr√©noms f√©minins donn√©s en France entre 1970 et 2000.\n\n√âcrivez la requ√™te\n\nFiltrez les pr√©noms f√©minins donn√©s entre 1970 et 2000\nClassez-les par le nombre de fois o√π ils ont √©t√© donn√© d√©croissant et pr√©nom d√©croissant\n\nTrouvez le pr√©nom class√© au rang demand√©\n\nVous pouvez utiliser ce code : &lt;df&gt;.with_row_index()[&lt;index_inf&gt;:&lt;index_sup&gt;]\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nCe n‚Äôest pas encore impl√©ment√© dans Polars, mais il est possible en SQL de g√©n√©rer les rangs : RANK() OVER (ORDER BY SUM(nombre) DESC) AS rang.\nLa r√©ponse :\n\nCommence par un S\nMonsieur et Madame Hier ont une fille, comment s‚Äôappelle-t-elle ?\n\n\n\n\n\n\n3.5 Exportez vos r√©sultats vers MinIO\nVous pouvez √©galement exporter vos fichiers vers S3.\nNous allons utiliser ici la librairie s3fs.\n\nCollez et lancez ce code :\nimport s3fs\n\nfs = s3fs.S3FileSystem(\n    client_kwargs={'endpoint_url': 'https://'+'minio-simple.lab.groupe-genes.fr'},\n    key = os.environ[\"AWS_ACCESS_KEY_ID\"], \n    secret = os.environ[\"AWS_SECRET_ACCESS_KEY\"], \n    token = os.environ[\"AWS_SESSION_TOKEN\"])\n\ndestination = f\"s3://{s3_username}/ENSAI/SQL/output.csv\"\n\nwith fs.open(destination, mode='wb') as f:\n    top10f2021.write_csv(f)\nSur le Datalab, allez dans Mes fichiers ‚û°Ô∏è ENSAI ‚û°Ô∏è SQL\n\nle fichier output.csv a √©t√© g√©n√©r√©\nrafraichissez la page si besoin\n\nDouble-cliquez sur ce fichier pour en avoir un aper√ßu\n\n\nPour plus de d√©tails sur le stockage des fichiers sur S3 :\n\nLes donn√©es sur le cloud , Python pour la data science, Lino Galiana"
  },
  {
    "objectID": "doc/outils/tp-datalab.html#lib√©rer-les-ressources",
    "href": "doc/outils/tp-datalab.html#lib√©rer-les-ressources",
    "title": "D√©couverte du Datalab",
    "section": "Lib√©rer les ressources",
    "text": "Lib√©rer les ressources\nUne fois vos travaux termin√©s, il est temps de lib√©rer les ressources r√©serv√©es.\n\nSi besoin, sauvegardez vos notebooks\n\nclic droit sur le nom du fichier ‚û°Ô∏è Download\n\nPuis sur la page d‚Äôaccueil, allez dans Mes services, mettez votre service √† la poubelle\n\nVous pouvez ais√©ment reproduire votre travail plus tard :\n\nVotre code est t√©l√©charg√©\nVos donn√©es sont toujours sur MinIO\nIl suffit de relancer un nouveau service et de relancer les calculs\n\nUne mani√®re plus propre de travailler est d‚Äôutiliser git pour versionner son code."
  },
  {
    "objectID": "doc/outils/tp-datalab.html#fin-du-tp",
    "href": "doc/outils/tp-datalab.html#fin-du-tp",
    "title": "D√©couverte du Datalab",
    "section": "Fin du TP",
    "text": "Fin du TP\nLe but de ce TP √©tait de vous faire d√©couvrir les fonctionnalit√©s de base du Datalab et les bonnes pratiques de travail dans un environnement Cloud.\n\n\n\n\n\n\nImportant\n\n\n\nLa suite du TP est optionnelle.\nElle est simplement donn√©e pour celles et ceux qui souhaient aller plus loin et profiter de toutes les fonctionnalit√©s du Datalab.\n\n\n\nBesoin d‚Äôassistance ?\n\nContactez l‚Äô√©quipe du SSP Cloud sur Slack\nPour le Datalab du GENES, vous trouverez sur la page d‚Äôaccueil un lien pour rejoindre le canal Teams\n\n\n\nPour aller plus loin\nUne pr√©sentation compl√®te du projet Onyxia au Devoxx 2023, de sa philosophie et de son fonctionnement par Olivier LEVITT, Joseph GARRONE et Fr√©d√©ric COMTE.\n\nUne pr√©sentation plus courte\n\nD‚Äôautres videos sur la page GitHub du projet\n\n\nBibliographie\n\nUtiliser RStudio sur l‚Äôenvironnement SSP Cloud, UtilitR\nFormations et tutoriels du SSP Cloud\n\nNombreux tutos : Python, R, ML, Spark, Cartographie\n\nDoc SSP Cloud\nPrincipes du Datalab\nD√©couverte d‚ÄôOnyxia et de son datalab SSP Cloud, Nathan Randriamanana"
  },
  {
    "objectID": "doc/outils/tp-datalab.html#travailler-avec-git",
    "href": "doc/outils/tp-datalab.html#travailler-avec-git",
    "title": "D√©couverte du Datalab",
    "section": "4 Travailler avec Git",
    "text": "4 Travailler avec Git\n\n\n\n\n\n\nCaution\n\n\n\nSur le datalab, vos services ont une dur√©e de vie limit√©e.\nPour sauvegarder vos programmes, la bonne pratique est d‚Äôutiliser un d√©p√¥t git. Nous allons donc cr√©er et utiliser un jeton pour communiquer avec GitHub.\nPour suivre la d√©marche, il faut disposer d‚Äôun compte GitHub. Il est possible de suivre une d√©marche similaire avec GitLab.\n\n\n\n4.1 G√©n√©rer un token GitHub\n\n\n\n\n\n\nTipD√©j√† fait ?\n\n\n\nSi vous avez d√©j√† g√©n√©r√© et d√©clar√© un jeton GitHub, inutile de refaire ces 2 √©tapes.\n\n\n\nConnectez-vous √† votre compte GitHub\nAllez dans settings ‚û°Ô∏è Developer settings ‚û°Ô∏è Personal access tokens ‚û°Ô∏è Tokens (classic)\nG√©n√©rez un nouveau jeton classique\n\nRenseigner :\n\nnom du token : Datalab GENES\ndate d‚Äôexpiration ‚û°Ô∏è Custom ‚û°Ô∏è 1 an\n\n‚úÖ Cochez repo\nCliquez sur Generate token\nCopiez ce jeton commen√ßant par ghp_ et gardez le pr√©cieusement de c√¥t√© quelques minutes\n\n\n\n\n\n\n\n\nWarning\n\n\n\n\nCe jeton ne sera visible qu‚Äôune seule fois\nsi vous le perdez ou s‚Äôil est expir√©, il faut en g√©n√©rer un nouveau\n\n\n\n\n\n4.2 D√©clarer votre jeton\nGitHub vous a fournit un jeton. Il faut maintenant le d√©clarer sur le Datalab :\n\nAllez dans Mon Compte ‚û°Ô∏è Onglet Git\nRenseignez les informations suivantes\n\nnom d‚Äôutilisateur Git\nmail (celui utilis√© pour votre compte GitHub)\n\nCollez votre token\n\n\n\n\n\n\n\nTipConfig Git\n\n\n\nVous pouvez maintenant √©changer du code entre les services du Datalab et vos d√©p√¥ts GitHub. üéâ\n\n\n\n\n4.3 D√©p√¥t pour le code\nAvant de cr√©er un service, nous allons cr√©er un d√©p√¥t GitHub qui permettra de sauvegarder votre code.\n\nDans GitHub, cr√©er un nouveau Repository\n\nRepository name : TP3-datalab\nPrivate\n‚úÖ Cochez Add a README file\n.gitignore template : Python\nChoose a license : Apache Licence 2.0\nCreate Repository\n\nSur la page de votre repo, cliquez sur le bouton Code\nCopiez l‚Äôadresse https du repo\n\n\n\n4.4 Branchez votre service sur un r√©po\nLors du lancement d‚Äôun Service, vous pouvez vous brancher sur un r√©po git. Ainsi le contenu de votre d√©p√¥t sera import√© dans votre service.\nVous pourrez alors utiliser le code de votre d√©p√¥t et √©ventuellement le mettre √† jour en effectuant un push.\nLancez un service Jupyter Notebook\n\nOuvrez la Configuration\n\nDe nombreux onglets permettent de configurer votre service\nService : possibilit√© d‚Äôutiliser une autre image Docker\nResources : choisir CPU et RAM\nInit : script √† lancer au d√©marrage\n\nAllez dans l‚Äôonglet Git et collez l‚Äôadresse https du repo dans la case Repository url\nLancez le service, puis attendez quelques secondes\n\n\n\n4.5 Sauver son code\n\nSur Jupyter, ouvrez un terminal\n\nFile ‚û°Ô∏è New ‚û°Ô∏è Terminal\n\nPositionnez-vous dans le repo : cd /home/onyxia/work/TP3-datalab/\ngit status pour voir l‚Äô√©tat actuel\n\nle fichier ex0.ipynb doit appara√Ætre dans les Untracked files\n\nAjoutez ce fichier √† l‚Äôindex\nCr√©ez un commit\nPoussez ce commit vers votre d√©p√¥t distant (GitHub)\n\nVous pouvez v√©rifier sur GitHub que votre fichier ex0.ipynb est bien pr√©sent\n\n\n\n\n\n\n\n\nTip\n\n\n\n\n\n\ngit add .\ngit commit -m \"cr√©ation fichier tp3\"\ngit push\n\n\n\n\n\nExercice\nPar exemple en important le fichier des pr√©noms avec Polars et en encapsulant du SQL :\n\n√âcrivez la requ√™te du nombre de fois ou votre pr√©nom a √©t√© donn√© entre 2010 et 2020\nCr√©ez une nouvelle cellule et √©crivez une requ√™te pour afficher les 5 ann√©es o√π sont n√©es le plus de filles\nQuels sont les pr√©noms masculins et f√©minins les plus donn√©s depuis 1900 ?\nAffichez le nombres de filles et de gar√ßons n√©s chaque ann√©e depuis 2010\n\nüí° Aide : SUM(CASE WHEN ? THEN ? ELSE ? END)"
  },
  {
    "objectID": "doc/outils/tp-datalab.html#minio",
    "href": "doc/outils/tp-datalab.html#minio",
    "title": "D√©couverte du Datalab",
    "section": "5 MinIO",
    "text": "5 MinIO\nD‚Äôautres possibilit√©s pour acc√©der √† votre stockage\n\n5.1 Client MinIO\nLe client MinIO install√© et utilisable depuis le terminal permet √©galement d‚Äôinteragir avec vos fichiers.\nOuvrez un terminal (File ‚û°Ô∏è New ‚û°Ô∏è Terminal):\n\nmc ls s3/&lt;username&gt;/ENSAI/SQL : pour lister le contenu de votre dossier\nmc cp s3/&lt;username&gt;/ENSAI/SQL/output.csv . : pour copier le fichier depuis s3 dans votre dossier courant\n\nle fichier apparait dans votre explorer\n\nSupprimez ce fichier : rm output.csv\n\nCar importer les fichiers de donn√©es dans son espace de travail n‚Äôest pas une bonne pratique\n\n\n\n\n\n\n\n\nTip\n\n\n\nLa commande mc --help liste toutes les commandes possibles (ESPACE pour d√©filer, CTRL+C pour sortir)\n\n\n\n\n5.2 Console Minio\nVous pouvez √©galement acc√©der √† votre stockage avec la console Minio :\n\nhttps://minio-console.lab.sspcloud.fr/\nhttps://minio-simple.lab.groupe-genes.fr\n\n\n\n5.3 Python et s3fs\nimport os\nimport s3fs\nimport polars as pl\n\nfs = s3fs.S3FileSystem(\n    client_kwargs={\"endpoint_url\": f\"https://{os.environ['AWS_S3_ENDPOINT']}\"},\n    key = os.environ[\"AWS_ACCESS_KEY_ID\"], \n    secret = os.environ[\"AWS_SECRET_ACCESS_KEY\"], \n    token = os.environ[\"AWS_SESSION_TOKEN\"])\n\ns3_username = os.environ[\"VAULT_TOP_DIR\"] # un peu bancal pour avoir le username\n\nbucket_name = f\"{s3_username}/diffusion/\"\n\nfiles = fs.ls(bucket_name)\n\nfor file in files:\n    print(file)\n\n\n\n\n\n\nTipAffichage plus joli\n\n\n\n\n\n!pip install humanize\nimport humanize\n\ndata = []\n\nfor file in fs.ls(bucket_name, detail=True):\n\n    if file['type'] == 'directory':\n        subfolder_files = fs.find(file['name'])\n        file_count = len(subfolder_files)\n        file_type = \"Folder\"\n        size = None\n    else:\n        file_count = \"\"\n        file_type = \"File\"\n        size = file['size']\n    \n    data.append({\n        \"Name\": os.path.basename(file['name']),\n        \"Type\": file_type,\n        \"Size\": size or 0,\n        \"Nb Files\": file_count\n    })\n\ndf = pl.DataFrame(sorted(\n         data,\n         key=lambda x: (\n             0 if x[\"Type\"] == \"Folder\" else 1,\n             -x[\"Nb Files\"] if x[\"Nb Files\"] else 0,\n             -x[\"Size\"])\n        ))\\\n        .with_columns(pl.col('Size').map_elements(lambda x: humanize.naturalsize(x, binary=True) if x else \"\", return_dtype=pl.String).alias('Size'))\n\nprint(f\"Bucket : {bucket_name}\", df, sep = \"\\n\")"
  },
  {
    "objectID": "doc/outils/tp-datalab.html#surveiller-son-service",
    "href": "doc/outils/tp-datalab.html#surveiller-son-service",
    "title": "D√©couverte du Datalab",
    "section": "6 Surveiller son service",
    "text": "6 Surveiller son service\n\nSur la page du Datalab, allez dans Mes services\nCliquez sur le nom du service (Jupyter-python)\nCliquez sur Surveillance externe\n\nVous arrivez sur la page de l‚Äôoutil Grafana qui permet d‚Äôobserver les m√©triques de votre service."
  },
  {
    "objectID": "doc/outils/tp-datalab.html#les-secrets",
    "href": "doc/outils/tp-datalab.html#les-secrets",
    "title": "D√©couverte du Datalab",
    "section": "7 Les secrets",
    "text": "7 Les secrets\n\n\n\n\n\n\nImportantEnigme du P√®re Fouras\n\n\n\nPlus j‚Äôai de gardiens, moins je suis gard√©.\nMoins j‚Äôai de gardiens, plus je suis gard√©.\nQui suis-je ?\n\n\nCertains √©l√©ments ne doivent pas √™tre diffus√©s dans votre code (jetons d‚Äôacc√®s, mots de passe‚Ä¶).\nPour √©viter d‚Äôavoir √† nettoyer votre code √† chaque fois que vous le poussez sur GitHub, le datalab propose de g√©rer vos secrets.\n\n7.1 Cr√©er un secret\n\nAllez dans Mes secrets\nCr√©ez un Nouveau secret nomm√© projet_patate\nDouble-cliquez pour ouvrir ce secret\nAjoutez une variable\n\nNom : PATATE_TOKEN\nValeur : 123456\nCliquez sur ‚úÖ pour valider\n\nAjoutez une autre variable\n\nNom : PATATE_PORT\nValeur : 5236\nCliquez sur ‚úÖ pour valider\n\n\n\n\n7.2 Utiliser dans un service\n\nPr√©parez le lancement d‚Äôun service Rstudio\nDans la configuration, allez dans l‚Äôonglet Vault\nsecret : projet_patate\nLancez le service\n\nDans votre servives, les deux variables d‚Äôenvironnement ont √©t√© cr√©√©es.\n\nV√©rifiez leur pr√©sence via le terminal : env | grep PATATE ou echo $PATATE_TOKEN\nOuvrez un notebook et r√©cup√©rez la valeur de PATATE_TOKEN\nimport os\n\ntoken = os.environ[\"PATATE_TOKEN\"]\nprint(token)\nUne fois que vous avez fini de jouer, supprimez votre service\n\n\n\n\n\n\n\nNote\n\n\n\nCe TP avait pour but de vous familiariser avec le Datalab. Vous pouvez l‚Äôutiliser pour faire du Python, du R, cr√©er une base de donn√©es (prochain TP) ou utiliser de nombreux autres outils."
  },
  {
    "objectID": "doc/outils/tp-datalab.html#personnaliser-son-service",
    "href": "doc/outils/tp-datalab.html#personnaliser-son-service",
    "title": "D√©couverte du Datalab",
    "section": "8 Personnaliser son service",
    "text": "8 Personnaliser son service\n\n8.1 Script d‚Äôinitialisation\nIl est possible d‚Äôex√©cuter un script apr√®s lancement d‚Äôun service, par exemple pour installer des packages, des extensions‚Ä¶\nDans les options avant de lancer le service, onglet Scripts d‚Äôinitialisation puis rentrez l‚ÄôURL du script.\n\n\n\n\n\n\nImportant\n\n\n\n\nL‚ÄôURL du script ne doit pas √™tre dans un d√©p√¥t priv√©\nIl est possible d‚Äôajouter des arguments au script\n\n\n\nPour plus d‚Äôinformations et avoir des exemples : sspcloud-init-scripts\nPar exemple, le script suivant permet de :\n\ninstaller pytest\najouter l‚Äôextension VSCode Ruff\nsupprimer l‚Äôextension VSCode Flake8\n\n\n\nexample.sh\n\n#!/bin/sh\n\n# Install packages and VSCode extensions\n# Expected parameters : None\n\npip install pytest\n\ncode-server --install-extension charliermarsh.ruff\ncode-server --uninstall-extension ms-python.flake8\n\n\n\n\n\n\n\nTip\n\n\n\nSi vous avez besoin de lancer r√©guli√©rement votre service avec cette config :\n\nLorsque vous modifiez les param√®tres de lancement, cliquez sur la petite disquette\nVous pourrez √† tout moment relancer avec la m√™me configuration avec un raccourci dans Mes services\n\n\n\n\n\n8.2 Image Docker\nDans les param√®tres de lancement vous pouvez √©galement d√©finir votre propre image Docker :\n\nCr√©ez votre image √† partir de la derni√®re version du service\nTaguez cette image, puis poussez-la sur DockerHub\nDans les param√®tres de lancement, utilisez une image personnalis√©e\n\nPar exemple :\n\n\nDockerfile\n\nFROM inseefrlab/onyxia-vscode-python:py3.13.5-2025.07.21\n\n# Install packages\nRUN pip install pytest\n\n# Modify VSCode extensions\nRUN code-server --install-extension charliermarsh.ruff\nRUN code-server --uninstall-extension ms-python.flake8"
  },
  {
    "objectID": "doc/tp/tp5.html",
    "href": "doc/tp/tp5.html",
    "title": "NBA stats",
    "section": "",
    "text": "Vous allez travailler sur des donn√©es de la nba depuis les ann√©es 2000.\nLes donn√©es sont brutes i.e.¬†elles ont √©t√© r√©cup√©r√©e via l‚Äôapi stats nba et elles n‚Äôont quasiment pas √©t√© retouch√©es.\nLe mod√®le de donn√©es n‚Äôest pas fourni ! Ce sera √† vous d‚Äôexplorer vous m√™me la base de donn√©es.\n\n\n\n\n\n\nTip\n\n\n\nDans votre vie professionnelle, dans 95 % des cas vous allez h√©riter de missions o√π la documentation est obsol√®te voire inexistante.\nIl faut donc apprendre √† vous d√©brouiller d√®s maintenant. Et au passage, vous convaincre que faire et maintenir la doc √ßa aide et c‚Äôest bien !"
  },
  {
    "objectID": "doc/tp/tp5.html#introduction",
    "href": "doc/tp/tp5.html#introduction",
    "title": "NBA stats",
    "section": "",
    "text": "Vous allez travailler sur des donn√©es de la nba depuis les ann√©es 2000.\nLes donn√©es sont brutes i.e.¬†elles ont √©t√© r√©cup√©r√©e via l‚Äôapi stats nba et elles n‚Äôont quasiment pas √©t√© retouch√©es.\nLe mod√®le de donn√©es n‚Äôest pas fourni ! Ce sera √† vous d‚Äôexplorer vous m√™me la base de donn√©es.\n\n\n\n\n\n\nTip\n\n\n\nDans votre vie professionnelle, dans 95 % des cas vous allez h√©riter de missions o√π la documentation est obsol√®te voire inexistante.\nIl faut donc apprendre √† vous d√©brouiller d√®s maintenant. Et au passage, vous convaincre que faire et maintenir la doc √ßa aide et c‚Äôest bien !"
  },
  {
    "objectID": "doc/tp/tp5.html#importer-la-base-de-donn√©es",
    "href": "doc/tp/tp5.html#importer-la-base-de-donn√©es",
    "title": "NBA stats",
    "section": "1 Importer la base de donn√©es",
    "text": "1 Importer la base de donn√©es\n\nConnectez-vous √† un Datalab\nLancez un service PostgreSQL\nLancez un service cloudBeaver\n\nüöß\nFollow instructions: https://github.com/ludo2ne/SQL-NBA-POSTGRESQL/"
  },
  {
    "objectID": "doc/tp/tp5.html#rendez-vous-en-base-inconnue",
    "href": "doc/tp/tp5.html#rendez-vous-en-base-inconnue",
    "title": "NBA stats",
    "section": "2 Rendez-vous en base inconnue",
    "text": "2 Rendez-vous en base inconnue\nJe n‚Äôai pas r√©ussi √† inviter Laury T pour vous accompagner dans cette aventure mais voici quelques requ√™tes utiles pour explorer une base de donn√©es PostgreSQL.\nSELECT table_name\n  FROM information_schema.tables\n WHERE table_schema = '&lt;schema_name&gt;'\n   AND table_type = 'BASE TABLE'\n ORDER BY table_name;\nSELECT column_name,\n       data_type,\n       is_nullable,\n       column_default\n  FROM information_schema.columns\n WHERE table_schema = '&lt;...&gt;'\n   AND table_name   = '&lt;...&gt;'\n ORDER BY ordinal_position;\n\n\n\n\n\n\nNoteGlossaire\n\n\n\n\n\n\n\n\n\n\n\n\nColonne\nSignification\n\n\n\n\nmatchup\nDescription du match : ex. LAL @ BOS (√† l‚Äôext√©rieur) ou LAL vs BOS (√† domicile).\n\n\nwl\nR√©sultat pour l‚Äô√©quipe : W (win), L (loss).\n\n\nmin\nMinutes totales jou√©es par l‚Äô√©quipe (toujours 240 sauf prolongation).\n\n\npts\nTotal des points de l‚Äô√©quipe.\n\n\nfgm\nField goals made ‚Äî tirs r√©ussis (2 pts + 3 pts).\n\n\nfga\nField goals attempted ‚Äî tirs tent√©s.\n\n\nfg_pct\nTaux de r√©ussite : fgm / fga.\n\n\nfg3m\n3-points r√©ussis.\n\n\nfg3a\n3-points tent√©s.\n\n\nfg3_pct\nPourcentage √† 3 points.\n\n\nftm\nFree throws made ‚Äî lancers francs r√©ussis.\n\n\nfta\nFree throws attempted ‚Äî lancers francs tent√©s.\n\n\nft_pct\nPourcentage aux lancers.\n\n\noreb\nRebonds offensifs.\n\n\ndreb\nRebonds d√©fensifs.\n\n\nreb\nRebonds totaux (oreb + dreb).\n\n\nast\nPasses d√©cisives.\n\n\nstl\nInterceptions.\n\n\nblk\nContres.\n\n\ntov\nBallons perdus (turnovers).\n\n\npf\nFautes personnelles."
  },
  {
    "objectID": "doc/tp/tp5.html#explorons-avec-les-spurs",
    "href": "doc/tp/tp5.html#explorons-avec-les-spurs",
    "title": "NBA stats",
    "section": "3 Explorons avec les Spurs",
    "text": "3 Explorons avec les Spurs\n\nQuel est l‚Äôid de l‚Äô√©quipe des Spurs de San Antonio ?\nListez les joueurs des Spurs\nListez tous les matchs des Spurs de la saison r√©guli√®re 2024-2025\n\nclassez ces matchs par date\n\nChoisissez un game_id parmi ces matchs et regardez combien de lignes correspondent\n\nCe choix de conception a des avantages et des inconv√©nients. Nous y reviendrons par la suite lorsque nous afficherons les scores de chaque match.\n\nProposez une cl√© primaire pour la table game\nEcrivez une requ√™te pour v√©rifier si votre proposition est correcte\n\nRegardons maintenant les stats des joueurs.\n\nAffichez les stats des joueurs des Spurs pour la saison r√©guli√®re 2024-2025\nAffichez les stats des joueurs des Spurs par match\nEst-ce qu‚Äôil n‚Äôy aurait pas des doublons dans cette table ?\nEst-ce que cette table contient les stats des joueurs par match de toutes les saisons ?"
  },
  {
    "objectID": "doc/tp/tp5.html#matchs-et-classements",
    "href": "doc/tp/tp5.html#matchs-et-classements",
    "title": "NBA stats",
    "section": "4 Matchs et classements",
    "text": "4 Matchs et classements\nDans toute cette partie nous nous interesserons √† la saison 2020-2021.\n\nListez les matchs de la saison\nCombien y-a-t-il eu de match cette saison\nDistinguez saison r√©guli√®re et Playoffs\n\nInteressons-nous la saison r√©guli√®re.\n\nListez les matchs de Utah Jazz\nComptez leur nombre de victoires et de d√©faites\nUtilisez COUNT et FILTER pour avoir le r√©sultat sur une seule ligne\n\najoutez le nombre de matchs jou√©s\n\nAffichez les m√™mes colones pour chaque √©quipe de la conf√©rence Ouest\n\nclassez par nombre de victoires d√©croissant\n\n\nPassons maintenant aux Playoffs.\n\nListez les matchs de Utah Jazz\nPour chacun de leurs matchs, affichez le score, le nom de leurs adversaires et le r√©sultat\nAffichez les scores de matchs\n\nUne derni√®re question pour la route :\n\nSi vous deviez afficher toutes les finales et leur score, comment feriez-vous ?\n\n\n\n\n\n\n\nTipAide\n\n\n\n\n\n\nQuelles √©tapes sont r√©alis√©es ci-dessous ?\n\nTout simplement :\nWITH last_playoff_games AS (\nSELECT season_id, MAX(game_id) AS last_game_id\n  FROM nba.game\n WHERE season_type = 'Playoffs'\n GROUP BY season_id\n),\nfinal_teams AS (\nSELECT g.season_id, \n       g.team_id AS team_id_win, \n       g2.team_id AS team_id_los\n  FROM nba.game g\n  JOIN last_playoff_games lpg ON g.season_id = lpg.season_id AND g.game_id = lpg.last_game_id\n  JOIN nba.game g2 ON g2.game_id = g.game_id AND g2.team_id &lt;&gt; g.team_id\n WHERE g.wl = 'W'\n)\nSELECT gwin.season_id,\n       twin.full_name AS equipe,\n       COUNT(*) FILTER (WHERE gwin.wl = 'W') || ' - ' || COUNT(*) FILTER (WHERE gwin.wl = 'L') AS score,\n       tlos.full_name AS adversaire\n  FROM nba.game gwin\n  JOIN final_teams ft ON ft.team_id_win = gwin.team_id AND ft.season_id = gwin.season_id\n  JOIN nba.team twin ON twin.id = gwin.team_id\n  JOIN nba.game glos ON glos.game_id = gwin.game_id AND glos.team_id = ft.team_id_los\n  JOIN nba.team tlos ON tlos.id = glos.team_id\n WHERE gwin.season_type = 'Playoffs'\n GROUP BY gwin.season_id, twin.full_name, tlos.full_name\n ORDER BY gwin.season_id DESC;"
  },
  {
    "objectID": "doc/tp/tp5.html#triple-z√©ro",
    "href": "doc/tp/tp5.html#triple-z√©ro",
    "title": "NBA stats",
    "section": "5 Triple z√©ro",
    "text": "5 Triple z√©ro\nLors d‚Äôun match, les principales statistiques utilis√©es pour mesurer les performances des joueurs sont : les points, les rebonds, les passes d√©cisives, les interceptions et les contres.\nUn joueur r√©alise alors un :\n\ndouble-double : s‚Äôil atteint au moins 10 dans deux de ces statistiques\ntriple-double : au moins 10 dans trois de ces statistiques (grosse perf)\nquadruple-double : au moins 10 dans quatre de ces statistiques (tr√®s rare)\n\nIl existe √©galement d‚Äôautres performances tr√®s rares :\n\ndouble triple-double : s‚Äôil atteint au moins 20 dans trois de ces statistiques\nFive-by-five : au moins 5 dans les cinq cat√©gories\n\nVous aussi en avez assez d‚Äôentendre toujours les m√™mes noms r√©aliser ce genre de performance : Wemby, Curry, Gilgeous-Alexander, Doncic, Jokic‚Ä¶\nL‚Äôheure de la revanche a sonn√©. Mettons aujourd‚Äôhui en lumi√®re les vrais champions, ceux qui r√©alisent des 0 dans ces stats, font des fautes, perdent des balles.\n\nAffichez les statistiques par match de chaque joueur\nConservez uniquement ceux ayant jou√© plus de 10 minutes par match\n\n\n\n\n\n\n\nTip\n\n\n\n\nCommencez par retirer les lignes ou la colonne minutes est vide\nPuis utilisez CAST(SPLIT_PART(minutes, ':', 1) AS integer)\n\n\n\n\nEn plus du nom du joueur et du nombre de minutes jou√©es, affichez les cinq statistiques demand√©es\nEst-ce que nous avons un champion avec un quintuple z√©ro ?\n‚≠ê ‚≠ê ‚≠ê Un peu plus compliqu√©, est-ce qu‚Äôil y a des quadruples z√©ros ?\n\nquadruple z√©ro : 0 points et 3 autres stats √† 0\nLe CASE WHEN est votre ami ici\n\n\nQuelques autres titres √† d√©cerner (toujours avec au moins 10min de jeu):\n\nCelui qui a le plus souvent marqu√© 0 points\nQui est le pire shooter d‚Äôun match ?\n\ni.e.¬†qui n‚Äôa marqu√© aucun point, et a tent√© le plus grand nombre de tirs, lancers francs inclus\n\nListe des joueurs qui lors d‚Äôun match ont eu plus de pertes de balle (turnover) que de points marqu√©s\nTop 10 de ceux qui ne terminent pas souvent les matchs (ils sont expuls√©s apr√®s 6 fautes personnelles)\n\nLa colonne plusminuspoints est la diff√©rence entre le nombre de points marqu√©s par l‚Äô√©quipe et le nombre de points encaiss√©s lorsque le joueur est sur le terrain.\nCela donne une id√©e de l‚Äôinfluence et l‚Äôimpact du joueur lorsqu‚Äôil est sur le terrain.\n\nQuel joueur a eu la pire influence sur un seul match\nQuels sont les joueurs qui ont le plus grand nombre de matchs avec une influence n√©gative sur l‚Äô√©quipe\n\nIls ont essay√© de faire perdre leur √©quipe mais ils n‚Äôont pas r√©ussi :\n\nQuel joueur a eu la pire influence, et pourtant son √©quipe a gagn√©\nAjoutez les deux √©quipes et le score du match\n\n\n\n\n\n\n\nTipSolutions\n\n\n\n\n\n\nCorrection TP5"
  },
  {
    "objectID": "doc/tp/tp5.html#arr√™tez-vos-services",
    "href": "doc/tp/tp5.html#arr√™tez-vos-services",
    "title": "NBA stats",
    "section": "Arr√™tez vos services",
    "text": "Arr√™tez vos services\nC‚Äôest la fin du TP, vous pouvez maintenant sauvegarder votre travail et lib√©rer les ressources r√©serv√©es :\n\nCopiez-collez vos scripts SQL sur votre machine\nArr√™ter les services du Datalab"
  },
  {
    "objectID": "doc/tp/tp2.html",
    "href": "doc/tp/tp2.html",
    "title": "Exercices vintages üíæ",
    "section": "",
    "text": "Lors du premier TP, nous avons utilis√© DuckDB pour lire les donn√©es d‚Äôun fichier parquet. Aujourd‚Äôhui nous allons cr√©er notre propre base de donn√©es PostgreSQL, puis y d√©clarer des tables et ins√©rer de donn√©es. Enfin nous allons requ√™ter ces donn√©es.\nLors de ce TP, vous allez :\n\nCr√©er votre base de donn√©es PostgreSQL\nLancer des scripts de cr√©ation de tables et d‚Äôinsertion de donn√©es\nRelier des tables en utilisant les jointures\nS√©lectionner et filtrer des donn√©es\n\n\n\n\n\n\n\nImportant\n\n\n\n\n√âcrivez des requ√™tes jolies !\n√Ä la fin du TP, exportez ou copiez vos requ√™tes dans un fichier de votre VM ou machine personnelle"
  },
  {
    "objectID": "doc/tp/tp2.html#introduction",
    "href": "doc/tp/tp2.html#introduction",
    "title": "Exercices vintages üíæ",
    "section": "",
    "text": "Lors du premier TP, nous avons utilis√© DuckDB pour lire les donn√©es d‚Äôun fichier parquet. Aujourd‚Äôhui nous allons cr√©er notre propre base de donn√©es PostgreSQL, puis y d√©clarer des tables et ins√©rer de donn√©es. Enfin nous allons requ√™ter ces donn√©es.\nLors de ce TP, vous allez :\n\nCr√©er votre base de donn√©es PostgreSQL\nLancer des scripts de cr√©ation de tables et d‚Äôinsertion de donn√©es\nRelier des tables en utilisant les jointures\nS√©lectionner et filtrer des donn√©es\n\n\n\n\n\n\n\nImportant\n\n\n\n\n√âcrivez des requ√™tes jolies !\n√Ä la fin du TP, exportez ou copiez vos requ√™tes dans un fichier de votre VM ou machine personnelle"
  },
  {
    "objectID": "doc/tp/tp2.html#lancement-des-services",
    "href": "doc/tp/tp2.html#lancement-des-services",
    "title": "Exercices vintages üíæ",
    "section": "1 Lancement des services",
    "text": "1 Lancement des services\nPour plus de d√©tails, allez dans l‚Äôonglet Datalab.\n\nConnectez-vous √† un Datalab\nLancez un service PostgreSQL\nLancez un service cloudBeaver\n\nouvrez ce service\nv√©rifiez que vous √™tes connect√©s √† la base de donn√©es PostgreSQL\nouvrez la connexion (clic droit &gt; Open), un petit rond vert apparait üü¢\n\n\n\n\n\n\n\n\nImportant\n\n\n\ncloudBeaver est parfois capricieux, en cas de blocage, n‚Äôh√©sitez pas √† rafraichir la page (F5).\n\n\nEn attendant le lancement des services, voici un peu de lecture ci-dessous."
  },
  {
    "objectID": "doc/tp/tp2.html#m√©thodo-√©crire-une-requ√™te",
    "href": "doc/tp/tp2.html#m√©thodo-√©crire-une-requ√™te",
    "title": "Exercices vintages üíæ",
    "section": "2 M√©thodo : √âcrire une requ√™te",
    "text": "2 M√©thodo : √âcrire une requ√™te\nIl est parfois difficile d‚Äô√©crire du premier coup LA requ√™te qui r√©pond directement √† la question pos√©e.\nVoici une m√©thode qui peut vous aider √† √©crire vos requ√™tes pas √† pas :\n\n\n\n\n\n\nImaginons que l‚Äôon vous demande de lister les noms et pr√©noms des joueuses du club de la ville de Saint Quentin, dont le pr√©nom commence par un A class√©es par elo d√©croissant.\njoueuse(id_joueuse, nom, prenom, elo, #id_club)\nclub(id_club, nom, ville)\n\n\n\n\n2.1 Listez les tables n√©cessaires\nCommen√ßons par lister les tables n√©cessaires, puis joignons-les.\nNous avons besoin ici des 2 tables que nous pouvons joindre en utilisant la colonne id_club.\nSELECT *\n  FROM joueuse j\n  JOIN club c USING(id_club);\n\n\n\n\n\n\nTip\n\n\n\n\nNous utilisons pour l‚Äôinstant SELECT * pour s√©lectionner toutes les colonnes\n\nnous enleverons les colonnes inutiles plus tard\n\nNous utilisons des alias, cela rendra la requ√™te plus courte et plus claire\n\nj pour joueuse\nc pour club\n\n\n\n\n\n\n2.2 Appliquez les filtres\nFiltrons pour ne conserver que les lignes qui nous int√©ressent.\n\nVille du club : Saint Quentin\nPr√©nom qui commence par un A\n\nSELECT *\n  FROM joueuse j\n  JOIN club c USING(id_club)\n WHERE c.ville = 'Saint Quentin'\n   AND j.prenom LIKE 'A%';\n\n\n2.3 Ordonnez les r√©sultats\nOrdonnons par elo d√©croissant.\nSELECT *\n  FROM joueuse j\n  JOIN club c USING(id_club)\n WHERE c.ville = 'Saint Quentin'\n   AND j.prenom LIKE 'A%'\n ORDER BY j.elo DESC;\n\n\n2.4 S√©lectionner les colonnes requises\nIl est demand√© de ne garder que les noms et pr√©noms des joueuses.\nRempla√ßons le SELECT * par les noms des colonnes.\nSELECT j.nom,\n       j.prenom\n  FROM joueuse j\n  JOIN club c USING(id_club)\n WHERE c.ville = 'Saint Quentin'\n   AND j.prenom LIKE 'A%'\n ORDER BY j.elo DESC;\nMaintenant, place √† quelques exercices historiques."
  },
  {
    "objectID": "doc/tp/tp2.html#exercices",
    "href": "doc/tp/tp2.html#exercices",
    "title": "Exercices vintages üíæ",
    "section": "3 Exercices",
    "text": "3 Exercices\n\n3.1 √âcole de musique üé∏\nNous allons commencer par cr√©er les tables et ins√©rer les donn√©es :\n\nCopiez le contenu de ce script sql\nCollez dans la fen√™tre SQL de CloudBeaver\nEx√©cutez le script\n\nCliquez sur la petite icone sous les triangles oranges qui ressemble √† üìú\nraccourci (ALT + X)\nEn cas d‚Äôerreur, corrigez, puis relancez int√©gralement le script\n\nV√©rifiez que votre sch√©ma et vos tables sont cr√©√©s\n\nDans l‚Äôexplorateur : PostgreSQL ‚û°Ô∏è Databases ‚û°Ô∏è defaultdb ‚û°Ô∏è Schemas\nClic droit sur Schemas ‚û°Ô∏è Refresh\n\n\nSi tout est ok, vous n‚Äôavez plus besoin du script de cr√©ation et d‚Äôinsertion de donn√©es.\n\nSupprimez tout le contenu du code SQL que vous venez d‚Äôex√©cuter ou ouvrez un nouvel √©diteur SQL\n\nVoici le mod√®le de donn√©es :\n\nVous pouvez maintenant commencer l‚Äôexercice et √©crire les requ√™tes permettant de r√©pondre aux questions suivantes :\n\nQuels sont les noms des instruments pr√©sents dans la base de donn√©es\nQuels sont les noms et adresses des adh√©rents\nQuelle est l‚Äôadresse de l‚Äôadh√©rent num√©ro 15\nQuels sont les num√©ros des adh√©rents de nom DUPONT\n\nR√©alisez les jointures qui permettent d‚Äôobtenir :\n\nLes noms des instruments dont joue chaque adh√©rent\nLe nom des adh√©rents inscrits au cours num√©ro 6\nLes noms des cours ayant lieu le samedi et les noms des adh√©rents inscrits\nLes noms des cours auxquels sont inscrits les adh√©rents qui jouent du piano\nDe quels instruments jouent les personnes inscrites au cours de guitare classique (GUIT-CLASS)\n\n\n\n3.2 Location de DVD üíø\nIl fut un temps o√π des entreprises se sp√©cialisaient dans la location de DVD. Dans cet exercice, une telle entreprise souhaite informatiser la gestion des pr√™ts.\nVoici le Mod√®le de donn√©es :\n\n\nCr√©ation de tables\n\nUtiliser le code ci-dessous pour cr√©er le sch√©ma et les 3 tables de droite\nDROP SCHEMA IF EXISTS dvd CASCADE;\n\nCREATE SCHEMA dvd;\n\nCREATE TABLE dvd.realisateur(\n    num_realisateur    INT PRIMARY KEY,\n    nom_realisateur    TEXT,\n    prenom_realisateur TEXT);\n\nCREATE TABLE dvd.film(\n    num_film       INT PRIMARY KEY,\n    titre          TEXT,\n    genre          TEXT,\n    date_sortie    DATE);\n\nCREATE TABLE dvd.a_realise(\n    num_film         INT REFERENCES dvd.film(num_film),\n    num_realisateur  INT REFERENCES dvd.realisateur(num_realisateur),\n    PRIMARY KEY (num_film, num_realisateur));\n√âcrivez les requ√™tes qui permettent de cr√©er les 3 autres tables\nChargez les donn√©es avec ce script sql\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nAttention, ici l‚Äôordre de cr√©ation des tables a son importance.\nReprenons et modifions l‚Äôexemple ci-dessus :\n\nimaginez que vous essayez de cr√©er en premier la table a_realise\nle champ num_film de cette table est une cl√© √©trang√®re\nil r√©f√©rence la cl√© primaire num_film de la table film\nor si la table film n‚Äôexiste pas, √† votre avis, que va-t-il se passer ?\n\n\n\n\n\n\nRequ√™tes\nDonnez les requ√™tes pour obtenir :\n\nNom et pr√©nom des adh√©rents\nTitre des films de la base\nNum√©ro d‚Äôadh√©rent de Pierre DUCHEMIN\nNom, Pr√©nom et adresse de tous les DUCHEMIN\nNum√©ro des DVD du film la guerre des etoiles\n\n\n\n\n\n\n\nNoteRecherche dans la doc\n\n\n\n\nRecherchez dans la documentation officielle PostgreSQL, un moyen de r√©pondre au besoin ci-dessous\n\nPour connaitre la version utilis√©e : SELECT version();\n\n\nPour les 3 requ√™tes suivantes, vous afficherez les noms et pr√©noms sur une seule colonne.\nUtilisez le mot cl√© AS pour nommer cette colonne nom_complet √† l‚Äôaffichage.\n\nNom, Pr√©nom des adh√©rents ayant emprunt√© le film la guerre des etoiles\nNom, Pr√©nom des adh√©rents ayant au moins un emprunt en cours (la date de fin de l‚Äôemprunt est nulle)\nNom, Pr√©nom du r√©alisateur de la Guerre des √©toiles\n\n\n\n\n\n\n\nTip\n\n\n\n\n\nIl existe diff√©rentes mani√®res de concat√©ner du texte :\n\nfonctions PostgreSQL CONCAT(), CONCAT_WS()\nop√©rateur ||\n\n\n\n\n\nTitre des films emprunt√©s par Pierre DUCHEMIN, ainsi que dates de d√©but et de fin\nNom des r√©alisateurs des films emprunt√©s par Pierre DUCHEMIN\nNom des r√©alisateurs de films de science fiction ou policiers\n\nUtilisons maintenant des m√©thodes d‚Äôagr√©gation pour r√©pondre aux questions suivantes :\n\nNombre de DVD dont le co√ªt de l‚Äôemprunt est inf√©rieur ou √©gal √† 2‚Ç¨\nNombre d‚Äôemprunts ayant √©t√© effectu√©s par Dominique Duchemin\nNombre de films diff√©rents ayant √©t√© emprunt√©s par Dominique Duchemin\nNum√©ro des DVD en ordre d√©croissant du nombre de fois qu‚Äôils ont √©t√© emprunt√©s\nNum√©ro du DVD le plus r√©cemment achet√©\n\nQuelques questions sur les dates :\n\nQuelle a √©t√© la dur√©e d‚Äôemprunt la plus longue\nEn date du 10 ao√ªt 2010, combien de DVD sont en cours d‚Äôemprunt\nCombien de dvd ont √©t√© achet√©s chaque ann√©e\n\nPour terminer cet exercice, nous allons rechercher les titres des films qui n‚Äôont jamais √©t√© emprunt√©s. Proc√©dons par √©tapes et √©crivez les requ√™tes suivantes :\n\nDiff√©rents num√©ros des films emprunt√©s\nTitre des films ayant pour num√©ro 18, 19 ou 20\nTitre des films n‚Äôayant pas pour num√©ros ni 18, ni 19, ni 20\nTitre des films n‚Äôayant jamais √©t√© emprunt√©s\n\n\n\n\n3.3 Rugby World Cup üèâ\n\n\n\n\n\n\nPour les plus rapides üöÄ\n\n\n\nNous souhaitons informatiser les r√©sultats de la coupe du monde de rugby. Pour cela nous avons cr√©√© les deux tables suivantes : equipe et matches.\nCommencez par cr√©ez et charger les tables avec ce script.\n\nDonner les noms des √©quipes qui ont jou√© √† Nantes\nContre quelles √©quipes a jou√© l‚Äô√©quipe de France ?\nPour tous les matchs, affichez les informations suivantes :\n\nDate du match\nNom de la premi√®re √©quipe\nnombre de points de la premi√®re √©quipe\nnombre de points de la deuxi√®me √©quipe\nnom de la deuxi√®me √©quipe et lieu du match\n\nQuels sont les noms d‚Äô√©quipes qui ont gagn√© au moins deux matchs\nQuels sont les noms des √©quipes qui ont perdu tous leurs matchs\nPour chaque √©quipe donner le nombre de matchs qu‚Äôelles ont gagn√© ou perdu\nDonner le nombre total de points obtenus par √©quipe en classant les √©quipes de celle ayant marqu√© le plus √† celle ayant marqu√© le moins\n\n\n\n\n\n\n\nTipSolutions\n\n\n\n\n\n\nCorrection TP2"
  },
  {
    "objectID": "doc/tp/tp2.html#arr√™tez-vos-services",
    "href": "doc/tp/tp2.html#arr√™tez-vos-services",
    "title": "Exercices vintages üíæ",
    "section": "Arr√™tez vos services",
    "text": "Arr√™tez vos services\nC‚Äôest la fin du TP, vous pouvez maintenant sauvegarder votre travail et lib√©rer les ressources r√©serv√©es :\n\nCopiez-collez vos scripts SQL sur votre machine\nArr√™ter les services du Datalab"
  },
  {
    "objectID": "doc/decouverte.html",
    "href": "doc/decouverte.html",
    "title": "D√©couverte du SQL",
    "section": "",
    "text": "üöß"
  },
  {
    "objectID": "doc/decouverte.html#d√©finitions",
    "href": "doc/decouverte.html#d√©finitions",
    "title": "D√©couverte du SQL",
    "section": "1 D√©finitions",
    "text": "1 D√©finitions\n\nBase de donn√©es : Ensemble de tableaux\nTable :\n\nLignes (individus)\nColonnes (attributs)\n\nTypes de Donn√©es :\n\nTexte (comme un nom, une adresse)\nNombre (comme l‚Äô√¢ge, le prix)\nDate\nBool√©en\n\n\nPourquoi Utiliser une Base de Donn√©es ?\n\nParce que c‚Äôest mieux que d‚Äôutiliser du papier\nPermet de g√©rer de grandes quantit√©s d‚Äôinformations"
  },
  {
    "objectID": "doc/decouverte.html#fichier-des-pr√©noms",
    "href": "doc/decouverte.html#fichier-des-pr√©noms",
    "title": "D√©couverte du SQL",
    "section": "2 Fichier des pr√©noms",
    "text": "2 Fichier des pr√©noms\nhttps://www.insee.fr/fr/statistiques/8205621?sommaire=8205628\n\nFichier France\nFichier par d√©partement de naissance\n\n\n2.1 Aper√ßu du fichier national\n\n\n\nsexe\npreusuel\nannais\nnombre\n\n\n\n\n1\nANDR√â\n1960\n4006\n\n\n1\nDENIS\n1960\n4658\n\n\n1\nFR√âD√âRIC\n1960\n4314\n\n\n1\nHERV√â\n1960\n4326\n\n\n1\nJEAN-CLAUDE\n1960\n4030\n\n\n1\nJO√ãL\n1960\n4888\n\n\n1\nLAURENT\n1960\n4275\n\n\n1\nYVES\n1960\n4485\n\n\n2\nANNE\n1960\n4813\n\n\n2\nCLAUDINE\n1960\n4194\n\n\n2\nELISABETH\n1960\n4106\n\n\n2\nEVELYNE\n1960\n4888\n\n\n2\nLAURENCE\n1960\n4375\n\n\n2\nMARIE-CHRISTINE\n1960\n4096\n\n\n2\nMONIQUE\n1960\n4590\n\n\n2\nNICOLE\n1960\n4602"
  },
  {
    "objectID": "doc/decouverte.html#lancement",
    "href": "doc/decouverte.html#lancement",
    "title": "D√©couverte du SQL",
    "section": "3 Lancement",
    "text": "3 Lancement\n\nSe connecter au SSPCloud\nOuvrir un service CloudBeaver\nCr√©er une connexion DuckDB\n\nJDBC URL : jdbc:duckdb::memory:"
  },
  {
    "objectID": "doc/decouverte.html#exercice",
    "href": "doc/decouverte.html#exercice",
    "title": "D√©couverte du SQL",
    "section": "4 Exercice",
    "text": "4 Exercice\n\n4.1 Initialisation\n\nCr√©ons une vue pointant vers le fichier\n\nCREATE OR REPLACE VIEW prenom_raw AS FROM 'https://www.insee.fr/fr/statistiques/fichier/8205621/prenoms-2023-nat.parquet';\n\nSELECT *\n  FROM prenom_raw;\n\nSuppression des donn√©es manquantes\n\nCREATE OR REPLACE VIEW prenom\nAS\nSELECT *\n  FROM prenom_raw\n WHERE annais &lt;&gt; 'XXXX'\n   AND preusuel &lt;&gt; '_PRENOMS_RARES';\n\n\n4.2 Top 10 f√©minin 2023\nLe top 10 f√©minin annonc√© pour l‚Äôann√©e 2023 est le suivant :\n\n\n\nRang\nPr√©nom\nNombre\n\n\n\n\n1\nLOUISE\n3177\n\n\n2\nAMBRE\n3168\n\n\n3\nALBA\n3088\n\n\n4\nJADE\n2891\n\n\n5\nEMMA\n2663\n\n\n6\nROSE\n2375\n\n\n7\nALMA\n2342\n\n\n8\nALICE\n2256\n\n\n9\nROMY\n2198\n\n\n10\nANNA\n2129\n\n\n\n\nV√©rifions en √©crivant une requ√™te\n\nSELECT *\n  FROM prenom\n WHERE sexe = 2\n   AND annais = '2023'\n ORDER BY nombre DESC\n LIMIT 10;\n\nQuel pr√©nom est class√© 11e dans cette liste ?\nEst-ce que l‚Äôon peut √©crire ce pr√©nom autrement ?\n\nSELECT *\n  FROM prenom\n WHERE annais = '2023'\n   AND STRIP_ACCENTS(preusuel) = 'EVA';\n\nRefaire le vrai classement\n\nSELECT STRIP_ACCENTS(preusuel),\n       SUM(nombre) AS nb\n  FROM prenom\n WHERE sexe = 2\n   AND annais = '2023'\n GROUP BY STRIP_ACCENTS(preusuel)\n ORDER BY nb DESC\n LIMIT 10;\n\nCorriger les donn√©es\n\nCREATE OR REPLACE VIEW prenom\nAS\nSELECT sexe, \n      STRIP_ACCENTS(preusuel) AS preusuel, \n      annais, \n      nombre \n FROM prenom_raw\nWHERE annais &lt;&gt; 'XXXX'\n  AND preusuel &lt;&gt; '_PRENOMS_RARES';\n\n\n4.3 Evolution au cours du temps\n SELECT *\n  FROM prenom\n WHERE preusuel = 'LUDOVIC'\n ORDER BY annais;\n\nFaire un diagramme en barre avec matplotlib\nDemander √† un LLM\n\n\n\n\n\n\n\nNoteCode Python\n\n\n\n\n\nimport duckdb\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport numpy as np\nfrom matplotlib.colors import LinearSegmentedColormap\n\ncon = duckdb.connect(database=':memory:', read_only=False)\n\nparquet_url = 'https://www.insee.fr/fr/statistiques/fichier/8205621/prenoms-2023-nat.parquet'\n\ntry:\n    con.execute(\"SET force_download=true\")\n    \n    con.execute(f\"\"\"\n        CREATE OR REPLACE VIEW prenom_raw AS FROM '{parquet_url}';\n    \"\"\")\n\n    con.execute(f\"\"\"\n        CREATE OR REPLACE VIEW prenom\n        AS\n        SELECT sexe, \n               STRIP_ACCENTS(preusuel) AS preusuel, \n               annais, \n               nombre \n          FROM prenom_raw\n         WHERE annais &lt;&gt; 'XXXX'\n           AND preusuel &lt;&gt; '_PRENOMS_RARES';\n    \"\"\")\n\nexcept duckdb.Error as e:\n    print(f\"An error occurred with DuckDB: {e}\")\n    con.close()\nexcept Exception as e:\n    print(f\"An unexpected error occurred: {e}\")\n    con.close()\n\nprenom = \"LUDOVIC\"\n\ntry:\n    query = f\"\"\"\n        SELECT annais, nombre\n        FROM prenom\n        WHERE preusuel = '{prenom}'\n          AND annais &lt;&gt; 'XXXX'\n          AND annais &gt;= '1950'\n        ORDER BY annais;\n    \"\"\"\n    result = con.execute(query).fetchdf()\n\n    if not result.empty:\n        years = [int(y) for y in result['annais']]\n        counts = result['nombre']\n\n        # Create the bar plot\n        plt.figure(figsize=(10, 6))\n        plt.bar(years, counts, color='skyblue')\n\n        #cmap = LinearSegmentedColormap.from_list(\"gradient\", [\"darkgreen\", \"orange\"])\n        #norm = plt.Normalize(vmin=min(counts), vmax=max(counts))\n        #plt.bar(years, counts, color=cmap(norm(counts)))\n\n        # Add labels and title\n        plt.xlabel(\"Ann√©e\")\n        plt.ylabel(\"Nombre de fois\")\n        plt.title(f\"√âvolution du Pr√©nom {prenom} par Ann√©e\")\n\n        years_to_show = np.arange(min(years), max(years) + 1, 10)\n        plt.xticks(years_to_show, rotation=45, ha='right')\n        plt.tight_layout()\n\n        # Show the plot\n        plt.grid(axis='y', linestyle='--')\n        plt.show()\n\n    else:\n        print(\"No data found for the first name 'LUDOVIC'.\")\n\nexcept duckdb.Error as e:\n    print(f\"An error occurred with DuckDB: {e}\")\nexcept Exception as e:\n    print(f\"An unexpected error occurred: {e}\")\n\n\n\n\n\n4.4 Pr√©noms les plus donn√©s chaque ann√©e\nWITH ranked_prenoms AS (\n    SELECT\n        sexe,\n        preusuel,\n        annais,\n        nombre,\n        RANK() OVER (PARTITION BY annais ORDER BY nombre DESC) as rnk\n    FROM prenom\n   WHERE sexe = 2 AND annais &gt;= '1950'\n)\nSELECT annais,\n       preusuel\n  FROM ranked_prenoms\n WHERE rnk = 1\n ORDER BY annais;\n\n\n4.5 Diff√©rents pr√©noms\nCREATE OR REPLACE VIEW differents\nAS\nSELECT DISTINCT(preusuel)\n  FROM prenom;\n\nSELECT COUNT(1) \n FROM differents;\n\nSELECT *\n FROM differents\nWHERE preusuel LIKE '%A%B%C%';\n\n\nSELECT *\n FROM differents\nWHERE preusuel LIKE '%W%W%';\n\n\n4.6 Pr√©noms mixtes\nSELECT preusuel,\n       SUM(nombre) FILTER (WHERE sexe = 1) AS masculin,\n       SUM(nombre) FILTER (WHERE sexe = 2) AS feminin\n  FROM prenom\n GROUP BY preusuel\nHAVING masculin &gt; 1000 AND feminin &gt; 1000\n ORDER BY masculin + feminin DESC\n\n\n\n\n\n\nNoteCode Python\n\n\n\n\n\nprenom = \"ALIX\"\n\ntry:\n    query = f\"\"\"\n        SELECT preusuel,\n               annais,\n               SUM(nombre) FILTER (WHERE sexe = 1) AS masculin,\n               SUM(nombre) FILTER (WHERE sexe = 2) AS feminin\n          FROM prenom\n         WHERE preusuel = '{prenom}'\n           AND annais &lt;&gt; 'XXXX'\n           AND annais &gt;= '1950'\n         GROUP BY preusuel,\n                  annais\n         ORDER BY annais\n    \"\"\"\n    result = con.execute(query).fetchdf()\n\n    if not result.empty:\n\n        years = [int(y) for y in result['annais']]\n        countf = result['feminin']\n        countm = result['masculin']\n        \n        # Create the bar plot\n        plt.figure(figsize=(10, 6))\n        \n        plt.bar([y+0.2 for y in years], countf, color='lightcoral', label='Femmes')\n        plt.bar(years, countm, color='lightskyblue', label='Hommes')\n        \n        # Add labels and title\n        plt.xlabel(\"Ann√©e\")\n        plt.ylabel(\"Nombre de fois\")\n        plt.title(f\"√âvolution du Pr√©nom {prenom} par Ann√©e\")\n        \n        years_to_show = np.arange(min(years), max(years) + 1, 10)\n        plt.xticks(years_to_show, rotation=45, ha='right')\n        plt.tight_layout()\n        \n        # Add a legend\n        plt.legend()\n        \n        # Show the plot\n        plt.grid(axis='y', linestyle='--')\n        plt.show()\n\n\nexcept duckdb.Error as e:\n    print(f\"An error occurred with DuckDB: {e}\")\nexcept Exception as e:\n    print(f\"An unexpected error occurred: {e}\")\n\n\n\n\n\n4.7 Premi√®re lettre\nSELECT annais,\n       preusuel[1],\n       SUM(nombre) AS nb\n  FROM prenom\n WHERE annais &lt;&gt; 'XXXX'\n   AND annais = '2023'\n   AND sexe = 2\n GROUP BY annais,\n          preusuel[1]\n ORDER BY annais,\n          nb DESC\nWITH ranked_prenoms AS (\n    SELECT\n        annais,\n        preusuel[1] AS preusuel,\n        SUM(nombre) AS nb,\n        sexe,\n        ROW_NUMBER() OVER (PARTITION BY annais, sexe ORDER BY SUM(nombre) DESC) AS rn\n    FROM\n        prenom\n    WHERE\n        annais &lt;&gt; 'XXXX'\n    GROUP BY\n        annais,\n        preusuel[1],\n        sexe\n)\nSELECT\n    annais,\n    MAX(CASE WHEN sexe = 1 THEN preusuel END) AS maculin,\n    MAX(CASE WHEN sexe = 2 THEN preusuel END) AS feminin\nFROM\n    ranked_prenoms\nWHERE\n    rn = 1\nGROUP BY\n    annais\nORDER BY\n    annais;\n\n\n4.8 Par d√©partements\nCREATE OR REPLACE VIEW prenom_dep_raw AS FROM 'https://www.insee.fr/fr/statistiques/fichier/8205621/prenoms-2023-dpt.parquet';\n\nSELECT *\n  FROM prenom_dep_raw;\n\nCREATE OR REPLACE VIEW prenom_dep\nAS\nSELECT sexe, \n       STRIP_ACCENTS(preusuel) AS preusuel, \n       annais, \n       dpt,\n       nombre \n  FROM prenom_dep_raw\n WHERE annais &lt;&gt; 'XXXX'\n   AND dpt &lt;&gt; 'XX'\n   AND preusuel &lt;&gt; '_PRENOMS_RARES';"
  },
  {
    "objectID": "doc/cours/sql-avance.html",
    "href": "doc/cours/sql-avance.html",
    "title": "SQL avanc√©",
    "section": "",
    "text": "Donn√©es utilis√©es"
  },
  {
    "objectID": "doc/cours/sql-avance.html#sous-requ√™te",
    "href": "doc/cours/sql-avance.html#sous-requ√™te",
    "title": "SQL avanc√©",
    "section": "1 Sous-requ√™te",
    "text": "1 Sous-requ√™te\n\nDans un filtre\nVous souhaitez lister les joueuses avec un elo sup√©rieur √† la moyenne.\n\n\nSELECT nom, \n       prenom,\n       elo\nFROM echecs.joueuse\nWHERE elo &gt;= (SELECT AVG(elo) \n                FROM echecs.joueuse);\n\n\nVu dans les 1er TP :\n\nSELECT AVG(elo) FROM echecs.joueuse renvoie un nombre\non peut le comparer √† un autre nombre\n\n\n\n\nImbriquer les SELECT\nSELECT j.nom, \n       j.prenom, \n       j.elo,\n       mec.max_elo_club\n  FROM (SELECT id_club,\n               MAX(elo) AS max_elo_club\n          FROM joueuse\n         GROUP BY id_club) mec\n  JOIN joueuse j USING(id_club);\n\nCeci est √©galement une table et peut √™tre requ√™t√©e par la suite\nSELECT id_club,\n       MAX(elo) AS max_elo_club\n  FROM joueuse\n GROUP BY id_club\n\n\n\nEXISTS\nSELECT *\n  FROM echecs.club c\n WHERE EXISTS (SELECT 1\n                 FROM echecs.joueuse j\n                WHERE c.id_club = j.id_club\n                  AND j.elo &gt; 2400);\nLa syntaxe ressemble √† celle du IN mais le EXISTS est plus performant.\nSELECT *\n  FROM echecs.club c\n WHERE c.id_club IN (SELECT j.id_club\n                       FROM echecs.joueuse j\n                      WHERE j.elo &gt; 2400);\n\n\nEXISTS : d√®s qu‚Äôune correspondance est trouv√©e, c‚Äôest gagn√©\nIN : g√©n√©re l‚Äôint√©gralit√© de la sous-table"
  },
  {
    "objectID": "doc/cours/sql-avance.html#les-vues",
    "href": "doc/cours/sql-avance.html#les-vues",
    "title": "SQL avanc√©",
    "section": "2 Les vues",
    "text": "2 Les vues\n\nJoueuses Fran√ßaises\n\n\n\n\n\n\nNoteQuestion\n\n\n\nImaginons que nous avons de nombreuses requ√™tes √† √©crire sur les joueuses fran√ßaises ayant plus de 2000 elo.\nEt nous n‚Äôavons pas envie de nous emb√™ter √† √©crire √† chaque fois toutes les restrictions.\n\n\n\n\nNouvelle table\nSolution 1 : cr√©ons une nouvelle table\nCREATE TABLE echecs.joueuse_fr_2000\nAS\nSELECT *\n  FROM echecs.joueuse\n WHERE code_pays = 'FR'\n   AND elo &gt;= 2000\n\n\n\n\n\n\n\nCautionProbl√®mes\n\n\n\n\nDuplication des donn√©es\nMise √† jour\n\n\n\n\n\n\nCommon Table Expression\nPour une utilisation ponctuelle, utilisez une CTE üòé\n\nCommencez par d√©finir votre sous-requ√™te joueuses_fr_elo2000 avec WITH\nAppelez joueuses_fr_elo2000 dans la requ√™te principale\n\nWITH joueuses_fr_elo2000 \nAS (SELECT *\n      FROM echecs.joueuse\n     WHERE code_pays = 'FR' \n       AND elo &gt; 2000\n)\nSELECT nom, prenom, elo\n  FROM joueuses_fr_elo2000\n WHERE prenom LIKE 'A%';\n\n\nUsage avanc√©\nAssez classe\nComme une sous-requ√™te\nOu comme si vous avez cr√©√© une vue temporaire\n\n\n\n\nTable temporaire\nN‚Äôexiste que le temps de la session.\n\nCREATE TEMPORARY TABLE joueuses_fr_elo2000 \nAS\nSELECT *\n  FROM echecs.joueuse\n WHERE code_pays = 'FR' \n   AND elo &gt; 2000;\n\n\n\n\n\n\nCautionRemarque\n\n\n\nUne table temporaire n‚Äôest pas d√©finie dans un sch√©ma.\n\n\n\n\nVue\n\n\n\n\n\n\nNoteD√©finition\n\n\n\nUne vue repr√©sente une table virtuelle, dont la structure et les donn√©es proviennent du r√©sultat d‚Äôune requ√™te SQL pr√©d√©finie.\nElle ne stocke pas directement les donn√©es, mais la requ√™te elle-m√™me, et s‚Äôex√©cute √† chaque utilisation.\n\n\n\nCREATE VIEW echecs.joueuses_fr_elo2000 \nAS\nSELECT *\n  FROM echecs.joueuse\n WHERE code_pays = 'FR' \n   AND elo &gt; 2000;\n\n\nSe requ√™te comme si c‚Äôest une table\nSELECT only\nPAS de UPDATE, DELETE, INSERT\n\n\n\n\nAvantages et inconv√©nients\n\n‚úîÔ∏è Simplicit√© d‚Äôacc√®s aux donn√©es\n‚úîÔ∏è Meilleure organisation des donn√©es\n‚úîÔ∏è Contr√¥le des acc√®s aux donn√©es\n‚ùå Performance\n\n\n\nInterroger sans se soucier des structures complexes des tables\nSauvegarde de requ√™tes complexes\nStructurer logiquement les donn√©es\nMasquer des colonnes / lignes sensibles\n‚ùå s‚Äôex√©cutent dynamiquement √† chaque appel\n\n\n\n\nVues mat√©rialis√©es\nPhoto √† un instant t (snapshot) üì∑\n\nCREATE MATERIALIZED VIEW joueuses_fr_elo2000 \nAS\nSELECT *\n  FROM echecs.joueuse\n WHERE code_pays = 'FR' \n   AND elo &gt; 2000;"
  },
  {
    "objectID": "doc/cours/sql-avance.html#g√©rer-les-droits",
    "href": "doc/cours/sql-avance.html#g√©rer-les-droits",
    "title": "SQL avanc√©",
    "section": "3 G√©rer les droits",
    "text": "3 G√©rer les droits\nL‚Äôutilisateur qui cr√©e une table peut distribuer des droits aux autres.\nVoir section privil√©ges de la doc PostgreSQL\n\nDonner des droits sur une table\n-- Lecture pour tous\nGRANT SELECT ON echecs.joueuse TO PUBLIC;\n\n-- Tous les droits\nGRANT ALL PRIVILEGES ON echecs.joueuse TO chantal WITH GRANT OPTION;\n\n\nPUBLIC : tous les utilisateurs\nSuffixe WITH GRANT OPTION pour donner le droit de transmettre ce droit\n\n\nRemarque :\n\nSi vous donnez les droits WITH GRANT OPTION √† quelqu‚Äôun\nCette personne peut ensuite vous retirer les droits !\n\nsi vous n‚Äô√™tes pas propri√©taire de la table\n\n\npropri√©taire &lt;&gt; cr√©ateur\nALTER TABLE t OWNER TO michel;\n\n\n\nRetirer des droits\n-- Lecture\nREVOKE SELECT ON echecs.joueuse TO chantal;\n\n-- Tous les droits\nREVOKE ALL PRIVILEGES ON echecs.joueuse TO chantal;\n\nSuffixe CASCADE pour retirer les droits √† ceux qui ont re√ßu les droits de la part de‚Ä¶\n\n\nR√¥le\nPour une gestion simplifi√©e des droits\n-- cr√©er un r√¥le\nCREATE ROLE eleve;\n\n-- ajouter des droits au r√¥le\nGRANT SELECT, INSERT ON echecs.joueuse TO eleve;\n\n-- donner le r√¥le √† Chantal\nGRANT eleve TO chantal;\n\nImaginons que pour chaque nouvel √©l√®ve, il faut donner les droits sur 20 tables.\nPlus pratique avec les r√¥les.\n\n\n\nDroits sur un sch√©ma\n-- droit d'acc√®s au sch√©ma i.e. de consulter les objets du sch√©ma\nGRANT USAGE ON SCHEMA echecs TO PUBLIC;\n\n-- retire √† Chantal le droit de cr√©er de nouveaux objets (tables, vues, etc.) dans le sch√©ma\nREVOKE CREATE ON SCHEMA echecs FROM chantal;\n\n-- Autorise √† effectuer des requ√™tes SELECT sur toutes les tables du sch√©ma\nGRANT SELECT ON ALL TABLES IN SCHEMA echecs TO PUBLIC;\n\npas de question √† l‚Äôexam sur les droits de sch√©ma"
  },
  {
    "objectID": "doc/cours/sql-avance.html#transactions",
    "href": "doc/cours/sql-avance.html#transactions",
    "title": "SQL avanc√©",
    "section": "4 Transactions",
    "text": "4 Transactions\n\nExemple classique\n\n\n\n\n\n\nImportantMission\n\n\n\nVous devez transf√©rer discr√©tement et sans vous tromper 10 millions entre les comptes de Shakira et Cristiano.\nMalheureusement l‚Äôop√©ration est assez longue et vous devez vous pr√©munir contre le risque d‚Äôune interruption.\nComment faire ? üòï\n\n\n\n\nTransfert de fonds\nBEGIN; -- D√©but de la transaction\n\nUPDATE compte SET solde = solde - 10000000 WHERE id = 1;\nUPDATE compte SET solde = solde + 10000000 WHERE id = 2;\n\nCOMMIT; -- Valider si ok\n\nROLLBACK; -- en cas d'erreur\n\n\nPlusieurs utilisateurs peuvent faire des requ√™tes en m√™me temps\nLOCK\nSAVEPOINT my_savepoint;\nROLLBACK TO my_savepoint;\nmode AUTOCOMMIT\n\n\n\n\nPropri√©t√©s ACID\nPour d√©finir la fiabilit√© des transactions :\n\nAtomicit√© : Une transaction est ‚Äútout ou rien‚Äù\nCoh√©rence : La base reste dans un √©tat valide avant et apr√®s la transaction\nIsolation : Les transactions concurrentes n‚Äôinterf√®rent pas entre elles\nDurabilit√© : Une transaction valid√©e est enregistr√©e de mani√®re permanente, m√™me en cas de panne\n\n\n\nSoit toutes les op√©rations r√©ussissent, soit elles sont annul√©es (rollback)"
  },
  {
    "objectID": "doc/cours/sql-avance.html#index",
    "href": "doc/cours/sql-avance.html#index",
    "title": "SQL avanc√©",
    "section": "5 Index",
    "text": "5 Index\n\nOptimisation\nPossible d‚Äôoptimiser √† plusieurs niveaux :\n\nLogique : Normalisation / D√©normalisation\nPhysique : Indexation, Partitionnement\nRequ√™tes SQL\n\n\n\nNormaliser pour √©viter la redondance et les anomalies\nD√©-normaliser quand les lectures sont plus fr√©quentes que les √©critures\nBon typage\nIndexation, Partitionnement\n√âviter SELECT * ‚Üí ne charger que les colonnes utiles.\nV√©rifier le plan d‚Äôex√©cution :\n\nEXPLAIN SELECT * FROM joueuse WHERE prenom = ‚ÄòAmandine‚Äô;\n\n\n\nCr√©er un index\n\n\n\n\n\n\nNoteD√©finition\n\n\n\nUn index est une structure de donn√©es qui am√©liore la vitesse des op√©rations de lecture sur une table en facilitant la recherche des donn√©es.\nIl permet une lecture plus rapide sur une colonne utilis√©e fr√©quemment dans WHERE, JOIN, GROUP BY, ORDER BY\n\n\nCREATE INDEX echecs.idx_prenom_joueuse ON echecs.joueuse (prenom);\n\n\nRecherche longue si beaucoup de lignes\nSyst√®me cl√©-valeur (index -&gt; ligne)\n\n\n\n\nApplication\nSELECT *\n  FROM echecs.joueuse\n WHERE prenom = 'Amandine';\n\nSans index : parcourt int√©gral de la table\nAvec index :\n\nrecherche sous forme d‚Äôarbre, r√©cup√®re les id\nlit directement les lignes concern√©es\n\n\n\n\nindex stock√© sous forme d‚Äôun arbre B+ tri√© sur prenom\nrecherche logarithmique : tr√®s rapide O(log n)\nindex contient des pointeurs vers les lignes correspondantes dans la table\n\n\n\n\nAvantages et inconv√©nients\n\n‚úîÔ∏è Haute cardinalit√©\n‚úîÔ∏è Peu de valeurs nulles\n‚ùå Cr√©ations, mises √† jour\n‚ùå Prend de la place\n\n\n\nsi Haute cardinalit√© : beaucoup de valeurs distinctes\nSi une colonne est souvent modifi√©e, l‚Äôindex associ√© doit √™tre mis √† jour\nIndex sous jacent sur colonnes UNIQUE (PK incluse)"
  },
  {
    "objectID": "doc/cours/sql-avance.html#fonction",
    "href": "doc/cours/sql-avance.html#fonction",
    "title": "SQL avanc√©",
    "section": "6 Fonction",
    "text": "6 Fonction\n\nBloc de code nomm√© qui retourne une valeur\nEncapsuler une logique m√©tier simple.\n\nSELECT nom, \n       get_categorie(date_naissance)\n  FROM echecs.joueuse;\n\nExemple\nCREATE OR REPLACE FUNCTION echecs.get_categorie(p_date_naissance DATE)\nRETURNS VARCHAR(20) AS $$\nDECLARE\n    age INT;\nBEGIN\n    age := DATE_PART('year', AGE(CURRENT_DATE, p_date_naissance));\n\n    IF age &lt; 20 THEN\n        RETURN 'Junior';\n    ELSIF age &lt; 60 THEN\n        RETURN 'Senior';\n    ELSE\n        RETURN 'V√©t√©ran';\n    END IF;\nEND;\n$$ LANGUAGE plpgsql;"
  },
  {
    "objectID": "doc/cours/sql-avance.html#proc√©dure",
    "href": "doc/cours/sql-avance.html#proc√©dure",
    "title": "SQL avanc√©",
    "section": "7 Proc√©dure",
    "text": "7 Proc√©dure\n\nBloc de code SQL ex√©cut√© manuellement avec CALL\nPeut modifier la base de donn√©es\nNe retourne pas de valeur\nAutomatiser une s√©rie d‚Äôactions\n\nCALL augmenter_elo(3, 50);"
  },
  {
    "objectID": "doc/cours/sql-avance.html#trigger",
    "href": "doc/cours/sql-avance.html#trigger",
    "title": "SQL avanc√©",
    "section": "8 Trigger",
    "text": "8 Trigger\n\nSe d√©clenchent quand un √©v√©nement survient sur une table\nServent √† maintenir la coh√©rence ou enregistrer des historiques\n\nExemples :\n\nTenir un journal d‚Äôaudit, historiser les changements\nAppliquer des r√®gles automatiques\n\n\nPeut se d√©clencher avant ou apr√®s une maj\n\nGarantir l‚Äôint√©grit√© des donn√©es : Valider ou corriger les donn√©es avant leur enregistrement.\nImpl√©menter des r√®gles m√©tier : Emp√™cher des suppressions ou modifications non autoris√©es.\nSynchroniser des donn√©es : Mettre √† jour des tables li√©es automatiquement."
  },
  {
    "objectID": "doc/cours/sql-avance-slides.html#sous-requ√™te",
    "href": "doc/cours/sql-avance-slides.html#sous-requ√™te",
    "title": "SQL avanc√©",
    "section": "Sous-requ√™te",
    "text": "Sous-requ√™te"
  },
  {
    "objectID": "doc/cours/sql-avance-slides.html#les-vues",
    "href": "doc/cours/sql-avance-slides.html#les-vues",
    "title": "SQL avanc√©",
    "section": "Les vues",
    "text": "Les vues"
  },
  {
    "objectID": "doc/cours/sql-avance-slides.html#g√©rer-les-droits",
    "href": "doc/cours/sql-avance-slides.html#g√©rer-les-droits",
    "title": "SQL avanc√©",
    "section": "G√©rer les droits",
    "text": "G√©rer les droits\nL‚Äôutilisateur qui cr√©e une table peut distribuer des droits aux autres.\nVoir section privil√©ges de la doc PostgreSQL"
  },
  {
    "objectID": "doc/cours/sql-avance-slides.html#transactions",
    "href": "doc/cours/sql-avance-slides.html#transactions",
    "title": "SQL avanc√©",
    "section": "Transactions",
    "text": "Transactions"
  },
  {
    "objectID": "doc/cours/sql-avance-slides.html#index",
    "href": "doc/cours/sql-avance-slides.html#index",
    "title": "SQL avanc√©",
    "section": "Index",
    "text": "Index"
  },
  {
    "objectID": "doc/cours/sql-avance-slides.html#fonction",
    "href": "doc/cours/sql-avance-slides.html#fonction",
    "title": "SQL avanc√©",
    "section": "Fonction",
    "text": "Fonction\n\nBloc de code nomm√© qui retourne une valeur\nEncapsuler une logique m√©tier simple.\n\nSELECT nom, \n       get_categorie(date_naissance)\n  FROM echecs.joueuse;"
  },
  {
    "objectID": "doc/cours/sql-avance-slides.html#proc√©dure",
    "href": "doc/cours/sql-avance-slides.html#proc√©dure",
    "title": "SQL avanc√©",
    "section": "Proc√©dure",
    "text": "Proc√©dure\n\nBloc de code SQL ex√©cut√© manuellement avec CALL\nPeut modifier la base de donn√©es\nNe retourne pas de valeur\nAutomatiser une s√©rie d‚Äôactions\n\nCALL augmenter_elo(3, 50);"
  },
  {
    "objectID": "doc/cours/sql-avance-slides.html#trigger",
    "href": "doc/cours/sql-avance-slides.html#trigger",
    "title": "SQL avanc√©",
    "section": "Trigger",
    "text": "Trigger\n\nSe d√©clenchent quand un √©v√©nement survient sur une table\nServent √† maintenir la coh√©rence ou enregistrer des historiques\n\nExemples :\n\nTenir un journal d‚Äôaudit, historiser les changements\nAppliquer des r√®gles automatiques\n\n\nPeut se d√©clencher avant ou apr√®s une maj\n\nGarantir l‚Äôint√©grit√© des donn√©es : Valider ou corriger les donn√©es avant leur enregistrement.\nImpl√©menter des r√®gles m√©tier : Emp√™cher des suppressions ou modifications non autoris√©es.\nSynchroniser des donn√©es : Mettre √† jour des tables li√©es automatiquement."
  },
  {
    "objectID": "doc/cours/algebre.html",
    "href": "doc/cours/algebre.html",
    "title": "Alg√®bre Relationnelle",
    "section": "",
    "text": "A Relational Model of Data for Large Shared Data Banks, Edgar F. Codd, 1970\nObjectif : Mod√©liser une base de donn√©es ainsi que ses op√©rations\nDans un SGBD relationel, tout est question de relation"
  },
  {
    "objectID": "doc/cours/algebre.html#alg√®bre-relationnelle",
    "href": "doc/cours/algebre.html#alg√®bre-relationnelle",
    "title": "Alg√®bre Relationnelle",
    "section": "",
    "text": "A Relational Model of Data for Large Shared Data Banks, Edgar F. Codd, 1970\nObjectif : Mod√©liser une base de donn√©es ainsi que ses op√©rations\nDans un SGBD relationel, tout est question de relation"
  },
  {
    "objectID": "doc/cours/algebre.html#principaux-op√©rateurs",
    "href": "doc/cours/algebre.html#principaux-op√©rateurs",
    "title": "Alg√®bre Relationnelle",
    "section": "2 Principaux op√©rateurs",
    "text": "2 Principaux op√©rateurs\n\n\n\n\n\n\n\n\nOp√©rateur\nDescription\n\n\n\n\nœÉ (S√©lection)\nFiltrer les lignes selon une condition\n\n\nœÄ (Projection)\nS√©lectionner des colonnes sp√©cifiques\n\n\nU (Union)\nCombiner les lignes de deux relations\n\n\n‚àí (Diff√©rence)\nRetourner les lignes pr√©sentes dans une relation mais pas dans l‚Äôautre\n\n\n‚à© (Intersection)\nTrouver les lignes communes aux deux relations\n\n\n‚®ù (Jointure)\nCombiner deux relations bas√©es sur une condition\n\n\nx (Produit Cart√©sien)\nCombinaison des colonnes\n\n\n\n\n\nS√©lection\n\nPermet de filtrer les lignes d‚Äôune table selon une condition\n\n\n\n‚ö†Ô∏è Mot cl√© SQL associ√© : WHERE\n\nSELECT *\n  FROM echecs.joueuse\n WHERE elo &lt; 2400;\n\n\n\nProjection\n\nPermet de s√©lectionner certaines colonnes d‚Äôune table.\nMot cl√© SQL associ√© : SELECT\n\nSELECT nom,\n       prenom\n  FROM echecs.joueuse;\n\n\nUnion\n\nCombine les lignes de deux tables ayant le m√™me nombre de colonnes et des types compatibles\n\nSELECT nom,\n       prenom\n  FROM echecs.joueuse\n\nUNION\n\nSELECT nom,\n       prenom\n  FROM echecs.joueur;\n\n\n\n\n\n\nTip\n\n\n\n\nUNION : Combine les r√©sultats des requ√™tes et supprime les doublons\nUNION ALL : Combine les r√©sultats des requ√™tes et garde tous les doublons\n\n\n\n\n\nEn g√©n√©ral, on prend les m√™mes colonnes des 2 c√¥t√©s\nPossible de faire plusieurs UNION\nORDER BY √† la fin : ordonne le tout\n\n\n\n\nDiff√©rence\n\nLignes qui se trouvent dans la premi√®re relation mais pas dans la seconde\n\n-- Joueuses √©voluant dans un club fran√ßais et pas dans un club belge\nSELECT nom,\n       prenom\n  FROM echecs.joueuse_club_fr\n\nEXCEPT\n\nSELECT nom,\n       prenom\n  FROM echecs.joueuse_club_be;\n\nImaginons que vous ayez cr√©√© 2 tables :\n\njoueuses √©voluant dans un club fran√ßais\njoueuses √©voluant dans un club belge\n\n\n\n\nIntersection\n\nLignes communes aux deux tables\n\n-- Joueuses √©voluant dans un club francais et dans un club belge\nSELECT nom,\n       prenom\n  FROM echecs.joueuse_club_fr\n\nINTERSECT\n\nSELECT nom,\n       prenom\n  FROM echecs.joueuse_club_be;\n\n\nJointure\n\nPermet de combiner deux tables en se basant sur une correspondance entre les colonnes\n\nSELECT j.nom,\n       j.prenom,\n       c.nom AS club\n  FROM echecs.joueuse j\n  JOIN echecs.club c USING (id_club);\n\n\nProduit Cart√©sien\nSELECT *\n  FROM echecs.joueuse j,\n       echecs.club c;\n-- WHERE j.id_club = c.id_club\n\nAncienne pratique : utilis√© avant √† la place des jointures"
  },
  {
    "objectID": "doc/cours/algebre-slides.html#alg√®bre-relationnelle",
    "href": "doc/cours/algebre-slides.html#alg√®bre-relationnelle",
    "title": "Alg√®bre Relationnelle",
    "section": "Alg√®bre Relationnelle",
    "text": "Alg√®bre Relationnelle\n\nA Relational Model of Data for Large Shared Data Banks, Edgar F. Codd, 1970\nObjectif : Mod√©liser une base de donn√©es ainsi que ses op√©rations\nDans un SGBD relationel, tout est question de relation"
  },
  {
    "objectID": "doc/cours/algebre-slides.html#principaux-op√©rateurs",
    "href": "doc/cours/algebre-slides.html#principaux-op√©rateurs",
    "title": "Alg√®bre Relationnelle",
    "section": "Principaux op√©rateurs",
    "text": "Principaux op√©rateurs\n\n\n\n\n\n\n\n\nOp√©rateur\nDescription\n\n\n\n\nœÉ (S√©lection)\nFiltrer les lignes selon une condition\n\n\nœÄ (Projection)\nS√©lectionner des colonnes sp√©cifiques\n\n\nU (Union)\nCombiner les lignes de deux relations\n\n\n‚àí (Diff√©rence)\nRetourner les lignes pr√©sentes dans une relation mais pas dans l‚Äôautre\n\n\n‚à© (Intersection)\nTrouver les lignes communes aux deux relations\n\n\n‚®ù (Jointure)\nCombiner deux relations bas√©es sur une condition\n\n\nx (Produit Cart√©sien)\nCombinaison des colonnes"
  },
  {
    "objectID": "doc/cours/intro.html",
    "href": "doc/cours/intro.html",
    "title": "Bases de Donn√©es Relationnelles et SQL",
    "section": "",
    "text": "6h CM\n15h TP + 3h TD\nludovic.deneuville@ensai.fr\nbureau 161\nsur la base des cours de Benjamin Girault"
  },
  {
    "objectID": "doc/cours/intro.html#bases-de-donn√©es-relationnelles-et-sql",
    "href": "doc/cours/intro.html#bases-de-donn√©es-relationnelles-et-sql",
    "title": "Bases de Donn√©es Relationnelles et SQL",
    "section": "",
    "text": "6h CM\n15h TP + 3h TD\nludovic.deneuville@ensai.fr\nbureau 161\nsur la base des cours de Benjamin Girault"
  },
  {
    "objectID": "doc/cours/intro.html#objectifs",
    "href": "doc/cours/intro.html#objectifs",
    "title": "Bases de Donn√©es Relationnelles et SQL",
    "section": "Objectifs",
    "text": "Objectifs\n\nInterrogation\nCr√©ation\nMod√©lisation\nSavoir utiliser le langage SQL\n\n\nLe plus important, savoir explorer une bdd pour en extraire des infos.\nUML pour la mod√©lisation"
  },
  {
    "objectID": "doc/cours/intro.html#sql",
    "href": "doc/cours/intro.html#sql",
    "title": "Bases de Donn√©es Relationnelles et SQL",
    "section": "SQL",
    "text": "SQL\n\nSyntaxe simple\nD√©claratif\nEfficace\nTr√®s utilis√©\n\n\n\nComp√©tence indispensable du Datascientist\n√ßa s‚Äôencapsule dans plein de langages (R, Python, Julia, Stata, SAS‚Ä¶)\nutile pour Big Data"
  },
  {
    "objectID": "doc/cours/intro.html#conventions",
    "href": "doc/cours/intro.html#conventions",
    "title": "Bases de Donn√©es Relationnelles et SQL",
    "section": "Conventions",
    "text": "Conventions\n\n&lt;...&gt; : texte √† remplacer\n[...] : √©l√©ment optionnel\nUne requ√™te se termine par un ;\n-- Ce qui vient ensuite est comment√©\n\n\n\nParfois possible d‚Äôutiliser /* commentaire */\n; : m√™me si les logiciels souvent s‚Äôen moquent\n\n\n\nRequ√™tes SQL jolies\n\nRetour √† la ligne\nMots cl√©s align√©s\nMots cl√©s en MAJUSCULE\n\n\n\nMots cl√©s en MAJUSCULE, reste en minuscules\n\n\n\n\n\npasbien.sql\n\nSELECT c.nom AS club, AVG(j.elo) AS moyenne_elo FROM joueuse j INNER JOIN club c \nUSING (id_club) WHERE mail IS NOT NULL GROUP BY c.nom HAVING AVG(j.elo) &gt; 2000 ORDER BY 2 DESC;\n\n\n\n\n\n\n\nQue fait cette requ√™te ?\nVoici ma r√©action quand je vois √ßa !\n\n\n\n\nbien.sql\n\nSELECT c.nom AS club, \n       AVG(j.elo) AS moyenne_elo\n  FROM joueuse j \n INNER JOIN club c USING (id_club) \n WHERE j.mail IS NOT NULL \n GROUP BY c.nom\nHAVING AVG(j.elo) &gt; 2000\n ORDER BY 2 DESC;\n\n\n\n\n\n\n\nAlors qu‚Äôici tout le monde voit imm√©diatement ce que fait la requ√™te.\nFaites un effort pour vous m√™me et pour vos relecteurs.\nSQL : langage d√©claratif (ne d√©crit pas des algorithmes, mais d√©clare un r√©sultat attendu)\nLe SQL √ßa ressemble √† √ßa (1ere lecture de requ√™te) :\n\nTableau de joueuse et de club\nfiltre pour garder si mail non NULL\nAggr√©gation par nom de club -&gt; que l‚Äôon affiche"
  },
  {
    "objectID": "doc/cours/intro.html#les-tp",
    "href": "doc/cours/intro.html#les-tp",
    "title": "Bases de Donn√©es Relationnelles et SQL",
    "section": "Les TP",
    "text": "Les TP\n5 TP + 1 TD\n\nBase de donn√©es : PostgreSQL\nCommunication avec la BDD : cloudBeaver\nDatalab SSPCloud de l‚ÄôINSEE\n\ncr√©er un compte avec : prenom.nom@eleve.ensai.fr\n\nDatalab du GENES\n\n\nRappel Datalab : Infra + logiciel Onyxia\n\nBDD :\n\nPostgreSQL : install√© sur un serveur\nDuckDB : embarqu√©, travaille en m√©moire\n\nCloudBeaver = une application web pour interagir facilement avec PostgreSQL\nSur les VM : DBeaver + une bdd chacun\n\n\n\nCe qu‚Äôil faut faire\n\nLire attentivement les consignes\nEssayer de r√©soudre par soi m√™me\nChercher dans le cours / sur internet\nDemander de l‚Äôaide √† ses camarades\nDemander de l‚Äôaide √† l‚Äôenseignant\n\n\n√ßa peut paraitre un peu infentilisant mais c‚Äôest n√©cessaire de le rappeler !!!\nsi je demande un setup‚Ä¶ faites le sinon √ßa risque de p√©ter plus tard.\n\n\n\n√Ä ne pas faire\n\nCopier l‚Äô√©nonc√© sur une IAGen\nColler la r√©ponse sans rien comprendre\n\n\nSauf si vous voulez ne rien retenir‚Ä¶\n\nJe ne dis pas qu‚Äôil ne faut jamais utiliser les LLM\n√ßa peut servir pour d√©bgugger\nou pour des taches sans VA"
  },
  {
    "objectID": "doc/cours/intro.html#√©valuation",
    "href": "doc/cours/intro.html#√©valuation",
    "title": "Bases de Donn√©es Relationnelles et SQL",
    "section": "√âvaluation",
    "text": "√âvaluation\n\nLundi 5 Janvier 10h\nDur√©e : 2h\nSur papier\nSans documents\n\n\n\npartie QCM\ndes requ√™tes SQL √† √©crire\npas de pi√®ges\npour v√©rifier que vous retenez l‚Äôessentiel"
  },
  {
    "objectID": "doc/cours/intro.html#bibliographie",
    "href": "doc/cours/intro.html#bibliographie",
    "title": "Bases de Donn√©es Relationnelles et SQL",
    "section": "Bibliographie",
    "text": "Bibliographie\n\nhttps://laurent-audibert.developpez.com/Cours-BD/\nhttps://upinfo.univ-cotedazur.fr/im/bases-de-donnees/\nhttps://oseox.fr/sql/\nhttps://learnsql.fr/blog/aide-memoire-pour-les-entretiens-sql/\nhttps://datascientest.com/base-de-donnees-definition\nhttps://www.postgresql.org/docs/current/sql.html\n\n\nAu passage :\n\nImportance de la biblio en projet, stage\nCommencez toujours par explorer ce qui a √©t√© fait sur le sujet"
  },
  {
    "objectID": "doc/cours/intro-slides.html#bases-de-donn√©es-relationnelles-et-sql",
    "href": "doc/cours/intro-slides.html#bases-de-donn√©es-relationnelles-et-sql",
    "title": "Bases de Donn√©es Relationnelles et SQL",
    "section": "Bases de Donn√©es Relationnelles et SQL",
    "text": "Bases de Donn√©es Relationnelles et SQL\n\n6h CM\n15h TP + 3h TD\nludovic.deneuville@ensai.fr\nbureau 161\nsur la base des cours de Benjamin Girault"
  },
  {
    "objectID": "doc/cours/intro-slides.html#objectifs",
    "href": "doc/cours/intro-slides.html#objectifs",
    "title": "Bases de Donn√©es Relationnelles et SQL",
    "section": "Objectifs",
    "text": "Objectifs\n\nInterrogation\nCr√©ation\nMod√©lisation\nSavoir utiliser le langage SQL\n\n\nLe plus important, savoir explorer une bdd pour en extraire des infos.\nUML pour la mod√©lisation"
  },
  {
    "objectID": "doc/cours/intro-slides.html#sql",
    "href": "doc/cours/intro-slides.html#sql",
    "title": "Bases de Donn√©es Relationnelles et SQL",
    "section": "SQL",
    "text": "SQL\n\nSyntaxe simple\nD√©claratif\nEfficace\nTr√®s utilis√©\n\n\n\nComp√©tence indispensable du Datascientist\n√ßa s‚Äôencapsule dans plein de langages (R, Python, Julia, Stata, SAS‚Ä¶)\nutile pour Big Data"
  },
  {
    "objectID": "doc/cours/intro-slides.html#conventions",
    "href": "doc/cours/intro-slides.html#conventions",
    "title": "Bases de Donn√©es Relationnelles et SQL",
    "section": "Conventions",
    "text": "Conventions\n\n&lt;...&gt; : texte √† remplacer\n[...] : √©l√©ment optionnel\nUne requ√™te se termine par un ;\n-- Ce qui vient ensuite est comment√©\n\n\n\nParfois possible d‚Äôutiliser /* commentaire */\n; : m√™me si les logiciels souvent s‚Äôen moquent"
  },
  {
    "objectID": "doc/cours/intro-slides.html#les-tp",
    "href": "doc/cours/intro-slides.html#les-tp",
    "title": "Bases de Donn√©es Relationnelles et SQL",
    "section": "Les TP",
    "text": "Les TP\n5 TP + 1 TD\n\nBase de donn√©es : PostgreSQL\nCommunication avec la BDD : cloudBeaver\nDatalab SSPCloud de l‚ÄôINSEE\n\ncr√©er un compte avec : prenom.nom@eleve.ensai.fr\n\nDatalab du GENES\n\n\nRappel Datalab : Infra + logiciel Onyxia\n\nBDD :\n\nPostgreSQL : install√© sur un serveur\nDuckDB : embarqu√©, travaille en m√©moire\n\nCloudBeaver = une application web pour interagir facilement avec PostgreSQL\nSur les VM : DBeaver + une bdd chacun"
  },
  {
    "objectID": "doc/cours/intro-slides.html#√©valuation",
    "href": "doc/cours/intro-slides.html#√©valuation",
    "title": "Bases de Donn√©es Relationnelles et SQL",
    "section": "√âvaluation",
    "text": "√âvaluation\n\nLundi 5 Janvier 10h\nDur√©e : 2h\nSur papier\nSans documents\n\n\n\npartie QCM\ndes requ√™tes SQL √† √©crire\npas de pi√®ges\npour v√©rifier que vous retenez l‚Äôessentiel"
  },
  {
    "objectID": "doc/cours/intro-slides.html#bibliographie",
    "href": "doc/cours/intro-slides.html#bibliographie",
    "title": "Bases de Donn√©es Relationnelles et SQL",
    "section": "Bibliographie",
    "text": "Bibliographie\n\nhttps://laurent-audibert.developpez.com/Cours-BD/\nhttps://upinfo.univ-cotedazur.fr/im/bases-de-donnees/\nhttps://oseox.fr/sql/\nhttps://learnsql.fr/blog/aide-memoire-pour-les-entretiens-sql/\nhttps://datascientest.com/base-de-donnees-definition\nhttps://www.postgresql.org/docs/current/sql.html\n\n\nAu passage :\n\nImportance de la biblio en projet, stage\nCommencez toujours par explorer ce qui a √©t√© fait sur le sujet"
  },
  {
    "objectID": "doc/cours/bases-de-donnees.html",
    "href": "doc/cours/bases-de-donnees.html",
    "title": "Bases de Donn√©es",
    "section": "",
    "text": "texte (nom, pr√©nom, ville‚Ä¶)\nnum√©rique (age, prix‚Ä¶)\ndate\nliste (comp√©tences, loisirs)\nimage\nfichier\n\n\n\nC‚Äôest quoi une donn√©e ?\n\ntypes ?\nvaleurs ?\nrepr√©sente quelque chose\n\n\n\n\n\n\n\n\n\n\n\nNoteD√©finition\n\n\n\nUne donn√©e est une information brute compos√©e de 3 √©l√©ments :\n\nun concept (exemple : hauteur d‚Äôun monument)\nun domaine des possibles (nombre entier positif et une unit√© : m√®tres)\nune valeur (pour la tour Eiffel : 324)\n\n\n\nSource : Qu‚Äôest-ce qu‚Äôune donn√©e ?, Courrier des statistiques N5, Pascal Rivi√®re\n\n\n\n\n\n\nFichier txt\nFichier csv\nFichier json, Exemple\nFichier parquet\nBase de donn√©es\n\n\n\nJ‚Äôavais eu une question lors de la prez Git : o√π on stocke les donn√©es si on peut pas les mettre sur GitHub.\n\nOn ne garde pas les donn√©es sur sa machine (risque de fuite)\nDans l‚Äôid√©al on bosse dans le cloud et on stocke sur S3\nSinon on travaille dans un espace d√©di√© (AUS)\n\nSuivre sur Linkedin : Mauvi√®re, Holtz, Blefari, Lesur, Galiana, Degorre, Natacha NJONGWA\n\n\n\n\n\nStockage orient√© colonne\nContient des m√©tadonn√©es\nAdapt√© pour le stockage de donn√©es fig√©es\n\n\n\n\n\n\n\nTipArticles int√©ressants\n\n\n\n\nParquet pour remplacer csv, √âric Mauvi√®re, Icem7\nComment bien pr√©parer son Parquet, √âric Mauvi√®re, Icem7\nLire et √©crire des fichiers Parquet, UtilitR\n\n\n\n\n\nDonn√©es fig√©es -&gt; parquet\nDonn√©es mouvantes -&gt; bdd PostgreSQL\nTad Viewer pour afficher le contenu d‚Äôun parquet\n\nParquet : retenez bien ce format.\nEt pas ‚Äúplancher‚Äù comme on a pu me dire en exam"
  },
  {
    "objectID": "doc/cours/bases-de-donnees.html#une-donn√©e",
    "href": "doc/cours/bases-de-donnees.html#une-donn√©e",
    "title": "Bases de Donn√©es",
    "section": "",
    "text": "texte (nom, pr√©nom, ville‚Ä¶)\nnum√©rique (age, prix‚Ä¶)\ndate\nliste (comp√©tences, loisirs)\nimage\nfichier\n\n\n\nC‚Äôest quoi une donn√©e ?\n\ntypes ?\nvaleurs ?\nrepr√©sente quelque chose\n\n\n\n\n\n\n\n\n\n\n\nNoteD√©finition\n\n\n\nUne donn√©e est une information brute compos√©e de 3 √©l√©ments :\n\nun concept (exemple : hauteur d‚Äôun monument)\nun domaine des possibles (nombre entier positif et une unit√© : m√®tres)\nune valeur (pour la tour Eiffel : 324)\n\n\n\nSource : Qu‚Äôest-ce qu‚Äôune donn√©e ?, Courrier des statistiques N5, Pascal Rivi√®re\n\n\n\n\n\n\nFichier txt\nFichier csv\nFichier json, Exemple\nFichier parquet\nBase de donn√©es\n\n\n\nJ‚Äôavais eu une question lors de la prez Git : o√π on stocke les donn√©es si on peut pas les mettre sur GitHub.\n\nOn ne garde pas les donn√©es sur sa machine (risque de fuite)\nDans l‚Äôid√©al on bosse dans le cloud et on stocke sur S3\nSinon on travaille dans un espace d√©di√© (AUS)\n\nSuivre sur Linkedin : Mauvi√®re, Holtz, Blefari, Lesur, Galiana, Degorre, Natacha NJONGWA\n\n\n\n\n\nStockage orient√© colonne\nContient des m√©tadonn√©es\nAdapt√© pour le stockage de donn√©es fig√©es\n\n\n\n\n\n\n\nTipArticles int√©ressants\n\n\n\n\nParquet pour remplacer csv, √âric Mauvi√®re, Icem7\nComment bien pr√©parer son Parquet, √âric Mauvi√®re, Icem7\nLire et √©crire des fichiers Parquet, UtilitR\n\n\n\n\n\nDonn√©es fig√©es -&gt; parquet\nDonn√©es mouvantes -&gt; bdd PostgreSQL\nTad Viewer pour afficher le contenu d‚Äôun parquet\n\nParquet : retenez bien ce format.\nEt pas ‚Äúplancher‚Äù comme on a pu me dire en exam"
  },
  {
    "objectID": "doc/cours/bases-de-donnees.html#une-base-de-donn√©es",
    "href": "doc/cours/bases-de-donnees.html#une-base-de-donn√©es",
    "title": "Bases de Donn√©es",
    "section": "2 Une base de donn√©es ?",
    "text": "2 Une base de donn√©es ?\n\n\n\n\n\n\n\nNoteD√©finition\n\n\n\nUne base de donn√©es est un ensemble de donn√©es rassembl√©es et stock√©es de mani√®re organis√©e dans un but sp√©cifique.\n\n\n\n\nTypes ?\nOn n‚Äôutilise pas la m√™me structure pour du texte, des fichiers, des images."
  },
  {
    "objectID": "doc/cours/bases-de-donnees.html#usages",
    "href": "doc/cours/bases-de-donnees.html#usages",
    "title": "Bases de Donn√©es",
    "section": "3 Usages",
    "text": "3 Usages\n\n3.1 Usage transactionnel\n\nFaire fonctionner le syst√®me au quotidien\nOLTP : On-Line Transaction Processing\nApplications et utilisateurs m√©tiers\n\n\nC‚Äôest quoi un domaine m√©tier ?\n\n\n\n3.2 Usage d√©cisionnel\n\nAnalyser et comprendre ce qui se passe\nOLAP : On-Line Analytical Processing\nExplorer de grands volumes de donn√©es historiques pour aider √† la d√©cision\nData warehouse, outils BI\n\n\nDonn√©es pour les d√©cideurs, tendances‚Ä¶\nLe syst√®me d√©cisionnel est souvent aliment√© par le transactionnel via des ETL : Extract ‚Äì Transform ‚Äì Load"
  },
  {
    "objectID": "doc/cours/bases-de-donnees.html#enjeux",
    "href": "doc/cours/bases-de-donnees.html#enjeux",
    "title": "Bases de Donn√©es",
    "section": "4 Enjeux",
    "text": "4 Enjeux\n\n\nAcc√®s aux donn√©es : langage SQL\nS√©curit√© des donn√©es : seuls les utilisateurs autoris√©s (droits)\nPartage des donn√©es : facile en lecture, mais en √©criture ?\nNon-redondance des donn√©es\nCoh√©rence des donn√©es : respect des contraintes d‚Äôint√©grit√©\n\n\n\nLe r√¥le du SGBD est de r√©pondre √† ces enjeux.\n\nSe brancher √† la BDD qui est sur un serveur\nR√®gles pour la coh√©rence. ‚ö†Ô∏è trop de r√®gles -&gt; bon dosage"
  },
  {
    "objectID": "doc/cours/bases-de-donnees.html#types-de-bases-de-donn√©es",
    "href": "doc/cours/bases-de-donnees.html#types-de-bases-de-donn√©es",
    "title": "Bases de Donn√©es",
    "section": "5 Types de bases de donn√©es",
    "text": "5 Types de bases de donn√©es\n\n5.1 Hi√©rarchique\n\nDonn√©es organis√©es comme un arbre\nRelations de type parent-enfant\nAnnuaires LDAP, syst√®mes de fichiers\n\n\n\n\n\n\n\n\n\n\nENSAI\n\nENSAI\n\n\n\nPermanent\n\nPermanent\n\n\n\nENSAI-&gt;Permanent\n\n\n\n\n\nEleve\n\nEleve\n\n\n\nENSAI-&gt;Eleve\n\n\n\n\n\nEnseignant\n\nEnseignant\n\n\n\nPermanent-&gt;Enseignant\n\n\n\n\n\nAdministratif\n\nAdministratif\n\n\n\nPermanent-&gt;Administratif\n\n\n\n\n\n1A\n\n1A\n\n\n\nEleve-&gt;1A\n\n\n\n\n\n2A\n\n2A\n\n\n\nEleve-&gt;2A\n\n\n\n\n\n3A\n\n3A\n\n\n\nEleve-&gt;3A\n\n\n\n\n\n\n\n\n\n\n\n\n5.2 R√©seau\n\nOrganis√©e en graphe\nLes enregistrements peuvent avoir plusieurs parents et enfants\nR√©seaux de transports ¬†\n\n\n\n5.3 Relationnelle\n\nOrganis√©e en tables\nLien entre les tables\n\n\nQuelques tables sont g√©rables avec Excel ou Calc.\nMais √ßa devient vite trop compliqu√©.\nSi √ßa vous amuse, vous pouvez essayer de refaire les TP avec Excel.\n\n\n\n5.4 NoSQL\nNombreux sous-types :\n\n\n\n\n\n\n\n\n\nType\nDescription\nExemple\n\n\n\n\nCl√©-valeur\nDonn√©es sous forme de paires cl√©-valeur. Id√©ale pour des lectures rapides avec peu de structure.\nDynamoDB\n\n\nColonnes\nOrganis√©e en colonnes, adapt√©e aux grandes quantit√©s de donn√©es avec peu de relations entre elles.\nCassandra\n\n\nDocument\nStocke des documents semi-structur√©s, souvent en format JSON ou XML, permettant une grande flexibilit√©.\nMongoDB\n\n\nGraphes\nOrganis√©e sous forme de n≈ìuds et de relations, id√©ale pour des donn√©es tr√®s connect√©es ou inter-rel√©es.\nNeo4j\n\n\n\n\n\nNot Only SQL.\nLes BDR ne permettent pas de r√©pondre √† tous les besoins (trop long, pas adapt√©‚Ä¶)\nTh√©or√®me CAP :\n\nConsistency (Coh√©rence) : Tout le monde voit la m√™me version des donn√©es\nAvailability (Disponibilit√©) : Le syst√®me r√©pond toujours, m√™me sous contrainte\nPartition Tolerance : Le syst√®me supporte les coupures r√©seau\n\n\n\n\n5.5 Autres\n\nGraph Database\nBases NewSQL (relationnelles ¬´ modernes ¬ª distribu√©es)\nBases de donn√©es de s√©ries temporelles"
  },
  {
    "objectID": "doc/cours/bases-de-donnees.html#base-de-donn√©es-relationnelle",
    "href": "doc/cours/bases-de-donnees.html#base-de-donn√©es-relationnelle",
    "title": "Bases de Donn√©es",
    "section": "6 Base de donn√©es relationnelle",
    "text": "6 Base de donn√©es relationnelle\n\n6.1 Table\n\nCompos√©e de lignes et de colonnes\nChaque table repr√©sente une entit√©\nChaque ligne est un enregistrement\nChaque colonne repr√©sente un attribut de l‚Äôentit√©\n\nTypes de donn√©es : texte, num‚Ä¶\n\n\n\nImaginez un classeur Excel avec plusieurs feuilles\n\n\n\n6.2 Relations entre les tables\n\nCl√© primaire (PK) pour identifier chaque enregistrement dans une table\n\nde mani√®re unique\nsans ambigu√Øt√©\n\nCl√© √©trang√®re (FK) pour cr√©er des liens avec d‚Äôautres tables\n\nattribut d‚Äôune table A\ncorrespond √† la cl√© primaire d‚Äôune table B\n\n\n\nBDD relationnelle. Comment relier les tables ?\nIci d√©finition, exemples juste apr√®s\n\n\n\n6.3 Cl√© primaire ?\n\n\njoueuse ‚ôï\n\n\nnom\nprenom\nelo\n\n\n\n\nGuichard\nPauline\n2357\n\n\nDaulyte-Cornette\nDeimante\n2371\n\n\nNavrotescu\nAndreea\n2338\n\n\nSebag\nMarie\n2448\n\n\nMillet\nSophie\n2366\n\n\nSkrichempko\nAlmira\n2361\n\n\n\n\n\n\nQuel champ choisir comme cl√© primaire ? üòê\n\n\n\nNom + prenom -&gt; homonymes\nAjouter la date de naissance\n\n\n\n\n6.4 Cl√© primaire technique\nCr√©ons une s√©quence num√©rique. üòé\n\n\njoueuse\n\n\nid_joueuse\nnom\nprenom\nelo\n\n\n\n\n1\nGuichard\nPauline\n2357\n\n\n2\nDaulyte-Cornette\nDeimante\n2371\n\n\n3\nNavrotescu\nAndreea\n2338\n\n\n4\nSebag\nMarie\n2448\n\n\n5\nMillet\nSophie\n2366\n\n\n6\nSkrichempko\nAlmira\n2361\n\n\n\n\n\nprefixe ou suffixe id + nom table : id_&lt;nom_table&gt;\n\n\n\n6.5 Cl√© primaire\n\nAttribut (ou ensemble d‚Äôattributs)\nUnique\nNon nulle\nImmuable\n\n\n\n\n\n\n\nTip\n\n\n\nSauf mention contraire, nous utiliserons une cl√© primaire ‚Äútechnique‚Äù : s√©quence.\n\n\n\nImmuable :\n\nid√©alement stable, elle ne change pas au cours du temps\nPour maintenir l‚Äôint√©grit√© des liens avec d‚Äôautres tables\n\nRemarque : pas obligatoire d‚Äôavoir une cl√© primaire\nQuestion : nous voulons ajouter le club de chaque joueuse, comment faire ?\n\n\n\n6.6 Cl√© √©trang√®re ?\nComment relier ces 2 tables ?\n\nUne joueuse joue pour un seul club\nUn club peut avoir plusieurs joueuses\n\n\n\n\n\n\nclassDiagram\n    class joueuse {\n        id_joueuse PK\n        nom\n        prenom\n        elo\n    }\n    \n    class club {\n        id_club PK\n        nom\n        ville\n    }\n\n\n\n\n\n\n\nSi on faisait une seule table :\n\nRedondance des noms de clubs\nRisque d‚Äôerreur de saisie\nDifficile si on veut ajouter des infos sur le club\nSi le nom d‚Äôun club change\n\n\n\n\nclubjoueuse\n\n\n\n\nclub\n\n\n\n\n\n\n\nid_club\nnom\nville\n\n\n\n\n1\nC‚ÄôChartres Echecs\nChartres\n\n\n2\nBischwiller\nBischwiller\n\n\n3\nAsnieres - le Grand Echiquier\nAsnieres\n\n\n4\nTours des Hauts-De-France\nSaint-Quentin\n\n\n\n\n\n\n\n\njoueuse\n\n\nid_joueuse\nnom\nprenom\nelo\n\n\n\n\n1\nGuichard\nPauline\n2357\n\n\n2\nDaulyte-Cornette\nDeimante\n2371\n\n\n3\nNavrotescu\nAndreea\n2338\n\n\n4\nSebag\nMarie\n2448\n\n\n5\nMillet\nSophie\n2366\n\n\n6\nSkrichempko\nAlmira\n2361\n\n\n\n\n\n\n\n\nSpoil : en ajoutant une FK\nDans quelle table ?\n\n\n\n6.7 Cl√© √©trang√®re\nEn ajoutant une cl√© √©trang√®re.\n\n\n\n\n\nclassDiagram\n    class joueuse {\n        id_joueuse PK\n        nom\n        prenom\n        elo\n        id_club FK\n    }\n    \n    class club {\n        id_club PK\n        nom\n        ville\n    }\n\n\n\n\n\n\n\n\n\njoueuse\n\n\n\n\n\n\n\n\n\nid_joueuse\nnom\nprenom\nelo\nid_club\n\n\n\n\n1\nGuichard\nPauline\n2357\n3\n\n\n2\nDaulyte\nDeimante\n2371\n1\n\n\n3\nNavrotescu\nAndreea\n2338\n2\n\n\n4\nSebag\nMarie\n2448\n2\n\n\n5\nMillet\nSophie\n2366\n3\n\n\n6\nSkrichempko\nAlmira\n2361\n\n\n\n\n\n\n\n\n\n\n\n\nCautionRemarques\n\n\n\nUne cl√© √©trang√®re peut √™tre nulle.\nUne cl√© √©trang√®re r√©f√©rence une valeur existante de cl√© primaire.\n\n\n\n\n\n6.8 Question\nEt si vous supprimez, le club de C‚ÄôChartres Echecs ? üòá\n\n\n\n\n\n\n\n\nWarning\n\n\n\nSQL Error [23503]: ERROR: UPDATE or DELETE on table \"club\" violates the foreign key constraint \"fk_id_club\" on table \"joueuse\". Detail: Key (id_club)=(1) is still referenced from table \"joueuse\".\n\n\n\n\nid_club = 1\nErreur aussi si vous essayer d‚Äôinsert une joueuse avec id_club=9\n\n\n\n6.9 Int√©grit√© r√©f√©rentielle\n\nGarantit que les relations entre tables restent coh√©rentes\nEmp√™che les r√©f√©rences invalides\nEmp√™che la suppression d‚Äôune r√©f√©rence utilis√©e\n\n√âvite les ‚Äúvaleurs orphelines‚Äù\n\n\n\nPermet des actions en cascade g√©r√©es directement par le SGBD.\n\n\n\n6.10 Autre question\nSi une joueuse peut adh√©rer √† plusieurs clubs ? üòï\n\n\nid_club devient une liste de clubs ?\n\n\n\n\n\n\n\n\nChangement des r√®gles.\nPar exemple si notre bdd contient aussi les clubs belges, allemands, espagnols‚Ä¶\nC‚Äôest possible techniquement mais pas adapt√© (perte coh√©rence, flexibilit√©, perf)\n\n\n\n6.11 Table d‚Äôassociation\nCr√©ation d‚Äôune table d‚Äôassociation : adhesion üòÖ\n\n\n\n\n\nclassDiagram\n    class Adhesion {\n        id_joueuse FK\n        id_club FK\n    }\n\n\n\n\n\n\n\n\n\nadhesion\n\n\nid_club\nid_joueuse\n\n\n\n\n1\n2\n\n\n2\n3\n\n\n2\n4\n\n\n2\n6\n\n\n3\n1\n\n\n3\n5\n\n\n4\n1\n\n\n4\n2\n\n\n\n\n\nImaginons que la Picardie devienne Belge.\nCl√© primaire ?\n\nid_adhesion\n(id_club, id_joueuse)\n\nSi PK = (id_club, id_joueuse), est-ce qu‚Äôune joueuse peut adh√©rer plusieurs fois au m√™me club ?\nSi une joueuse est dans un club, change puis revient ?\n\nQuestion de l‚Äôusage des donn√©es (instant t ou historique)"
  },
  {
    "objectID": "doc/cours/bases-de-donnees.html#associations",
    "href": "doc/cours/bases-de-donnees.html#associations",
    "title": "Bases de Donn√©es",
    "section": "7 Associations",
    "text": "7 Associations\nIl existe plusieurs types d‚Äôassociations entre tables.\n\n7.1 Association 1:1\nUne entit√© dans la table A est associ√©e √† une seule entit√© dans la table B.\nExemple :\n\nUne personne a une seule carte vitale\nUne carte vitale appartient √† une seule personne\n\n\non aurait pu tout mettre dans la m√™me table.\nMais ici on consid√®re que cela correspond √† deux besoins m√©tier diff√©rents\nQuestion : O√π met-on la cl√© √©trang√®re ?\n\n\n\n7.2 Association 1:n\nUne entit√© dans la table A peut-√™tre associ√©e √† plusieurs entit√©s dans la table B.\nExemple :\n\nUn club est compos√© de plusieurs joueuses\nUne joueuse adh√®re √† un seul club\n\n\nSupposons de nouveau qu‚Äôune joueuse ne joue que pour 1 seul club.\nQuestion : O√π met-on la cl√© √©trang√®re ?\n\n\n\n7.3 Association n:n\nUne entit√© dans la table A peut-√™tre associ√©e √† plusieurs entit√©s dans la table B.\nEt inversement, une entit√© dans la table B peut-√™tre associ√©e √† plusieurs entit√©s dans la table A.\nExemple :\n\nune joueuse participe √† plusieurs tournois\nUn tournoi regroupe plusieurs joueuses\n\n\nQuestion : Comment fait-t-on ?\n\nTable d‚Äôassociation\n\n\n\n\n7.4 Association r√©cursive\nUne table peut avoir des relations avec elle-m√™me.\nDans ce cas, la table contient une cl√© √©trang√®re qui r√©f√©rence sa propre cl√© primaire.\nExemple :\n\nemploye (id_employe, nom, prenom, #id_chef)\nid_chef cl√© √©trang√®re qui r√©f√©rence id_employe\n\n\nConventions\n\nPK soulign√©e\nFK avec #\n\n\n\n\n7.5 Association multiples\nUne table A peut avoir plusieurs relations avec une table B.\nExemple :\n\nequipe (id_equipe, nom)\nmatch (id_match, #id_equipe1, #id_equipe2, score)\n\n\nNous reviendrons sur les associations quand nous parlerons des jointures."
  },
  {
    "objectID": "doc/cours/bases-de-donnees.html#sgbd",
    "href": "doc/cours/bases-de-donnees.html#sgbd",
    "title": "Bases de Donn√©es",
    "section": "8 SGBD",
    "text": "8 SGBD\n\n\n\n\n\n\nImportantD√©finition\n\n\n\nUn Syst√®me de Gestion de Bases de Donn√©es est un logiciel qui permet de cr√©er, g√©rer et manipuler des bases de donn√©es.\nIl fournit des outils pour stocker, r√©cup√©rer, modifier et s√©curiser les donn√©es.\n\n\n\nPostgreSQL\nMySQL, MariaDB\nOracle Database\nSQLite\n\n\nenvirons √©gal √† Base de donn√©es Boite noire\n\n\n8.1 PostgreSQL\n\nOpen Source, Libre\nCommunaut√© active\nStable et performant\nBas√© sur le mod√®le client-serveur\nExtension PostGIS (Donn√©es g√©ographiques)\n\n\nutilis√© √† l‚ÄôINSEE\nclient-serveur classique :\n\nle composant serveur central ¬´ postmaster ¬ª g√®re tous les fichiers de bdd\nainsi que toutes les connexions √©tablies pour la communication avec le serveur de bdd.\n\nLes utilisateurs n‚Äôont besoin que d‚Äôun programme client appropri√© pour √©tablir la connexion\n\n\n\n8.2 Outil de Gestion et Administration\nIl est n√©cessaire d‚Äôavoir un outil pour g√©rer et administrer une base de donn√©es.\n\n\n\n\n\n\nTip\n\n\n\n\nPostgreSQL : Install√© sur un serveur, sert de moteur de base de donn√©es\npgAdmin : Interface graphique pour interagir avec PostgreSQL\n\n\n\n\npgAdmin\nDBeaver ou cloudBeaver\n\n\nSans cette interface, il faudrait via un terminal :\n\nse connecter au serveur PostgreSQL\nouvrir la connexion √† la bdd\nrentrer les requ√™tes\n\n\n\n\n8.3 Kesako\n\nBase de donn√©es : endroit o√π sont stock√©es les informations\nSGBD : logiciel qui permet de cr√©er, g√©rer et manipuler les bases de donn√©es\nOutil de gestion du SGBD : application graphique qui facilite l‚Äôinteraction avec un SGBD\nSQL : Langage pour donner les instructions √† la base de donn√©es\n\n\n\nBDD : biblioth√®que\nSGBD : biblioth√©caire\nOutil : tableau de bord interactif pour les biblioth√©caires\n\nA l‚ÄôENSAI :\n\nvous avez chacun une bdd (nom=id)\nutilisez DBeaver pour vous y connecter\n\n\n\nNext step : SQL"
  },
  {
    "objectID": "doc/cours/bases-de-donnees-slides.html#une-donn√©e",
    "href": "doc/cours/bases-de-donnees-slides.html#une-donn√©e",
    "title": "Bases de Donn√©es",
    "section": "Une donn√©e ?",
    "text": "Une donn√©e ?\n\n\ntexte (nom, pr√©nom, ville‚Ä¶)\nnum√©rique (age, prix‚Ä¶)\ndate\nliste (comp√©tences, loisirs)\nimage\nfichier\n\n\n\nC‚Äôest quoi une donn√©e ?\n\ntypes ?\nvaleurs ?\nrepr√©sente quelque chose"
  },
  {
    "objectID": "doc/cours/bases-de-donnees-slides.html#une-base-de-donn√©es",
    "href": "doc/cours/bases-de-donnees-slides.html#une-base-de-donn√©es",
    "title": "Bases de Donn√©es",
    "section": "Une base de donn√©es ?",
    "text": "Une base de donn√©es ?\n\n\n\n\n\n\n\nD√©finition\n\n\nUne base de donn√©es est un ensemble de donn√©es rassembl√©es et stock√©es de mani√®re organis√©e dans un but sp√©cifique.\n\n\n\n\n\nTypes ?\nOn n‚Äôutilise pas la m√™me structure pour du texte, des fichiers, des images."
  },
  {
    "objectID": "doc/cours/bases-de-donnees-slides.html#usages",
    "href": "doc/cours/bases-de-donnees-slides.html#usages",
    "title": "Bases de Donn√©es",
    "section": "Usages",
    "text": "Usages"
  },
  {
    "objectID": "doc/cours/bases-de-donnees-slides.html#enjeux",
    "href": "doc/cours/bases-de-donnees-slides.html#enjeux",
    "title": "Bases de Donn√©es",
    "section": "Enjeux",
    "text": "Enjeux\n\nAcc√®s aux donn√©es : langage SQL\nS√©curit√© des donn√©es : seuls les utilisateurs autoris√©s (droits)\nPartage des donn√©es : facile en lecture, mais en √©criture ?\nNon-redondance des donn√©es\nCoh√©rence des donn√©es : respect des contraintes d‚Äôint√©grit√©\n\n\nLe r√¥le du SGBD est de r√©pondre √† ces enjeux.\n\nSe brancher √† la BDD qui est sur un serveur\nR√®gles pour la coh√©rence. ‚ö†Ô∏è trop de r√®gles -&gt; bon dosage"
  },
  {
    "objectID": "doc/cours/bases-de-donnees-slides.html#types-de-bases-de-donn√©es",
    "href": "doc/cours/bases-de-donnees-slides.html#types-de-bases-de-donn√©es",
    "title": "Bases de Donn√©es",
    "section": "Types de bases de donn√©es",
    "text": "Types de bases de donn√©es"
  },
  {
    "objectID": "doc/cours/bases-de-donnees-slides.html#base-de-donn√©es-relationnelle",
    "href": "doc/cours/bases-de-donnees-slides.html#base-de-donn√©es-relationnelle",
    "title": "Bases de Donn√©es",
    "section": "Base de donn√©es relationnelle",
    "text": "Base de donn√©es relationnelle"
  },
  {
    "objectID": "doc/cours/bases-de-donnees-slides.html#associations",
    "href": "doc/cours/bases-de-donnees-slides.html#associations",
    "title": "Bases de Donn√©es",
    "section": "Associations",
    "text": "Associations\nIl existe plusieurs types d‚Äôassociations entre tables."
  },
  {
    "objectID": "doc/cours/bases-de-donnees-slides.html#sgbd",
    "href": "doc/cours/bases-de-donnees-slides.html#sgbd",
    "title": "Bases de Donn√©es",
    "section": "SGBD",
    "text": "SGBD\n\n\n\n\n\n\n\nD√©finition\n\n\nUn Syst√®me de Gestion de Bases de Donn√©es est un logiciel qui permet de cr√©er, g√©rer et manipuler des bases de donn√©es.\nIl fournit des outils pour stocker, r√©cup√©rer, modifier et s√©curiser les donn√©es.\n\n\n\n\n\nPostgreSQL\nMySQL, MariaDB\nOracle Database\nSQLite\n\n\nenvirons √©gal √† Base de donn√©es Boite noire"
  },
  {
    "objectID": "doc/cours/jointures-slides.html#jointures",
    "href": "doc/cours/jointures-slides.html#jointures",
    "title": "Jointures entre Tables",
    "section": "Jointures",
    "text": "Jointures\n\n\n\n\n\n\n\nObjectifs\n\n\n\nRegrouper les donn√©es de plusieurs tables\nEn utilisant les liens entre ces tables\n\n\n\n\n\n\n\nJusqu‚Äô√† maintenant, on aurait pu tout faire sous excel‚Ä¶\nFaire une jointure est comme cr√©er un gros tableau"
  },
  {
    "objectID": "doc/cours/jointures-slides.html#jointure-interne",
    "href": "doc/cours/jointures-slides.html#jointure-interne",
    "title": "Jointures entre Tables",
    "section": "Jointure interne",
    "text": "Jointure interne\nL‚ÄôINNER JOIN renvoie uniquement les lignes qui ont des correspondances dans les deux tables.\n\nAu max, vous avez le nombre de lignes de la table la plus grande"
  },
  {
    "objectID": "doc/cours/jointures-slides.html#jointure-externe",
    "href": "doc/cours/jointures-slides.html#jointure-externe",
    "title": "Jointures entre Tables",
    "section": "Jointure externe",
    "text": "Jointure externe\nCe serait pas mal d‚Äôafficher toutes les joueuses, m√™me celles qui n‚Äôont pas de club.\nComment faire ? üòê"
  },
  {
    "objectID": "doc/cours/jointures-slides.html#jointure-compl√®te",
    "href": "doc/cours/jointures-slides.html#jointure-compl√®te",
    "title": "Jointures entre Tables",
    "section": "Jointure compl√®te",
    "text": "Jointure compl√®te\nLe FULL JOIN permet de faire une jointure bilat√©rale (i.e.¬†un UNION entre les √©l√©ments de la LEFT JOIN et de la RIGHT JOIN)\nSELECT j.nom,\n       j.prenom,\n       c.nom AS club\n  FROM echecs.joueuse j\n  FULL JOIN echecs.club c USING (id_club);"
  },
  {
    "objectID": "doc/cours/jointures-slides.html#jointure-crois√©e",
    "href": "doc/cours/jointures-slides.html#jointure-crois√©e",
    "title": "Jointures entre Tables",
    "section": "Jointure crois√©e",
    "text": "Jointure crois√©e\nCROSS JOIN renvoie le produit cart√©sien des deux tables.\n\n\n\n\nnom\nprenom\nclub\n\n\n\n\nDaulyte\nDeimante\nC‚ÄôChartres Echecs\n\n\nDaulyte\nDeimante\nBischwiller\n\n\nDaulyte\nDeimante\nAsnieres - le Grand Echiquier\n\n\nDaulyte\nDeimante\nTours des Hauts-De-France\n\n\nNavrotescu\nAndreea\nC‚ÄôChartres Echecs\n\n\nNavrotescu\nAndreea\nBischwiller\n\n\nNavrotescu\nAndreea\nAsnieres - le Grand Echiquier\n\n\n‚Ä¶\n‚Ä¶\n‚Ä¶"
  },
  {
    "objectID": "doc/cours/jointures.html",
    "href": "doc/cours/jointures.html",
    "title": "Jointures entre Tables",
    "section": "",
    "text": "ImportantObjectifs\n\n\n\n\nRegrouper les donn√©es de plusieurs tables\nEn utilisant les liens entre ces tables\n\n\n\n\n\nJusqu‚Äô√† maintenant, on aurait pu tout faire sous excel‚Ä¶\nFaire une jointure est comme cr√©er un gros tableau\n\n\n\n\nDans les exemples ci-dessous, nous allons utiliser ces 2 tables.\nVous pouvez tout √† fait faire des jointures avec 3 tables, 4 tables‚Ä¶\n\n\n\n\n\nclassDiagram\n    class Joueuse {\n        id_joueuse PK\n        nom\n        prenom\n        elo\n        id_club\n    }\n    \n    class Club {\n        id_club PK\n        nom\n        ville\n    }\n\n\n\n\n\n\n\n\n\n\nJoueuseClub\n\n\n\n\n\n\n\n\n\n\n\n\n\nid_joueuse\nnom\nprenom\nelo\nid_club\n\n\n\n\n1\nGuichard\nPauline\n2357\n3\n\n\n2\nDaulyte\nDeimante\n2371\n1\n\n\n3\nNavrotescu\nAndreea\n2338\n2\n\n\n4\nSebag\nMarie\n2448\n2\n\n\n5\nMillet\nSophie\n2366\n3\n\n\n6\nSkrichempko\nAlmira\n2361\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nid_club\nnom\nville\n\n\n\n\n1\nC‚ÄôChartres Echecs\nChartres\n\n\n2\nBischwiller\nBischwiller\n\n\n3\nAsnieres - le Grand Echiquier\nAsnieres\n\n\n4\nTours des Hauts-De-France\nSaint-Quentin\n\n\n\n\n\n\n\n\n\nDes remarques sur ces donn√©es ?\nComment-vous pensez que l‚Äôon va faire la jointure ?"
  },
  {
    "objectID": "doc/cours/jointures.html#jointures",
    "href": "doc/cours/jointures.html#jointures",
    "title": "Jointures entre Tables",
    "section": "",
    "text": "ImportantObjectifs\n\n\n\n\nRegrouper les donn√©es de plusieurs tables\nEn utilisant les liens entre ces tables\n\n\n\n\n\nJusqu‚Äô√† maintenant, on aurait pu tout faire sous excel‚Ä¶\nFaire une jointure est comme cr√©er un gros tableau\n\n\n\n\nDans les exemples ci-dessous, nous allons utiliser ces 2 tables.\nVous pouvez tout √† fait faire des jointures avec 3 tables, 4 tables‚Ä¶\n\n\n\n\n\nclassDiagram\n    class Joueuse {\n        id_joueuse PK\n        nom\n        prenom\n        elo\n        id_club\n    }\n    \n    class Club {\n        id_club PK\n        nom\n        ville\n    }\n\n\n\n\n\n\n\n\n\n\nJoueuseClub\n\n\n\n\n\n\n\n\n\n\n\n\n\nid_joueuse\nnom\nprenom\nelo\nid_club\n\n\n\n\n1\nGuichard\nPauline\n2357\n3\n\n\n2\nDaulyte\nDeimante\n2371\n1\n\n\n3\nNavrotescu\nAndreea\n2338\n2\n\n\n4\nSebag\nMarie\n2448\n2\n\n\n5\nMillet\nSophie\n2366\n3\n\n\n6\nSkrichempko\nAlmira\n2361\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nid_club\nnom\nville\n\n\n\n\n1\nC‚ÄôChartres Echecs\nChartres\n\n\n2\nBischwiller\nBischwiller\n\n\n3\nAsnieres - le Grand Echiquier\nAsnieres\n\n\n4\nTours des Hauts-De-France\nSaint-Quentin\n\n\n\n\n\n\n\n\n\nDes remarques sur ces donn√©es ?\nComment-vous pensez que l‚Äôon va faire la jointure ?"
  },
  {
    "objectID": "doc/cours/jointures.html#jointure-interne",
    "href": "doc/cours/jointures.html#jointure-interne",
    "title": "Jointures entre Tables",
    "section": "2 Jointure interne",
    "text": "2 Jointure interne\nL‚ÄôINNER JOIN renvoie uniquement les lignes qui ont des correspondances dans les deux tables.\n\nAu max, vous avez le nombre de lignes de la table la plus grande\n\n\n1ere tentative\nSELECT nom,\n       prenom,\n       nom AS club\n  FROM echecs.joueuse\n INNER JOIN echecs.club ON id_club = id_club;\n\nNous affichons nom et prenom de la table joueuse\nNous ajoutons le nom du club\nNous faisons la jointure entre joueuse et club via la colonne id_club\n\n\nDes soucis dans cette requ√™te ? üòï\n\n\n\n2e tentative\nSELECT joueuse.nom,\n       joueuse.prenom,\n       club.nom AS club\n  FROM echecs.joueuse\n INNER JOIN echecs.club ON club.id_club = joueuse.id_club;\n\n√áa fonctionne !\nMais c‚Äôest un peu long d‚Äô√©crire avant chaque colonne le nom de la table.\n\n\n\nAlias\nSELECT j.nom,            -- signifie colonne nom de la table d'alias j\n       j.prenom,\n       c.nom AS club\n  FROM echecs.joueuse j  -- d√©clare j comme alias de la table joueuse\n INNER JOIN echecs.club c ON c.id_club = j.id_club;\n\n\n\n\n\n\nNoteAlias\n\n\n\n\nL‚ÄôAlias est comme un surnom pour la table\nPar d√©faut l‚Äôalias de la table est son propre nom (i.e.¬†si vous ne d√©clarez pas d‚Äôalias)\nG√©n√©ralement on utilise comme alias la 1ere lettre ou les 2 premi√®res lettres\n\n\n\n\n\nUSING\n\n\n\n\n\n\nTip\n\n\n\nSi votre base de donn√©es est bien con√ßue, les colonnes utilis√©es pour les jointures portent le m√™me nom dans les deux tables.\nDans ce cas, et uniquement dans ce cas, vous pouvez utiliser le mot cl√© USING √† la place de ON.\n\n\nSELECT j.nom,\n       j.prenom,\n       c.nom AS club\n  FROM echecs.joueuse j\n INNER JOIN echecs.club c USING (id_club);\n\nSi vos colonnes n‚Äôont pas le m√™me nom, pas possible de faire USING\n\n\n\nAu final\nSELECT j.nom,\n       j.prenom,\n       c.nom AS club\n  FROM echecs.joueuse j\n  JOIN echecs.club c USING (id_club);\nVous pouvez m√™me enlever le INNER qui est optionnel.\n\n\n√Ä ne pas faire\n\n\n\n\n\n\nCaution\n\n\n\nIl est aussi possible de faire une jointure avec NATURAL JOIN sans pr√©ciser aucun nom de colonnes. Cela va joindre les tables via les colonnes ayant le m√™me nom dans les 2 tables.\nCette pratique est d√©conseill√©e, car vous ne maitrisez pas les colonnes servant √† la jointure et c‚Äôest visuellement moins parlant.\n\n\n\n\n\n\n\n\nWarningAncienne √©criture\n\n\n\nSELECT j.nom,\n       j.prenom,\n       c.nom AS club\n  FROM echecs.joueuse j,\n       echecs.club c \n WHERE j.id_club = c.id_club;\n\n\n\nAncienne √©criture encore utilis√©e par un certain nombre.\n\n\n\nR√©sultat\n\n\n\n\nnom\nprenom\nclub\n\n\n\n\nDaulyte\nDeimante\nC‚ÄôChartres Echecs\n\n\nNavrotescu\nAndreea\nBischwiller\n\n\nSebag\nMarie\nBischwiller\n\n\nGuichard\nPauline\nAsnieres - le Grand Echiquier\n\n\nMillet\nSophie\nAsnieres - le Grand Echiquier\n\n\n\n\n\nIl n‚Äôy a pas quelque chose qui vous chagrine ? üò¶\n\n\nA votre avis, pourquoi il manque une joueuse ?"
  },
  {
    "objectID": "doc/cours/jointures.html#jointure-externe",
    "href": "doc/cours/jointures.html#jointure-externe",
    "title": "Jointures entre Tables",
    "section": "3 Jointure externe",
    "text": "3 Jointure externe\nCe serait pas mal d‚Äôafficher toutes les joueuses, m√™me celles qui n‚Äôont pas de club.\nComment faire ? üòê\n\n\n\n\n\n\n\nId√©e\n\nLister les noms et pr√©noms des joueuses\n√âventuellement compl√©ter avec le nom du club\n\n\nSELECT j.nom,\n       j.prenom,\n       c.nom AS club\n  FROM echecs.joueuse j\n  LEFT JOIN echecs.club c USING (id_club);\n\n\n\nLEFT JOIN\nUtilisons un LEFT JOIN pour faire une jointure externe :\n\nnous gardons toutes les donn√©es pr√©sentes dans les tables avant le LEFT JOIN\nnous compl√©tons si possible avec les donn√©es des tables apr√®s le LEFT JOIN\n\n\n\n\n\n\n\nTipRIGHT JOIN\n\n\n\n√Ä l‚Äôinverse, le RIGHT JOIN garde tout ce qu‚Äôil y a apr√®s et compl√©te si possible avec ce qu‚Äôil y a avant.\nIl est moins utilis√© car moins intuitif, mais reste parfois indispensable.\n\n\n\nIl y a certains cas particuliers o√π le RIGHT JOIN est indispensable\nVous verrez parfois LEFT OUTER JOIN\n\n\n\nR√©sultat\n\nLEFT JOINRIGHT JOIN\n\n\n\n\n\n\nnom\nprenom\nclub\n\n\n\n\nDaulyte\nDeimante\nC‚ÄôChartres Echecs\n\n\nNavrotescu\nAndreea\nBischwiller\n\n\nSebag\nMarie\nBischwiller\n\n\nGuichard\nPauline\nAsnieres - le Grand Echiquier\n\n\nMillet\nSophie\nAsnieres - le Grand Echiquier\n\n\nSkrichempko\nAlmira\n\n\n\n\n\n\n\n\n\n\n\nnom\nprenom\nclub\n\n\n\n\nDaulyte\nDeimante\nC‚ÄôChartres Echecs\n\n\nNavrotescu\nAndreea\nBischwiller\n\n\nSebag\nMarie\nBischwiller\n\n\nGuichard\nPauline\nAsnieres - le Grand Echiquier\n\n\nMillet\nSophie\nAsnieres - le Grand Echiquier\n\n\n\n\nTours des Hauts-De-France"
  },
  {
    "objectID": "doc/cours/jointures.html#jointure-compl√®te",
    "href": "doc/cours/jointures.html#jointure-compl√®te",
    "title": "Jointures entre Tables",
    "section": "4 Jointure compl√®te",
    "text": "4 Jointure compl√®te\nLe FULL JOIN permet de faire une jointure bilat√©rale (i.e.¬†un UNION entre les √©l√©ments de la LEFT JOIN et de la RIGHT JOIN)\nSELECT j.nom,\n       j.prenom,\n       c.nom AS club\n  FROM echecs.joueuse j\n  FULL JOIN echecs.club c USING (id_club);\n\nR√©sultat\n\n\n\n\nnom\nprenom\nclub\n\n\n\n\nDaulyte\nDeimante\nC‚ÄôChartres Echecs\n\n\nNavrotescu\nAndreea\nBischwiller\n\n\nSebag\nMarie\nBischwiller\n\n\nGuichard\nPauline\nAsnieres - le Grand Echiquier\n\n\nMillet\nSophie\nAsnieres - le Grand Echiquier\n\n\nSkrichempko\nAlmira\n\n\n\n\n\nTours des Hauts-De-France"
  },
  {
    "objectID": "doc/cours/jointures.html#jointure-crois√©e",
    "href": "doc/cours/jointures.html#jointure-crois√©e",
    "title": "Jointures entre Tables",
    "section": "5 Jointure crois√©e",
    "text": "5 Jointure crois√©e\nCROSS JOIN renvoie le produit cart√©sien des deux tables.\n\n\n\n\nnom\nprenom\nclub\n\n\n\n\nDaulyte\nDeimante\nC‚ÄôChartres Echecs\n\n\nDaulyte\nDeimante\nBischwiller\n\n\nDaulyte\nDeimante\nAsnieres - le Grand Echiquier\n\n\nDaulyte\nDeimante\nTours des Hauts-De-France\n\n\nNavrotescu\nAndreea\nC‚ÄôChartres Echecs\n\n\nNavrotescu\nAndreea\nBischwiller\n\n\nNavrotescu\nAndreea\nAsnieres - le Grand Echiquier\n\n\n‚Ä¶\n‚Ä¶\n‚Ä¶"
  },
  {
    "objectID": "doc/cours/agregations-slides.html#donn√©es-utilis√©es",
    "href": "doc/cours/agregations-slides.html#donn√©es-utilis√©es",
    "title": "Agr√©gations",
    "section": "Donn√©es utilis√©es",
    "text": "Donn√©es utilis√©es\n\n\n\n\n\n\n\n\n\n\n\nid_joueuse\nnom\nprenom\nelo\nville_club\n\n\n\n\n1\nGuichard\nPauline\n2357\nAsnieres\n\n\n2\nDaulyte\nDeimante\n2371\nChartres\n\n\n3\nNavrotescu\nAndreea\n2338\nAsnieres\n\n\n4\nSebag\nMarie\n2448\nBischwiller\n\n\n5\nMillet\nSophie\n2366\nAsnieres\n\n\n6\nSkrichempko\nAlmira\n2361\nBischwiller\n\n\n\n\n\nj‚Äôai int√©gr√© ici le club pour faciliter les choses"
  },
  {
    "objectID": "doc/cours/agregations-slides.html#questions",
    "href": "doc/cours/agregations-slides.html#questions",
    "title": "Agr√©gations",
    "section": "Questions",
    "text": "Questions\nQuelques questions que l‚Äôon peut se poser :\n\nQuel est le id_joueuse maximum ?\nQuel est le nombre de joueuses ?\nQuelle est la moyenne elo par club ?"
  },
  {
    "objectID": "doc/cours/agregations-slides.html#compter-les-lignes",
    "href": "doc/cours/agregations-slides.html#compter-les-lignes",
    "title": "Agr√©gations",
    "section": "Compter les lignes",
    "text": "Compter les lignes\nSELECT COUNT(*)\n  FROM echecs.joueuse\n WHERE elo &lt; 2400;\n\n\n\n\ncount\n\n\n\n\n5\n\n\n\n\n\nSELECT COUNT(DISTINCT prenom)\n  FROM echecs.joueuse;\n\n\n\n\ncount\n\n\n\n\n6\n\n\n\n\n\nJ‚Äôutilise souvent COUNT(1) -&gt; c‚Äôest pareil"
  },
  {
    "objectID": "doc/cours/agregations-slides.html#somme",
    "href": "doc/cours/agregations-slides.html#somme",
    "title": "Agr√©gations",
    "section": "Somme",
    "text": "Somme\nSELECT SUM(elo)\n  FROM echecs.joueuse;\n\n\n\n\nsum\n\n\n\n\n14223\n\n\n\n\n\nSELECT SUM(elo) / COUNT(elo)\n  FROM echecs.joueuse;"
  },
  {
    "objectID": "doc/cours/agregations-slides.html#stats-descriptives",
    "href": "doc/cours/agregations-slides.html#stats-descriptives",
    "title": "Agr√©gations",
    "section": "Stats descriptives",
    "text": "Stats descriptives\nSELECT MAX(elo),\n       MIN(elo),\n       AVG(elo)\n  FROM echecs.joueuse;\n\n\n\n\nmax\nmin\navg\n\n\n\n\n2448\n2338\n2373.5\n\n\n\n\n\n\n\n\n\n\nTip\n\n\nVous pouvez √©galement calculer : VARIANCE, STDDEV.\n\n\n\n\nComment afficher la joueuse avec le plus grand elo ? üòµ"
  },
  {
    "objectID": "doc/cours/agregations-slides.html#regroupement",
    "href": "doc/cours/agregations-slides.html#regroupement",
    "title": "Agr√©gations",
    "section": "Regroupement",
    "text": "Regroupement\nComment obtenir la moyenne elo par club ?\n\nSELECT ville_club,    -- Supposons que la table joueuse a un attribut ville_club\n       AVG(elo)\n  FROM echecs.joueuse\n GROUP BY ville_club;\n\n\n\n\nville_club\navg_elo\n\n\n\n\nAsnieres\n2372.4\n\n\nChartres\n2371.0\n\n\nBischwiller\n2404.5\n\n\n\n\n\n\nJ‚Äôai mis ville_club car id_club c‚Äôest moins joli et on verra les jointures ensuite.\nVous pouvez utiliser ROUND() pour arrondir."
  },
  {
    "objectID": "doc/cours/agregations.html",
    "href": "doc/cours/agregations.html",
    "title": "Agr√©gations",
    "section": "",
    "text": "id_joueuse\nnom\nprenom\nelo\nville_club\n\n\n\n\n1\nGuichard\nPauline\n2357\nAsnieres\n\n\n2\nDaulyte\nDeimante\n2371\nChartres\n\n\n3\nNavrotescu\nAndreea\n2338\nAsnieres\n\n\n4\nSebag\nMarie\n2448\nBischwiller\n\n\n5\nMillet\nSophie\n2366\nAsnieres\n\n\n6\nSkrichempko\nAlmira\n2361\nBischwiller\n\n\n\n\n\nj‚Äôai int√©gr√© ici le club pour faciliter les choses"
  },
  {
    "objectID": "doc/cours/agregations.html#donn√©es-utilis√©es",
    "href": "doc/cours/agregations.html#donn√©es-utilis√©es",
    "title": "Agr√©gations",
    "section": "",
    "text": "id_joueuse\nnom\nprenom\nelo\nville_club\n\n\n\n\n1\nGuichard\nPauline\n2357\nAsnieres\n\n\n2\nDaulyte\nDeimante\n2371\nChartres\n\n\n3\nNavrotescu\nAndreea\n2338\nAsnieres\n\n\n4\nSebag\nMarie\n2448\nBischwiller\n\n\n5\nMillet\nSophie\n2366\nAsnieres\n\n\n6\nSkrichempko\nAlmira\n2361\nBischwiller\n\n\n\n\n\nj‚Äôai int√©gr√© ici le club pour faciliter les choses"
  },
  {
    "objectID": "doc/cours/agregations.html#questions",
    "href": "doc/cours/agregations.html#questions",
    "title": "Agr√©gations",
    "section": "2 Questions",
    "text": "2 Questions\nQuelques questions que l‚Äôon peut se poser :\n\n\nQuel est le id_joueuse maximum ?\nQuel est le nombre de joueuses ?\nQuelle est la moyenne elo par club ?"
  },
  {
    "objectID": "doc/cours/agregations.html#compter-les-lignes",
    "href": "doc/cours/agregations.html#compter-les-lignes",
    "title": "Agr√©gations",
    "section": "3 Compter les lignes",
    "text": "3 Compter les lignes\nSELECT COUNT(*)\n  FROM echecs.joueuse\n WHERE elo &lt; 2400;\n\n\n\n\ncount\n\n\n\n\n5\n\n\n\n\n\nSELECT COUNT(DISTINCT prenom)\n  FROM echecs.joueuse;\n\n\n\n\ncount\n\n\n\n\n6\n\n\n\n\n\nJ‚Äôutilise souvent COUNT(1) -&gt; c‚Äôest pareil\n\n\nCompter avec un filtre\nL‚Äôop√©rateur FILTER permet de calculer une agr√©gation conditionnelle.\nSELECT COUNT(*) FILTER (WHERE elo BETWEEN 2300 AND 2399) AS niv_fm,\n       COUNT(*) FILTER (WHERE elo BETWEEN 2400 AND 2499) AS niv_im\n  FROM echecs.joueuse;\n\n\n\n\nniv_fm\nniv_im\n\n\n\n\n5\n1"
  },
  {
    "objectID": "doc/cours/agregations.html#somme",
    "href": "doc/cours/agregations.html#somme",
    "title": "Agr√©gations",
    "section": "4 Somme",
    "text": "4 Somme\nSELECT SUM(elo)\n  FROM echecs.joueuse;\n\n\n\n\nsum\n\n\n\n\n14223\n\n\n\n\n\nSELECT SUM(elo) / COUNT(elo)\n  FROM echecs.joueuse;"
  },
  {
    "objectID": "doc/cours/agregations.html#stats-descriptives",
    "href": "doc/cours/agregations.html#stats-descriptives",
    "title": "Agr√©gations",
    "section": "5 Stats descriptives",
    "text": "5 Stats descriptives\nSELECT MAX(elo),\n       MIN(elo),\n       AVG(elo)\n  FROM echecs.joueuse;\n\n\n\n\nmax\nmin\navg\n\n\n\n\n2448\n2338\n2373.5\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nVous pouvez √©galement calculer : VARIANCE, STDDEV.\n\n\n\nComment afficher la joueuse avec le plus grand elo ? üòµ\n\n\nSous-requ√™te\nEn utilisant une sous-requ√™te :\n\nSELECT MAX(elo) FROM echecs.joueuse ‚û°Ô∏è renvoie un nombre\nNous pouvons ensuite tester si elo est √©gal √† ce nombre\n\n\nSELECT nom,\n       prenom,\n       elo\n  FROM echecs.joueuse\n WHERE elo = (SELECT MAX(elo) FROM echecs.joueuse);"
  },
  {
    "objectID": "doc/cours/agregations.html#regroupement",
    "href": "doc/cours/agregations.html#regroupement",
    "title": "Agr√©gations",
    "section": "6 Regroupement",
    "text": "6 Regroupement\nComment obtenir la moyenne elo par club ?\n\nSELECT ville_club,    -- Supposons que la table joueuse a un attribut ville_club\n       AVG(elo)\n  FROM echecs.joueuse\n GROUP BY ville_club;\n\n\n\n\nville_club\navg_elo\n\n\n\n\nAsnieres\n2372.4\n\n\nChartres\n2371.0\n\n\nBischwiller\n2404.5\n\n\n\n\n\n\nJ‚Äôai mis ville_club car id_club c‚Äôest moins joli et on verra les jointures ensuite.\nVous pouvez utiliser ROUND() pour arrondir.\n\n\nColonnes du GROUP BY\nVous pouvez grouper en utilisant plusieurs colonnes.\n\n\n\n\n\n\nImportant\n\n\n\nLes colonnes pr√©sentes dans le SELECT doivent imp√©rativement √™tre pr√©sentes dans le GROUP BY.\nL‚Äôinverse n‚Äôest pas vrai. Vous pouvez avoir des colonnes du GROUP BY que vous n‚Äôaffichez pas dans le SELECT.\n\n\n\nje dis bien colonnes et pas fonctions d‚Äôaggr√©gation\n\n\n\nFiltrer suite au GROUP BY\nComment faire pour afficher uniquement les clubs o√π la moyenne √©lo est inf√©rieure √† 2400 ?\n\nSELECT ville_club,\n       AVG(elo)\n  FROM echecs.joueuse\n GROUP BY ville_club\nHAVING AVG(elo) &lt; 2400;\n\n\n\n\n\nclub\navg_elo\n\n\n\n\nAsnieres\n2372.4\n\n\nChartres\n2371.0\n\n\n\n\n\n\n\nHaving Vs Where\n\nWHERE - Filtre Avant l‚ÄôAgr√©gation\nHAVING - Filtre Apr√®s l‚ÄôAgr√©gation"
  },
  {
    "objectID": "doc/cours/sql-intro-slides.html#structured-query-language",
    "href": "doc/cours/sql-intro-slides.html#structured-query-language",
    "title": "SQL - Introduction",
    "section": "Structured Query Language",
    "text": "Structured Query Language\n\n\n\n\n\n\n\nD√©finition\n\n\nLe SQL est un langage d√©claratif et standardis√© utilis√© pour interagir avec des bases de donn√©es relationnelles.\nIl permet de cr√©er, manipuler, interroger et g√©rer les donn√©es stock√©es dans des tables."
  },
  {
    "objectID": "doc/cours/sql-intro-slides.html#d√©finition-de-donn√©es",
    "href": "doc/cours/sql-intro-slides.html#d√©finition-de-donn√©es",
    "title": "SQL - Introduction",
    "section": "D√©finition de Donn√©es",
    "text": "D√©finition de Donn√©es\n\nIci nous n‚Äôallons travailler que sur une seule table √† la fois"
  },
  {
    "objectID": "doc/cours/sql-intro-slides.html#ins√©rer-des-donn√©es",
    "href": "doc/cours/sql-intro-slides.html#ins√©rer-des-donn√©es",
    "title": "SQL - Introduction",
    "section": "Ins√©rer des donn√©es",
    "text": "Ins√©rer des donn√©es\n\n\n\n\n\n\n\nclassDiagram\n    class Club {\n        id_club PK\n        nom\n        ville\n        date_creation\n    }\n\n\n\n\n\n\n\n-- Rappel du CREATE\nCREATE TABLE echecs.club (\n    id_club          SERIAL          PRIMARY KEY,  \n    nom              VARCHAR(100)    NOT NULL,   \n    ville            VARCHAR(100)    NOT NULL, \n    date_creation    DATE\n);\n\n\nINSERT INTO echecs.club \n(nom,                              ville,            date_creation)\nVALUES           \n('C''Chartres Echecs',            'Chartres',        '1991-09-01'),\n('Bischwiller',                   'Bischwiller',     '1976-09-01'),\n('Asnieres - le Grand Echiquier', 'Asnieres',        '1987-03-20'),\n('Tours des Hauts-De-France',     'Saint-Quentin',   '1999-12-01');\n\n\nPourquoi l‚Äôon n‚Äôins√®re pas la colonne id_club ? üòï\n\n\nAttention √† bien mettre les virgules au bon endroit\n\nPas de double quotes en SQL !!!\n‚Äô‚Äô : Pour ajouter un simple quote dans une chaine\n\nPossible d‚Äôins√©rer la colonne id_club en dur :\n\npas une bonne pratique\nsauf si on sait ce qu‚Äôon fait (pour figer)\npenser √† modif la s√©quence"
  },
  {
    "objectID": "doc/cours/sql-intro-slides.html#lire-des-donn√©es",
    "href": "doc/cours/sql-intro-slides.html#lire-des-donn√©es",
    "title": "SQL - Introduction",
    "section": "Lire des donn√©es",
    "text": "Lire des donn√©es\nSELECT * FROM &lt;schema&gt;.&lt;table&gt; pour tout afficher.\nSELECT *\n  FROM echecs.club;\n\n\n\n\n\n\n\n\n\n\n\n\nid_club\nnom\nville\ndate_creation\n\n\n\n\n1\nC‚ÄôChartres Echecs\nChartres\n1991-09-01\n\n\n2\nBischwiller\nBischwiller\n1976-09-01\n\n\n3\nAsnieres - le Grand Echiquier\nAsnieres\n1987-03-20\n\n\n4\nTours des Hauts-De-France\nSaint-Quentin\n1999-12-01\n\n\n\n\n\n\n\n* : toutes les colonnes"
  },
  {
    "objectID": "doc/cours/sql-intro-slides.html#mise-√†-jour-de-donn√©es",
    "href": "doc/cours/sql-intro-slides.html#mise-√†-jour-de-donn√©es",
    "title": "SQL - Introduction",
    "section": "Mise √† jour de donn√©es",
    "text": "Mise √† jour de donn√©es\nUPDATE echecs.joueuse\n   SET elo = 2399,\n       prenom = 'Popo'\n WHERE id_joueuse = 1;\n\n\n\nSELECT id_joueuse,\n       nom,\n       prenom,\n       elo\n  FROM echecs.joueuse\n WHERE id_joueuse = 1;\n\n\n\n\n\n\n\n\n\n\nid_joueuse\nnom\nprenom\nelo\n\n\n\n\n1\nGuichard\nPopo\n2399"
  },
  {
    "objectID": "doc/cours/sql-intro-slides.html#suppression-de-donn√©es",
    "href": "doc/cours/sql-intro-slides.html#suppression-de-donn√©es",
    "title": "SQL - Introduction",
    "section": "Suppression de donn√©es",
    "text": "Suppression de donn√©es\nSupprimer une joueuse :\nDELETE FROM echecs.joueuse\n WHERE id_joueuse = 1;\n\nVider la table :\nDELETE FROM echecs.joueuse;"
  },
  {
    "objectID": "doc/cours/sql-intro-slides.html#validation-des-op√©rations",
    "href": "doc/cours/sql-intro-slides.html#validation-des-op√©rations",
    "title": "SQL - Introduction",
    "section": "Validation des op√©rations",
    "text": "Validation des op√©rations\nEt si ? Vous avez ex√©cut√© par erreur :\nDELETE FROM echecs.joueuse; üò±\n\nIl y a un syst√®me de transactions avec les mots cl√©s :\n\nBEGIN\nCOMMIT\nROLLBACK\n\n\n\n\n\n\n\n\nAuto-commit\n\n\nAttention : il n‚Äôy a pas de garde-fou lorsque vous √™tes en Auto-commit.\n\n\n\n\n\n\nVu plus tard dans le cours"
  },
  {
    "objectID": "doc/cours/sql-intro-slides.html#dates-et-heures",
    "href": "doc/cours/sql-intro-slides.html#dates-et-heures",
    "title": "SQL - Introduction",
    "section": "Dates et Heures",
    "text": "Dates et Heures"
  },
  {
    "objectID": "doc/cours/sql-intro-slides.html#valeurs-nulles",
    "href": "doc/cours/sql-intro-slides.html#valeurs-nulles",
    "title": "SQL - Introduction",
    "section": "Valeurs nulles",
    "text": "Valeurs nulles"
  },
  {
    "objectID": "doc/cours/sql-intro-slides.html#divers",
    "href": "doc/cours/sql-intro-slides.html#divers",
    "title": "SQL - Introduction",
    "section": "Divers",
    "text": "Divers"
  },
  {
    "objectID": "doc/cours/sql-intro-slides.html#r√©sum√©",
    "href": "doc/cours/sql-intro-slides.html#r√©sum√©",
    "title": "SQL - Introduction",
    "section": "R√©sum√©",
    "text": "R√©sum√©\n\nCREATE / ALTER / DELETE\nINSERT\nSELECT\nWHERE"
  },
  {
    "objectID": "doc/cours/sql-intro.html",
    "href": "doc/cours/sql-intro.html",
    "title": "SQL - Introduction",
    "section": "",
    "text": "NoteD√©finition\n\n\n\nLe SQL est un langage d√©claratif et standardis√© utilis√© pour interagir avec des bases de donn√©es relationnelles.\nIl permet de cr√©er, manipuler, interroger et g√©rer les donn√©es stock√©es dans des tables.\n\n\n\n\nSQL est un language norm√© dont la derni√®re version est SQL:2023.\n\n\n\n\n\n\nCaution\n\n\n\nLes SGBD ne respectent pas exactement la norme SQL.\n√Ä un niveau avanc√© d‚Äôutilisation, il y a des diff√©rences entre les SGBD.\n\n\n\nPostgreSQL SQL\nDuckDB SQL\n\n\n\nSinon c‚Äôest tr√®s ressemblant.\nDuckDB‚Äôs SQL dialect closely follows the conventions of the PostgreSQL dialect. few exceptions\n\n\n\n\n\n\nObjectifsSous-langages\n\n\n\nD√©finition de Donn√©es\nManipulation de Donn√©es\nContr√¥le des Transactions\nContr√¥le d‚Äôacc√®s aux Donn√©es\n\n\n\n\n\n\n\n\n\n\n\n\n\nAcronyme\nExemple\n\n\n\n\nDDL\nData Definition Language\nCREATE TABLE, ALTER TABLE, DROP TABLE\n\n\nDML\nData Manipulation Language\nINSERT, UPDATE, DELETE\n\n\nDQL\nData Query Language\nSELECT\n\n\nDCL\nData Control Language\nGRANT, REVOKE\n\n\nTCL\nTransaction Control Language\nCOMMIT, ROLLBACK"
  },
  {
    "objectID": "doc/cours/sql-intro.html#structured-query-language",
    "href": "doc/cours/sql-intro.html#structured-query-language",
    "title": "SQL - Introduction",
    "section": "",
    "text": "NoteD√©finition\n\n\n\nLe SQL est un langage d√©claratif et standardis√© utilis√© pour interagir avec des bases de donn√©es relationnelles.\nIl permet de cr√©er, manipuler, interroger et g√©rer les donn√©es stock√©es dans des tables.\n\n\n\n\nSQL est un language norm√© dont la derni√®re version est SQL:2023.\n\n\n\n\n\n\nCaution\n\n\n\nLes SGBD ne respectent pas exactement la norme SQL.\n√Ä un niveau avanc√© d‚Äôutilisation, il y a des diff√©rences entre les SGBD.\n\n\n\nPostgreSQL SQL\nDuckDB SQL\n\n\n\nSinon c‚Äôest tr√®s ressemblant.\nDuckDB‚Äôs SQL dialect closely follows the conventions of the PostgreSQL dialect. few exceptions\n\n\n\n\n\n\nObjectifsSous-langages\n\n\n\nD√©finition de Donn√©es\nManipulation de Donn√©es\nContr√¥le des Transactions\nContr√¥le d‚Äôacc√®s aux Donn√©es\n\n\n\n\n\n\n\n\n\n\n\n\n\nAcronyme\nExemple\n\n\n\n\nDDL\nData Definition Language\nCREATE TABLE, ALTER TABLE, DROP TABLE\n\n\nDML\nData Manipulation Language\nINSERT, UPDATE, DELETE\n\n\nDQL\nData Query Language\nSELECT\n\n\nDCL\nData Control Language\nGRANT, REVOKE\n\n\nTCL\nTransaction Control Language\nCOMMIT, ROLLBACK"
  },
  {
    "objectID": "doc/cours/sql-intro.html#d√©finition-de-donn√©es",
    "href": "doc/cours/sql-intro.html#d√©finition-de-donn√©es",
    "title": "SQL - Introduction",
    "section": "2 D√©finition de Donn√©es",
    "text": "2 D√©finition de Donn√©es\n\nIci nous n‚Äôallons travailler que sur une seule table √† la fois\n\n\nCr√©er une table\nCREATE TABLE joueuse (\n¬† ¬† id_joueuse     INT,\n¬† ¬† nom            TEXT,\n¬† ¬† prenom         TEXT,\n¬† ¬† date_naissance DATE,\n¬† ¬† elo            INT,\n¬† ¬† est_arbitre    BOOLEAN,\n¬† ¬† code_pays      TEXT,\n    taux_victoires FLOAT\n);\n\nC‚Äôest comme cr√©er les colonnes d‚Äôun tableau.\nTout en sp√©cifiant les types.\n\n\n\nCREATE avanc√©\nCREATE TABLE echecs.joueuse (\n    id_joueuse     SERIAL         PRIMARY KEY,   \n    nom            VARCHAR(50)    NOT NULL, \n    prenom         VARCHAR(50)    NOT NULL, \n    date_naissance TIMESTAMP,                 \n    elo            INT            CHECK (elo &gt; 0),  \n    mail           VARCHAR(100)   UNIQUE,         \n    est_arbitre    BOOLEAN        DEFAULT false,\n    code_pays      VARCHAR(2)     REFERENCES echecs.pays(code),          \n    taux_victoires FLOAT          CHECK (taux_victoires BETWEEN 0 AND 1)\n);\n\n\n\n\n\n\n\nImportantContraintes\n\n\n\n\nNOT NULL : l‚Äôattribut doit √™tre renseign√©\nUNIQUE : chaque valeur de l‚Äôattribut est unique (pas de doublons)\nCHECK : pour v√©rifier la coh√©rence d‚Äôun attribut\n\n\n\n\n\n\nSch√©ma echecs : j‚Äôy viens juste apr√®s\nSERIAL : s√©quence num√©rique, on en reparle dans quelques minutes\nVARCHAR(50) pour limiter la taille des valeurs\nDEFAULT : valeur par d√©faut (principalement lors de l‚ÄôINSERT)\n\nImportant : La PK est NOT NULL et UNIQUE\nREFERENCES, dans quel ordre :\n\ncr√©er les tables joueuse et pays ?\nsupprimer les tables\n\n\n\n\nSch√©ma\nUtile lorsque le nombre de tables devient grand.\nCela facilite :\n\nl‚Äôorganisation des objets, la clart√©\nla Gestion des permissions\n\nCREATE SCHEMA echecs;\n\nSi vous travaillez dans une multinationale qui vend des v√™tements, est ce que vous allez m√©langer les tables qui g√©rent :\n\nla vente de slip\nles stocks\nles commandes fournisseurs\nles cong√©s du personnel\nla compta\n\n\n\nPamplemousse -&gt; Mill√©sime\nUtiliser la m√™me bdd pour la gestion RH, le m√©tier et la compta\ncr√©er un sch√©ma pour s√©parer les tables\n\n\n\n\nTable dans un sch√©ma\nCREATE TABLE echecs.club (\n    id_club          SERIAL          PRIMARY KEY,  \n    nom              VARCHAR(100)    NOT NULL,   \n    ville            VARCHAR(100)    NOT NULL, \n    date_creation    DATE\n);\n\nD√©placer la table joueuse dans le sch√©ma echecs :\nALTER TABLE joueuse SET SCHEMA echecs;\n\n\n\n\n\n\n\nNoteSch√©ma par d√©faut\n\n\n\nPar d√©faut les objets sont cr√©√©s dans le sch√©ma public.\n√áa devient rapidement un joyeux bazar si on ne range pas ses tables.\n\n\n\n\nC‚Äôest comme cr√©er un fichier dans un dossier.\n\n\n\n\nAutres CREATE\nCREATE TABLE top_joueuses AS\nSELECT nom, prenom, elo\n  FROM echecs.joueuse\n WHERE elo &gt; 2200;\n\n\nCREATE TABLE joueuse_vide AS\nSELECT nom, prenom, elo\n  FROM echecs.joueuse\n WHERE 0=1;\n\n\nCREATE TABLE joueuse_backup (LIKE echecs.joueuse INCLUDING ALL);\n\n\n‚ö†Ô∏è Les contraintes (cl√©s primaires, √©trang√®res, etc.) ne sont pas copi√©es automatiquement\nLIKE : Cloner une table sans ses donn√©es (par exemple avant import)\n\noption INCLUDING ALL = inclut contraintes, index, etc.\n\n\n\n\n\nBonnes pratiques\n\nNom de table repr√©sentatif et au singulier\nPas de majuscules, pas d‚Äôaccents\nMots s√©par√©s par des underscores (snake_case)\nNe pas utiliser de mots cl√©s r√©serv√©s (date, user‚Ä¶)\nNe pas avoir de colonne qui porte le m√™me nom que sa table\n\n\ndans les requ√™tes : mots cl√©s en majuscules\n\n\n\nModifier une colonne\nModifier le type :\nALTER TABLE joueuse\nALTER COLUMN nom TYPE VARCHAR(80);\n\nRenommer :\nALTER TABLE echecs.joueuse\nRENAME COLUMN date_naissance TO dnais;\n\nSoyez vigilents :\n\n‚ö†Ô∏è Compatibilit√© des types\nperf, peut-√™tre tr√®s long\ncontraintes, FK\nVARCHAR(50) ‚Üí VARCHAR(20) coupe les cha√Ænes longues\nFLOAT ‚Üí INT tronque les d√©cimales\n\n\n\n\nCr√©er/Supprimer une colonne\nAjout :\nALTER TABLE echecs.joueuse\nADD COLUMN id_club INT;\n\nSuppression :\nALTER TABLE echecs.joueuse\nDROP COLUMN taux_victoires;\n\n\nD√©finir une cl√© √©trang√®re\n\nNous venons de cr√©er une colonne id_club\nLions maintenant cette colonne √† la table club\n\nALTER TABLE echecs.joueuse\nADD CONSTRAINT fk_id_club\nFOREIGN KEY (id_club)\nREFERENCES echecs.club(id_club);\n\n\n\n\n\n\n\nTipCl√© √©trang√®re\n\n\n\nDans la table joueuse, l‚Äôattribut id_club a pour valeur soit :\n\nune valeur de id_club de la table club\nNULL\n\n\n\n\n\n\nAutres possibilit√©s\n\nRenommer une table\nAjouter / Supprimer une contrainte\nD√©finir / Supprimer une valeur par d√©faut\n\n\n\nSupprimer une table\nDROP TABLE echecs.joueuse;\n\n\n\n\n\n\n\nWarning\n\n\n\nCette op√©ration est irr√©versible !\nElle supprime d√©finitivement :\n\nla table\ntoutes les donn√©es qu‚Äôelle contient\n\n\n\n\nDROP TABLE IF EXISTS echecs.joueuse;      -- utile pour les scripts SQL\n\n\nDROP TABLE tout court\n\nsi table existe pas, le script s‚Äôarr√™te\nla suite n‚Äôest pas ex√©cut√©e\n\nDROP TABLE IF EXISTS\n\nutile pour tout supprimer puis recr√©er"
  },
  {
    "objectID": "doc/cours/sql-intro.html#ins√©rer-des-donn√©es",
    "href": "doc/cours/sql-intro.html#ins√©rer-des-donn√©es",
    "title": "SQL - Introduction",
    "section": "3 Ins√©rer des donn√©es",
    "text": "3 Ins√©rer des donn√©es\n\n\n\n\n\n\n\nclassDiagram\n    class Club {\n        id_club PK\n        nom\n        ville\n        date_creation\n    }\n\n\n\n\n\n\n\n-- Rappel du CREATE\nCREATE TABLE echecs.club (\n    id_club          SERIAL          PRIMARY KEY,  \n    nom              VARCHAR(100)    NOT NULL,   \n    ville            VARCHAR(100)    NOT NULL, \n    date_creation    DATE\n);\n\n\n\nINSERT INTO echecs.club \n(nom,                              ville,            date_creation)\nVALUES           \n('C''Chartres Echecs',            'Chartres',        '1991-09-01'),\n('Bischwiller',                   'Bischwiller',     '1976-09-01'),\n('Asnieres - le Grand Echiquier', 'Asnieres',        '1987-03-20'),\n('Tours des Hauts-De-France',     'Saint-Quentin',   '1999-12-01');\n\n\nPourquoi l‚Äôon n‚Äôins√®re pas la colonne id_club ? üòï\n\n\nAttention √† bien mettre les virgules au bon endroit\n\nPas de double quotes en SQL !!!\n‚Äô‚Äô : Pour ajouter un simple quote dans une chaine\n\nPossible d‚Äôins√©rer la colonne id_club en dur :\n\npas une bonne pratique\nsauf si on sait ce qu‚Äôon fait (pour figer)\npenser √† modif la s√©quence\n\n\n\nS√©quence\nLa colonne id_club est une s√©quence g√©r√©e par le SGBD.\nLes valeurs sont g√©n√©r√©es automatiquement √† l‚Äôinsertion et la s√©quence est incr√©ment√©e (1, 2, 3‚Ä¶).\n\n\n\n\n\n\n\nTipS√©quences\n\n\n\n\n\nIl est possible de cr√©er et g√©rer ses propres s√©quences :\nCREATE SEQUENCE nom_sequence START 1 INCREMENT BY 1;\n\nSELECT currval('nom_sequence'); -- derni√®re valeur utilis√©e\nSELECT nextval('nom_sequence'); -- prochaine valeur\n\nALTER SEQUENCE nom_sequence RESTART WITH nouvelle_valeur;\n\nDROP SEQUENCE nom_sequence;"
  },
  {
    "objectID": "doc/cours/sql-intro.html#lire-des-donn√©es",
    "href": "doc/cours/sql-intro.html#lire-des-donn√©es",
    "title": "SQL - Introduction",
    "section": "4 Lire des donn√©es",
    "text": "4 Lire des donn√©es\nSELECT * FROM &lt;schema&gt;.&lt;table&gt; pour tout afficher.\nSELECT *\n  FROM echecs.club;\n\n\n\n\n\n\n\n\n\n\n\n\nid_club\nnom\nville\ndate_creation\n\n\n\n\n1\nC‚ÄôChartres Echecs\nChartres\n1991-09-01\n\n\n2\nBischwiller\nBischwiller\n1976-09-01\n\n\n3\nAsnieres - le Grand Echiquier\nAsnieres\n1987-03-20\n\n\n4\nTours des Hauts-De-France\nSaint-Quentin\n1999-12-01\n\n\n\n\n\n\n\n* : toutes les colonnes\n\n\n\nColonnes √† afficher\nListez les colonnes √† afficher apr√®s le SELECT\nSELECT nom,\n       prenom,\n       elo\n  FROM echecs.joueuse;\n\n\n\n\n\n\nnom\nprenom\nelo\n\n\n\n\nGuichard\nPauline\n2357\n\n\nDaulyte-Cornette\nDeimante\n2371\n\n\nNavrotescu\nAndreea\n2338\n\n\nSebag\nMarie\n2448\n\n\nMillet\nSophie\n2366\n\n\nSkrichempko\nAlmira\n2361\n\n\n\n\n\n\n\nFiltrer les lignes\nFiltrez sur les lignes avec une clause WHERE.\nSELECT nom,\n       prenom,\n       elo\n  FROM echecs.joueuse\n WHERE elo &gt; 2400;\n\n\n\n\n\n\nnom\nprenom\nelo\n\n\n\n\nSebag\nMarie\n2448\n\n\n\n\n\n\n\nPlusieurs filtres\nLe mot cl√© AND permet d‚Äôajouter d‚Äôautres filtres.\nSELECT nom,\n       prenom,\n       elo\n  FROM echecs.joueuse\n WHERE elo &lt; 2400\n   AND prenom LIKE 'A%';\n\n\n\n\n\n\nnom\nprenom\nelo\n\n\n\n\nNavrotescu\nAndreea\n2338\n\n\nSkrichempko\nAlmira\n2361\n\n\n\n\n\n\n1 seul WHERE\nplusieurs AND\nLIKE ‚ÄòA%‚Äô : commence par A, j‚Äôy viens dans 2 min\n\n\nVous pouvez autoriser plusieurs conditions avec OR.\nSELECT nom,\n       prenom,\n       elo\n  FROM echecs.joueuse\n WHERE elo &gt; 2400\n    OR prenom LIKE 'A%';\n\n\n\n\n\n\nnom\nprenom\nelo\n\n\n\n\nSebag\nMarie\n2448\n\n\nNavrotescu\nAndreea\n2338\n\n\nSkrichempko\nAlmira\n2361\n\n\n\n\n\n\n\nOp√©rations bool√©ennes\n\nUtilisation des mots-cl√©s AND, OR et NOT\nAND prioritaire sur le OR\n\nSELECT nom,\n       prenom,\n       elo\n  FROM echecs.joueuse\n WHERE elo &gt; 2400 OR (prenom LIKE 'A%' AND nom NOT LIKE 'N%') ;\n\n\nLIKE\nSELECT *\n  FROM echecs.joueuse\n WHERE prenom LIKE 'A%'         -- commence par A\n    OR prenom LIKE '%A'         -- termine par A\n    OR prenom LIKE '%A%'        -- contient au moins un A\n    OR UPPER(prenom) LIKE '%A%' -- contient au moins un A ou un a\n    OR prenom LIKE 'A__'        -- commence par A suivi de 2 autres caract√®res\n\n% : repr√©sente entre 0 et une infinit√© de caract√®res\n_ : repr√©sente exactement 1 caract√®re\n\n\n\n\n\n\n\nCautionLIKE est sensible √† la Casse\n\n\n\nMAJUSCULES ‚â† minuscules\n\n\n\nILIKE insensible √† la casse\n'abc' SIMILAR TO 'abc'          true\n'abc' SIMILAR TO 'a'            false\n'abc' SIMILAR TO '%(b|d)%'      true\n'abc' SIMILAR TO '(b|c)%'       false\n'-abc-' SIMILAR TO '%\\mabc\\M%'  true\n'xabcy' SIMILAR TO '%\\mabc\\M%'  false\n\n\n\nPlage de valeurs\nBETWEEN permet de sp√©cifier une plage de valeurs num√©riques.\nSELECT nom,\n       prenom,\n       elo\n  FROM echecs.joueuse\n WHERE elo BETWEEN 2350 AND 2400;\n\n\n\n\n\n\nnom\nprenom\nelo\n\n\n\n\nGuichard\nPauline\n2357\n\n\nDaulyte-Cornette\nDeimante\n2371\n\n\nMillet\nSophie\n2366\n\n\nSkrichempko\nAlmira\n2361\n\n\n\n\n\n\n\nValeurs dans une liste\nVous pouvez sp√©cifier qu‚Äôun attribut doit appartenir √† un liste avec IN.\nOu inversement avec NOT IN.\nSELECT nom,\n       prenom,\n       elo\n  FROM echecs.joueuse\n WHERE prenom IN ('Deimante', 'Sophie');\n\n\n\n\n\n\nnom\nprenom\nelo\n\n\n\n\nDaulyte-Cornette\nDeimante\n2371\n\n\nMillet\nSophie\n2366\n\n\n\n\n\n\nPossible de lister des valeurs num√©riques\n\n\n\nFiltre sur les attributs bool√©ens\nSELECT *\n  FROM echecs.joueuse\n WHERE est_arbitre IS TRUE;\n\nSELECT *\n  FROM echecs.joueuse\n WHERE [NOT] est_arbitre;\n\n\nOrdonner le r√©sultat\nORDER BY pour ordonner selon plusieurs colonnes.\nSELECT nom,\n       prenom,\n       elo\n  FROM echecs.joueuse\n ORDER BY elo,\n          taux_victoires DESC;\n\n\n\n\n\nnom\nprenom\nelo\n\n\n\n\nNavrotescu\nAndreea\n2338\n\n\nGuichard\nPauline\n2357\n\n\nSkrichempko\nAlmira\n2361\n\n\nMillet\nSophie\n2366\n\n\nDaulyte-Cornette\nDeimante\n2371\n\n\nSebag\nMarie\n2448\n\n\n\n\n\n\n\nORDER BY 2 : 2e colonne\nRemarque : pas oblig√© de SELECT les colonnes du OBY\n\n\n\n\nAfficher n lignes\nSELECT nom,\n       prenom,\n       elo\n  FROM echecs.joueuse\n LIMIT 3;\n\n\n\n\n\n\nnom\nprenom\nelo\n\n\n\n\nGuichard\nPauline\n2357\n\n\nDaulyte-Cornette\nDeimante\n2371\n\n\nNavrotescu\nAndreea\n2338"
  },
  {
    "objectID": "doc/cours/sql-intro.html#mise-√†-jour-de-donn√©es",
    "href": "doc/cours/sql-intro.html#mise-√†-jour-de-donn√©es",
    "title": "SQL - Introduction",
    "section": "5 Mise √† jour de donn√©es",
    "text": "5 Mise √† jour de donn√©es\nUPDATE echecs.joueuse\n   SET elo = 2399,\n       prenom = 'Popo'\n WHERE id_joueuse = 1;\n\n\n\nSELECT id_joueuse,\n       nom,\n       prenom,\n       elo\n  FROM echecs.joueuse\n WHERE id_joueuse = 1;\n\n\n\n\n\n\n\n\n\n\nid_joueuse\nnom\nprenom\nelo\n\n\n\n\n1\nGuichard\nPopo\n2399\n\n\n\n\n\n\nM√†j globale\nImaginons que vous souhaitez modifier le elo de toutes les joueuses.\nUPDATE echecs.joueuse\n   SET elo = elo + 100;\n-- RETURNING id_joueuse, nom, prenom, elo;\n\n\n\n\n\n\nWarning\n\n\n\nG√©n√©ralement un message d‚Äôavertissement vous demande si vous √™tes certain de vouloir mettre √† jour toutes les lignes.\n\n\n\n\nM√†j √† partir d‚Äôune autre table\n--ALTER TABLE echecs.joueuse\n--ADD COLUMN club_commencant_par_a BOOLEAN DEFAULT false;\n\nUPDATE echecs.joueuse j\n   SET club_commencant_par_a = true\n  FROM echecs.club c\n WHERE j.id_club = c.id_club\n   AND c.nom LIKE 'A%';"
  },
  {
    "objectID": "doc/cours/sql-intro.html#suppression-de-donn√©es",
    "href": "doc/cours/sql-intro.html#suppression-de-donn√©es",
    "title": "SQL - Introduction",
    "section": "6 Suppression de donn√©es",
    "text": "6 Suppression de donn√©es\nSupprimer une joueuse :\nDELETE FROM echecs.joueuse\n WHERE id_joueuse = 1;\n\nVider la table :\nDELETE FROM echecs.joueuse;"
  },
  {
    "objectID": "doc/cours/sql-intro.html#validation-des-op√©rations",
    "href": "doc/cours/sql-intro.html#validation-des-op√©rations",
    "title": "SQL - Introduction",
    "section": "7 Validation des op√©rations",
    "text": "7 Validation des op√©rations\nEt si ? Vous avez ex√©cut√© par erreur :\nDELETE FROM echecs.joueuse; üò±\n\nIl y a un syst√®me de transactions avec les mots cl√©s :\n\nBEGIN\nCOMMIT\nROLLBACK\n\n\n\n\n\n\n\nWarningAuto-commit\n\n\n\nAttention : il n‚Äôy a pas de garde-fou lorsque vous √™tes en Auto-commit.\n\n\n\n\nVu plus tard dans le cours"
  },
  {
    "objectID": "doc/cours/sql-intro.html#dates-et-heures",
    "href": "doc/cours/sql-intro.html#dates-et-heures",
    "title": "SQL - Introduction",
    "section": "8 Dates et Heures",
    "text": "8 Dates et Heures\n\nType DATE\nQuelques op√©rations avec le type DATE.\nSELECT nom,\n       prenom,\n       EXTRACT(YEAR FROM date_naissance) AS annee_naissance,\n       date_naissance + INTERVAL '10 years' AS anniv_dix_ans,\n       AGE(CURRENT_DATE, date_naissance) AS age\n  FROM echecs.joueuse\n WHERE date_naissance &gt;= '1991-04-20'\n    OR date_naissance BETWEEN '1991-04-20' AND '1992-12-31'\n    OR EXTRACT(MONTH FROM date_naissance) = 4;\n\nJe passe assez vite, les dates et les heures c‚Äôest toujours p√©nible dans tous les langages\n\n\n\nType TIMESTAMP\nPour stocker la date et l‚Äôheure\nCREATE TABLE echecs.club (\n    id_club          SERIAL          PRIMARY KEY,  \n    nom              VARCHAR(100)    NOT NULL,   \n    ville            VARCHAR(100)    NOT NULL, \n    date_creation    TIMESTAMP\n);\n\n\nUtilisations\nINSERT INTO echecs.club (nom, ville, date_creation)\nVALUES ('C''Chartres Echecs', 'Chartres', '1991-09-01 20:00:00');\n\nINSERT INTO echecs.club (nom, ville, date_creation)\nVALUES ('Bischwiller', 'Bischwiller', CURRENT_TIMESTAMP);\nVous pouvez utiliser √©galement sur le type TIMESTAMP :\n\nEXTRACT,\nBETWEEN,\nles op√©rateurs de comparaison"
  },
  {
    "objectID": "doc/cours/sql-intro.html#valeurs-nulles",
    "href": "doc/cours/sql-intro.html#valeurs-nulles",
    "title": "SQL - Introduction",
    "section": "9 Valeurs nulles",
    "text": "9 Valeurs nulles\n\nTester si un attribut est NULL\nJoueuses dont le mail n‚Äôest pas renseign√© :\nSELECT *\n  FROM echecs.joueuse\n WHERE mail IS NULL; \n\nEt inversemenent :\nSELECT *\n  FROM echecs.joueuse\n WHERE mail IS NOT NULL;\n\n\nCOALESCE\n\n\n\n\n\n\nTipLa fonction COALESCE\n\n\n\nEn PostgreSQL, la fonction COALESCE :\n\nprend un nombre quelconque de param√®tres\nretourne le 1er param√®tre dont la valeur est NON NULLE\n\n\n\n\nc(x1, x2, ... xn):\n  if x1:\n    return x1\n  else:\n    return c(x2, ... xn)\nNVL pour Oracle (√† ne pas confondre avec MVL)\n\n\n\nCOALESCE - Exemple\nSELECT COALESCE(mail, tel, 'pas de contact')\n  FROM echecs.joueuse\n WHERE id_joueuse = 1\nLa requ√™te ci-dessus va afficher :\n\nSi mail est NON NULL ‚û°Ô∏è mail\nSinon\n\nSi tel NON NULL ‚û°Ô∏è tel\nSinon ‚û°Ô∏è pas de contact\n\n\n\n\nNULLIF\nSELECT NULLIF(tel, '00.00.00.00.00') \n  FROM echecs.joueuse;\n\nSi tel = 00.00.00.00.00\n\nRenvoie NULL"
  },
  {
    "objectID": "doc/cours/sql-intro.html#divers",
    "href": "doc/cours/sql-intro.html#divers",
    "title": "SQL - Introduction",
    "section": "10 Divers",
    "text": "10 Divers\n\nJouer avec les colonnes\nSELECT CONCAT(nom, ' ', prenom) AS nom_complet,\n       elo\n  FROM echecs.joueuse;\n\n\n\n\n\n\nnom_complet\nelo\n\n\n\n\nGuichard Pauline\n2357\n\n\nDaulyte-Cornette Deimante\n2371\n\n\nNavrotescu Andreea\n2338\n\n\nSebag Marie\n2448\n\n\nMillet Sophie\n2366\n\n\nSkrichempko Almira\n2361\n\n\n\n\n\n\n\nSupprimer les doublons\nLe mot cl√© DISTINCT permet de supprimer les doublons.\nSELECT DISTINCT prenom\n  FROM echecs.joueuse;\n\nmot cl√© √† retenir\nautre utilisation dans les agr√©gations\nSELECT COUNT(DISTINCT code_pays) AS nb_pays\nFROM echecs.joueuse;\n\n\n\nChoix\nSELECT CASE WHEN elo &gt; 2400 THEN 'Niveau MI'\n            WHEN elo &gt; 2200 THEN 'Joueuse tr√®s forte'\n            ELSE 'Joueuse de niveau normal'\n       END\n  FROM echecs.joueuse;\n\n\n√âchantillon\nAfficher un √©chantillon al√©atoire de 10 % des lignes\nSELECT *\n  FROM echecs.joueuse\nTABLESAMPLE BERNOULLI(10);\n\n\nEt m√™me !?\nSELECT 1,\n       TRUE,\n       'a',\n       current_date,\n       NOW()\n  FROM echecs.joueuse;"
  },
  {
    "objectID": "doc/cours/sql-intro.html#r√©sum√©",
    "href": "doc/cours/sql-intro.html#r√©sum√©",
    "title": "SQL - Introduction",
    "section": "11 R√©sum√©",
    "text": "11 R√©sum√©\n\nCREATE / ALTER / DELETE\nINSERT\nSELECT\nWHERE"
  },
  {
    "objectID": "doc/cours/formalisation-slides.html#objectifs",
    "href": "doc/cours/formalisation-slides.html#objectifs",
    "title": "Formalisation des bases de donn√©es",
    "section": "Objectifs",
    "text": "Objectifs\nStructurer une base de donn√©es pour qu‚Äôelle soit :\n\nefficace\npropre\nl√©g√®re\nfacile √† maintenir\n\n\n\npas de doublons et de redondances\nMoins de risques d‚Äôincoh√©rences entre diff√©rentes parties de la base\nStockage r√©duit, car les informations r√©p√©t√©es sont √©limin√©es."
  },
  {
    "objectID": "doc/cours/formalisation-slides.html#d√©pendances-fonctionnelles",
    "href": "doc/cours/formalisation-slides.html#d√©pendances-fonctionnelles",
    "title": "Formalisation des bases de donn√©es",
    "section": "D√©pendances fonctionnelles",
    "text": "D√©pendances fonctionnelles\n\n\n\n\n\n\n\nD√©finition\n\n\nUne d√©pendance fonctionnelle indique qu‚Äôune colonne (ou un ensemble de colonnes) d√©termine de mani√®re unique une autre colonne :\n\nX ‚Üí Y\nX d√©termine Y\nY d√©pend fonctionnellement de X\n\n\n\n\n\n\nSi on connait X, on peut en d√©duire Y"
  },
  {
    "objectID": "doc/cours/formalisation-slides.html#formes-normales",
    "href": "doc/cours/formalisation-slides.html#formes-normales",
    "title": "Formalisation des bases de donn√©es",
    "section": "Formes normales",
    "text": "Formes normales"
  },
  {
    "objectID": "doc/cours/formalisation-slides.html#mod√©lisation-uml",
    "href": "doc/cours/formalisation-slides.html#mod√©lisation-uml",
    "title": "Formalisation des bases de donn√©es",
    "section": "Mod√©lisation UML",
    "text": "Mod√©lisation UML"
  },
  {
    "objectID": "doc/cours/formalisation.html",
    "href": "doc/cours/formalisation.html",
    "title": "Formalisation des bases de donn√©es",
    "section": "",
    "text": "Structurer une base de donn√©es pour qu‚Äôelle soit :\n\nefficace\npropre\nl√©g√®re\nfacile √† maintenir\n\n\n\npas de doublons et de redondances\nMoins de risques d‚Äôincoh√©rences entre diff√©rentes parties de la base\nStockage r√©duit, car les informations r√©p√©t√©es sont √©limin√©es."
  },
  {
    "objectID": "doc/cours/formalisation.html#objectifs",
    "href": "doc/cours/formalisation.html#objectifs",
    "title": "Formalisation des bases de donn√©es",
    "section": "",
    "text": "Structurer une base de donn√©es pour qu‚Äôelle soit :\n\nefficace\npropre\nl√©g√®re\nfacile √† maintenir\n\n\n\npas de doublons et de redondances\nMoins de risques d‚Äôincoh√©rences entre diff√©rentes parties de la base\nStockage r√©duit, car les informations r√©p√©t√©es sont √©limin√©es."
  },
  {
    "objectID": "doc/cours/formalisation.html#d√©pendances-fonctionnelles",
    "href": "doc/cours/formalisation.html#d√©pendances-fonctionnelles",
    "title": "Formalisation des bases de donn√©es",
    "section": "1 D√©pendances fonctionnelles",
    "text": "1 D√©pendances fonctionnelles\n\n\n\n\n\n\nNoteD√©finition\n\n\n\nUne d√©pendance fonctionnelle indique qu‚Äôune colonne (ou un ensemble de colonnes) d√©termine de mani√®re unique une autre colonne :\n\nX ‚Üí Y\nX d√©termine Y\nY d√©pend fonctionnellement de X\n\n\n\n\nSi on connait X, on peut en d√©duire Y\n\n\nLes axiomes d‚ÄôArmstrong\n\n\n\n\n\n\n\nNom\nDescription\n\n\n\n\nR√©flexivit√©\n(X, Y) ‚Üí X\n\n\nAugmentation\nSi X ‚Üí Y, alors XZ ‚Üí YZ\n\n\nTransitivit√©\nSi X ‚Üí Y et Y ‚Üí Z alors, X ‚Üí Z\n\n\n\n\n\n(nom, prenom) ‚Üí nom\nid_joueuse ‚Üí nom alors (id_joueuse, id_partie) ‚Üí (id_joueuse, nom)\n\n\n\n\nR√®gles d√©riv√©es\n\n\n\nNom\nDescription\n\n\n\n\nUnion\nSi X ‚Üí Y et X ‚Üí Z, alors X ‚Üí YZ\n\n\nD√©composition\nSi X ‚Üí YZ, alors X ‚Üí Z et X ‚Üí Y\n\n\nPseudo-transitivit√©\nSi X ‚Üí Y et WY ‚Üí Z alors WX ‚Üí Z\n\n\n\n\n\nDeux Propri√©t√©s\n\n\n\n\n\n\nNoteD√©pendance Fonctionnelle √âl√©mentaire\n\n\n\nX ‚Üí Y est √©l√©mentaire s‚Äôil n‚Äôexiste aucun sous-ensemble strict Z inclus dans X tel que Z ‚Üí Y\n\n\n\n\n\n\n\n\nNoteD√©pendance Fonctionnelle Directe\n\n\n\nX ‚Üí Y est directe s‚Äôil n‚Äôexiste pas de Z tel que X ‚Üí Z et Z ‚Üí Y\n\n\n\n\npas √©l√©menaire : num_client, nom ‚Üí adresse"
  },
  {
    "objectID": "doc/cours/formalisation.html#formes-normales",
    "href": "doc/cours/formalisation.html#formes-normales",
    "title": "Formalisation des bases de donn√©es",
    "section": "2 Formes normales",
    "text": "2 Formes normales\n\nNormalisation\n\n\n\n\n\n\nNoteD√©finition\n\n\n\nLa normalisation vise √† organiser les donn√©es :\n\nen √©liminant les redondances et les incoh√©rences\nen pr√©servant les d√©pendances fonctionnelles\nsans perdre d‚Äôinformations\n\n\n\n\n\n1√®re forme normale\n\n\n\n\n\n\nNoteD√©finition\n\n\n\nUne relation est 1NF si tous ses attributs sont atomiques.\n\n\n\nUne date est atomique\nUn nom est atomique\nUne liste de pr√©noms n‚Äôest pas atomique\nEst-ce qu‚Äôun adresse est atomique ?\n\n\n\natomique : repr√©sente une seule information\nnon atomique : plusieurs informations combin√©es\nassez subjectif\nd√©pend du cas d‚Äôutilisation\n\nsi vous n‚Äôutilisez pas le champ adresse -&gt; atomique\nsi vous avez utiliser par exemple la ville -&gt; pas atomique\n\n\n\n\n\n2e forme normale\n\n\n\n\n\n\nNoteD√©finition\n\n\n\nUne relation est 2NF si :\n\nelle est 1NF\ntout attribut non cl√© est en DF √©l√©mentaire avec la cl√©\n\nAutrement dit, tous les attributs sont d√©termin√©s par la cl√© compl√®te.\n\n\n\nExemple de relation non 2NF :\n\njoueuse(nom, prenom, dnais) ‚Üí elo\nsi par exemple (nom, dnais) ‚Üí elo\n\nsi nom et dnais suffisent pour d√©terminer le elo\n\n\n\n\n3e forme normale\n\n\n\n\n\n\nNoteD√©finition\n\n\n\nUne relation est 3NF si :\n\nelle est 2NF\ntout attribut non cl√© est en DF directe avec la cl√©\n\nAutrement dit, un attribut ne peut pas d√©pendre fonctionnellement d‚Äôun autre attribut non cl√©.\n\n\n\nExemple de relation non 3NF :\n\njoueuse(id_joueuse, code_pays, capitale)\nid_joueuse ‚Üí (code_pays, capitale)\nor code_pays ‚Üí capitale donc DF non directe\n\n\n\n\n\n\n\nTipPasser en 3NF\n\n\n\nCr√©er une table pays\n\njoueuse(id_joueuse, code_pays)\npays(code_pays, capitale)"
  },
  {
    "objectID": "doc/cours/formalisation.html#mod√©lisation-uml",
    "href": "doc/cours/formalisation.html#mod√©lisation-uml",
    "title": "Formalisation des bases de donn√©es",
    "section": "3 Mod√©lisation UML",
    "text": "3 Mod√©lisation UML\n\nUnified Modeling Language\n\n\n\n\n\n\nNoteD√©finition\n\n\n\nUML est un langage de mod√©lisation graphique standardis√© utilis√© pour sp√©cifier, visualiser, concevoir et documenter diff√©rents aspects des syst√®mes logiciels.\nIl offre une s√©rie de diagrammes pour repr√©senter diff√©rents aspects d‚Äôun syst√®me.\n\n\n\n\nMod√®les\n\n\nMod√®le conceptuel\n\n\n\n\n\nclassDiagram\n    class Joueuse {\n        identifiant\n        nom\n        prenom\n        elo\n        identifiant du club\n    }\n\n\n\n\n\n\n\nMod√®le physique\n\n\n\n\n\nclassDiagram\n    class joueuse {\n        id_joueuse SERIAL PK\n        nom        VARCHAR50\n        prenom     VARCHAR50\n        elo        INT\n        #id_club   INT\n    }\n\n\n\n\n\n\n\n\n\n\nConceptuel : niveau utilisateur (accents, espaces)\nPhysique : niveau d√©veloppeur (transposable directement en SQL)\n\n\n\n\nAssociations 1:n\n\n\n\n\n\nclassDiagram\n    direction LR\n    class joueuse {\n        id_joueuse SERIAL PK\n        nom        VARCHAR50\n        prenom     VARCHAR50\n        elo        INT\n        #id_club   INT\n    }\n    \n    class club {\n        id_club   SERIAL PK\n        nom       VARCHAR50\n        ville     VARCHAR50\n    }\n\n    joueuse \"*\" -- \"0..1\" club\n\n\n\n\n\n\ncf.¬†Cours BDD, partie associations\n\n\nAssociations multiples\n\n\n\n\n\nclassDiagram\n    direction LR\n    class joueuse {\n        id_joueuse SERIAL PK\n        nom        VARCHAR50\n        prenom     VARCHAR50\n        elo        INT\n        #id_club   INT\n    }\n    \n    class partie {\n        #id_blanc     INT\n        #id_noir      INT\n        #id_resultat  INT\n    }\n\n    partie \"*\" --&gt; \"1\" joueuse : jou√©e avec les blancs par ‚ñ∂\n    partie \"*\" --&gt; \"1\" joueuse : jou√©e avec les noirs par ‚ñ∂\n\n\n\n\n\n\n\n\nAssociations n:n\n\n\n\n\n\nclassDiagram\n    direction LR\n    class joueuse {\n        id_joueuse SERIAL PK\n        nom        VARCHAR50\n        prenom     VARCHAR50\n        elo        INT\n        #id_club   INT\n    }\n    \n    class participe {\n        #id_joueuse     INT\n        #id_tournoi     INT\n    }\n\n    class tournoi {\n        #id_tournoi     INT\n        nom             INT\n    }\n\n    joueuse \"1\" -- \"*\" participe\n    participe \"*\" -- \"1\" tournoi\n\n\n\n\n\n\n\n\nOutils\nDe nombreux outils existent pour faire des diagrammes UML, soit en mode graphique ou code, par exemple :\n\nhttps://app.diagrams.net/\nhttps://dbdiagram.io/d"
  },
  {
    "objectID": "doc/tp/tp4.html",
    "href": "doc/tp/tp4.html",
    "title": "Chess Unofficial Federation ‚ôï",
    "section": "",
    "text": "Important\n\n\n\n\n√âcrivez des requ√™tes jolies !"
  },
  {
    "objectID": "doc/tp/tp4.html#introduction",
    "href": "doc/tp/tp4.html#introduction",
    "title": "Chess Unofficial Federation ‚ôï",
    "section": "",
    "text": "Important\n\n\n\n\n√âcrivez des requ√™tes jolies !"
  },
  {
    "objectID": "doc/tp/tp4.html#lancement-des-services",
    "href": "doc/tp/tp4.html#lancement-des-services",
    "title": "Chess Unofficial Federation ‚ôï",
    "section": "1 Lancement des services",
    "text": "1 Lancement des services\nPour plus de d√©tails, allez dans l‚Äôonglet Datalab.\n\nConnectez-vous √† un Datalab\nLancez un service PostgreSQL\nLancez un service cloudBeaver\n\nouvrez ce service\nv√©rifiez que vous √™tes connect√©s √† la base de donn√©es PostgreSQL"
  },
  {
    "objectID": "doc/tp/tp4.html#les-donn√©es",
    "href": "doc/tp/tp4.html#les-donn√©es",
    "title": "Chess Unofficial Federation ‚ôï",
    "section": "2 Les donn√©es",
    "text": "2 Les donn√©es\n\n\n\n\n\n\nVotre mission du jour sera d‚Äôaider la nouvellement cr√©√©e F√©d√©ration Fran√ßaise des √âchecs Sinc√©res et Sans Subterfuges √† corriger les erreurs dans sa base de donn√©es pour ensuite r√©compenser ses meilleures joueuses.\n\n\n\n\n2.1 Chargez les donn√©es\n\nCopiez le contenu de ces 2 scripts sql\n\ncr√©ation des tables\ninsertion des donn√©es\n\nCollez-les dans la fen√™tre SQL de CloudBeaver\nEx√©cutez les scripts\n\nCliquez sur la petite icone sous les triangles oranges qui ressemble √† üìú\nraccourci (ALT + X)\n\n\n\n\n2.2 Description des tables\n\n\n\n\n\n\n\nCat√©gorie\nDescription\n\n\n\n\nJoueuse\nListe des joueuses\n\n\nTitre\nListe des titres, certains attribu√©s aux fortes joueuses\n\n\nClub\nListe des clubs\n\n\nPartie\nPartie entre 2 joueuses, soit libre, soit dans le cadre d‚Äôun tournoi\n\n\nR√©sultat_partie\nDiff√©rents r√©sultats possibles dans une partie (par exemple : victoire des blancs, match nul, etc.)\n\n\nOuverture\nD√©signation de l‚Äôouverture (comment d√©bute une partie)\n\n\nTournoi\nListe des tournois\n\n\nCadence\nRythme de jeu lors d‚Äôun tournoi (blitz, rapide, lent)\n\n\n\n\n\n2.3 Mod√®le de donn√©es\n\n\n\n\n\n\n\nCaution\n\n\n\nDans le mod√®le de donn√©es, certaines tables sont reli√©es 2 fois entre elles :\n\njoueuse et partie : car lors d‚Äôune partie une joueuse a les blancs et l‚Äôautre, les noirs\njoueuse et club :\n\nid_club est une cl√© √©trang√®re dans la table joueuse car une joueuse est membre d‚Äôun seul club\nid_presidente est une cl√© √©trang√®re de la table club r√©f√©ren√ßant l‚Äôid_joueuse de la pr√©sidente\n\n\n\n\nQuelques remarques sur ce sch√©ma :\n\nüîë cl√© primaire\n# cl√© √©trang√®re\nNN : NOT NULL\n\n\n\n2.4 Notation relationnelle\nLes tables sont les suivantes :\n\njoueuse(id_joueuse, code_titre, nom, prenom, elo, date_naissance, #id_club, arbitre)\ntitre(code, nom, description)\nclub(id_club, nom, ville, #id_presidente)\npartie(id_partie, #id_blanc, #id_noir, date_partie, #id_resultat, #id_ouverture, #id_tournoi)\nresultat_partie(id_resultat, resultat, description)\nouverture(id_ouverture, eco, nom, coups)\ntournoi(id_tournoi, nom, ville, date_debut, date_fin, #id_cadence, nb_rondes, nb_participantes, #id_arbitre)\ncadence(id_cadence, nom, description)"
  },
  {
    "objectID": "doc/tp/tp4.html#recherche-des-irr√©gularit√©s",
    "href": "doc/tp/tp4.html#recherche-des-irr√©gularit√©s",
    "title": "Chess Unofficial Federation ‚ôï",
    "section": "3 Recherche des irr√©gularit√©s",
    "text": "3 Recherche des irr√©gularit√©s\n\n\n\n\n\n\n√Ä la f√©d√©ration, il y a malheureusement de nombreuses rumeurs de corruption, et m√™me de dopage !\nVotre premi√®re mission sera de v√©rifier l‚Äôint√©grit√© des donn√©es de la base.\n\n\n\nIl para√Ætrait que certaines joueuses aient truqu√©es leurs classements elo. V√©rifiez et corrigez cela :\n\nListez la table des joueuses\nClassez par elo d√©croissant\n√âcrivez une requ√™te qui permet d‚Äôafficher les joueuses avec un elo suspect (elo &gt; 2600 et non titr√©e)\n\nNotez leurs id_joueuse\n\nPour chacune de ces joueuses, diminuez leur elo de 1200\nV√©rifier √† partir de leurs id_joueuse que la mise √† jour a bien √©t√© effectu√©e\n\nUne autre erreur concernerait les dates de naissances des joueuses\n\nAffichez l‚Äôann√©e de naissance des joueuses\nRegroupez par ann√©e et comptez le nombre d‚Äôoccurences\n√âcrivez une requ√™te pour ne garder que les joueuses avec des ann√©es de naissances √©tranges\nApportez une correction adapt√©e\n\nPassons maintenant √† la table des parties. √Ä votre avis, est-ce normal de jouer des parties contre soi-m√™me ?\n\nD√©tectez les parties suspectes\n√Ä partir de ces donn√©es, cr√©ez une table tricheuse pour pouvoir surveiller leurs agissements par la suite\nSupprimez les parties suspectes"
  },
  {
    "objectID": "doc/tp/tp4.html#√©lection-des-pr√©sidentes",
    "href": "doc/tp/tp4.html#√©lection-des-pr√©sidentes",
    "title": "Chess Unofficial Federation ‚ôï",
    "section": "4 √âlection des pr√©sidentes",
    "text": "4 √âlection des pr√©sidentes\n\n\n\n\n\n\nVous avez peut-√™tre remarqu√© que les clubs n‚Äôont pas de pr√©sidentes, nous allons donc organiser des √©lections sans triche !\nMais pour faire plus simple, la f√©d√© a d√©cid√© de nommer comme pr√©sidente de chaque club, sa joueuse ayant le plus faible elo.\n\n\n\n\nListez pour chaque club, ses joueuses\n\naffichez le nom du club, ainsi que tout le contenu de la table joueuse\n\nPour chaque club, trouvez le elo minimum\nStockez dans une table temporaire tous les couples (id_club, elo_minimum)\nTrouvez pour chaque club, la joueuse avec le plus petit elo\n\nen cas d‚Äô√©galit√©, prenez ensuite le plus petit id_joueuse\n\nStockez dans une table temporaire les couples (id_club, id_joueuse de la future pr√©sidente)\nMettez √† jour la table club avec leurs nouvelles pr√©sidentes\nListez les clubs et leurs pr√©sidentes"
  },
  {
    "objectID": "doc/tp/tp4.html#quelques-statistiques",
    "href": "doc/tp/tp4.html#quelques-statistiques",
    "title": "Chess Unofficial Federation ‚ôï",
    "section": "5 Quelques statistiques",
    "text": "5 Quelques statistiques\n\n\n\n\n\n\nRegardons maintenant quelques statistiques sur ces donn√©es.\n\n\n\n\nComptez le nombre de parties jou√©es\nAffichez le nombre de parties jou√©es par tournoi\n\naffichez le nom du tournoi\nincluez les parties jou√©es hors tournoi\n\nPour chaque tournoi, calculez √©galement les taux de victoire des blancs et des noirs, ainsi que celui de matchs nuls\n\n\n\n\n\n\n\nTip\n\n\n\n\n\n\nCommencez par exemple par calculer le nombre de victoires des blancs\nDivisez par le bon nombre\nPour avoir un float, vous pouvez multiplier par 1.0\nUtilisez ROUND() pour arrondir √† 2 chiffres significatifs\n\n\n\n\n\nCompl√©tez pour ne conserver que les tournois avec 20 % ou moins de matchs nuls\n\nLe but des questions suivantes va √™tre d‚Äôafficher le nombre de parties jou√©es en tournoi et hors tournoi.\nLe r√©sultat doit √™tre l‚Äôun des deux ci-dessous :\n\n\n\n\n\ntournoi\nnb_parties\n\n\n\n\nfalse\n10000\n\n\ntrue\n3610\n\n\n\n\n\n\n\nnb_parties_en_tournoi\nnb_parties_hors_tournoi\n\n\n\n\n3610\n10000\n\n\n\n\n\nAffichez ce r√©sultat avec une requ√™te utilisant :\n\nUNION\nCOALESCE(id_tournoi IS NOT NULL, false)\nCASE WHEN\nFILTER\n\nJetons maintenant un oeil aux ouvertures qui permettent de gagner plus souvent.\n\n\n\n\n\n\nNoteOuvertures\n\n\n\nEn d√©but de partie, le nombre de coups possibles et corrects reste assez limit√©. Les diff√©rentes possibilit√©s de commencer une partie sont cat√©goris√©es et appel√©es Ouvertures.\nVient ensuite le milieu de jeu lorsque toutes les pi√®ces sont d√©velopp√©es.\nEt enfin (si personne ne s‚Äôest pris un √©chec et mat) la finale, i.e.¬†lorsque les Dames ont √©t√© √©chang√©es et qu‚Äôil reste peu de pi√®ces.\n\n\n\nUne des ouvertures n‚Äôexiste pas, elle n‚Äôa √©t√© jou√©e dans aucune partie\n\nTrouvez et supprimez cette ouverture\n\nComme fait pr√©c√©demment pour les tournois, calculez pour chaque ouverture :\n\nnombre de parties jou√©es\ntaux de victoire des blancs\ntaux de victoire des noirs\ntaux de matchs nuls\n\nAffichez les joueuses ayant jou√© plus de 5 fois avec les pi√®ces noires la D√©fense Sicilienne"
  },
  {
    "objectID": "doc/tp/tp4.html#afficher-les-r√©sultats-de-parties",
    "href": "doc/tp/tp4.html#afficher-les-r√©sultats-de-parties",
    "title": "Chess Unofficial Federation ‚ôï",
    "section": "6 Afficher les r√©sultats de parties",
    "text": "6 Afficher les r√©sultats de parties\nLes r√©sultats de parties sont g√©n√©ralement affich√©s sous ce format :\n\nAix-les-Bains 2006\n\n\n\n\n\n\n\n\n\nBlancs\n\nR√©s\nNoirs\n\n\n\n\n\nPRZYMUSINSKI Nicolas\n2043\n0 - 1\nf GREGOIRE Sylvain\n2268\n\n\nMEYNARD Thibault\n2256\n1 - 0\nZERMICHE Cherif\n2035\n\n\nHOUARD Yannick\n2010\nX - X\nPEREZ Flavio\n2230\n\n\nCOULON Guillaume\n2001\n0 - 1\nJOLLY Jean-Francois\n2211\n\n\nFISCHER Marc\n2185\nX - X\nDENEUVILLE Ludovic\n2003\n\n\nMATHIS Julien\n1951\n0 - 1\nPIERONI Guillaume\n2170\n\n\nBOIZANTE Yvain\n2148\nX - X\nSAEZ Nicolas\n1998\n\n\n\n\n\n\n\n\n\nL‚Äôobjectif de cette partie est d‚Äôaboutir √† ce r√©sultat.\nVous noterez le f √† la premi√®re ligne qui est l‚Äô√©ventuel titre de la joueuse en minuscule.\n\n\n\n\nCommencez par joindre les tables contenant les √©l√©ments √† afficher\nEnsuite, gardez uniquement les colonnes n√©cessaires\nConcat√©nez titre, nom et pr√©nom, et renommez les colonnes pour obtenir l‚Äôaffichage demand√©\nAffichez les r√©sultat du Blitz √† Rennes (tournoi)\n\n\n\n\n\n\n\nEnfin nous souhaitons r√©compenser la meilleure performance.\nUne performance est une victoire contre une joueuse ayant au moins 400 points elo de plus.\n\n\n\n\nAffichez toutes les performances\nClassez-les par diff√©rence de elo d√©croissante\n\n\n\n\n\n\n\nUn paquet de üç™ est √† retirer dans le bureau du professeur pour la joueuse d√©tentrice de la meilleure perf !\nEt pour l‚Äôautrice de la plus belle contre-perf, notre partenaire premium, la F√©d√©ration Fran√ßaise de la Lose offre un magnifique tee-shirt floqu√© Reine des Mazettes, J‚Äôai rat√© un mat en 1, Je suis pass√© de +10 √† -10 ou encore J‚Äôai fait pat avec Roi et Dame contre Roi."
  },
  {
    "objectID": "doc/tp/tp4.html#gagnantes-des-tournois",
    "href": "doc/tp/tp4.html#gagnantes-des-tournois",
    "title": "Chess Unofficial Federation ‚ôï",
    "section": "7 Gagnantes des tournois",
    "text": "7 Gagnantes des tournois\nVia la table partie, il est possible de retrouver quelle joueuse a particip√© √† quel tournoi.\nCependant ce n‚Äôest pas tr√®s intuitif, ni pratique.\nNous allons donc commencer par cr√©er une vue des participantes\n\nListez les diff√©rents tournois auquels a particip√© HOU Yifan\nListez tous les diff√©rents couples (id_joueuse, id_tournoi) possibles et existants dans la table partie\nCr√©ez la vue participante(id_tournoi, id_joueuse)\n\nen y ins√©rant les donn√©es de la derni√®re requ√™te\n\nV√©rifiez que cette vue contient 980 enregistrements\n\n\n\n\n\n\n\nPour trouver les gagnantes des tournois, il faut trouver leurs nombres de points marqu√©s.\nUne c√©l√©bre citation dit ¬´ Je ne perds jamais, soit je gagne, soit j‚Äôapprends ¬ª.\nAux √©checs, la victoire rapporte 1 point, le match nul 0.5 et la d√©faite 0.\n\n\n\nCependant un probl√®me se pose : une seule ligne de la partie contient le nombre de points marqu√©s de 2 joueuses.\n\n\n\nid_partie\nid_blanc\nid_noir\nresultat\n\n\n\n\n1\n11\n22\n1 - 0\n\n\n2\n123\n99\nX - X\n\n\n\nPour calculer les points de chaque joueuse, ce serait plus pratique de dupliquer chaque ligne pour avoir :\n\n\n\nid_partie\nid_joueuse\nscore\n\n\n\n\n1\n11\n1\n\n\n1\n22\n0\n\n\n2\n123\n0.5\n\n\n2\n99\n0.5\n\n\n\n\nListez pour toutes les parties, le score des blancs (comme sur le tableau ci-dessus)\nIncluez √©galement pour la suite, les colonnes :\n\nid_tournoi\nle elo de l‚Äôadversaire\n\nFaites de m√™me pour les noirs et stockez le tout dans une vue partie_score\n\n\n\n\n\n\n\nTip\n\n\n\n\n\n\nVous pouvez utiliser une structure CASE WHEN THEN\n\nSELECT &lt;?&gt;,\n       CASE\n           WHEN &lt;?&gt; THEN &lt;?&gt; \n           WHEN &lt;?&gt; THEN &lt;?&gt;\n           ELSE &lt;?&gt;          \n       END AS score\n  FROM &lt;?&gt;\n\n\n\n\nV√©rifiez que pour toutes les parties, le score cumul√© des deux joueuses vaut 1\nAffichez le classement par points de l‚ÄôOpen de Guingamp\n\nVous remarquez qu‚Äôil y a des √©galit√©s au nombre de points.\n\nUtilisez la moyenne elo des adversaires pour d√©partager les ex √¶quo\n\nPlus la joueuse a affront√© d‚Äôautres joueuses fortes, mieux elle sera class√©e\n\n\n\n\n\n\n\n\nNoteV√©rification\n\n\n\n\n\nUne petite requ√™te basique pour v√©rifier vos r√©sultats :\nWITH resultat_score AS (\n    SELECT rp.*,\n           CASE\n               WHEN rp.resultat IN ('1 - 0', '1 - F') THEN 1 \n               WHEN rp.resultat = 'X - X'             THEN 0.5\n               ELSE 0\n           END AS score_blanc,\n           CASE\n               WHEN rp.resultat IN ('0 - 1', 'F - 1') THEN 1 \n               WHEN rp.resultat = 'X - X'             THEN 0.5\n               ELSE 0\n           END AS score_noir\n      FROM echecs.resultat_partie rp\n    ),\npartie_score AS (\n    SELECT p.id_partie,\n           p.id_tournoi,\n           UNNEST(ARRAY[id_blanc, id_noir]) AS id_joueuse,\n           UNNEST(ARRAY[score_blanc, score_noir]) AS score,\n           UNNEST(ARRAY[jn.elo, jb.elo]) AS elo_adversaire\n      FROM echecs.partie p\n      JOIN resultat_score USING(id_resultat)\n      JOIN echecs.joueuse jb ON (jb.id_joueuse = p.id_blanc)\n      JOIN echecs.joueuse jn ON (jn.id_joueuse = p.id_noir)\n    )\nSELECT CONCAT_WS(' ', LOWER(j.code_titre), j.nom, j.prenom) AS joueuse,\n       j.elo,\n       SUM(ps.score) AS points,\n       ROUND(AVG(ps.elo_adversaire)) AS moyenne_elo_adversaire\n  FROM echecs.joueuse j\n  JOIN partie_score ps USING(id_joueuse)\n  JOIN echecs.tournoi t USING(id_tournoi)\n WHERE t.nom = 'Open de Guingamp'\n GROUP BY j.id_joueuse,\n          joueuse,\n          j.elo\n ORDER BY points DESC,\n          moyenne_elo_adversaire DESC;\n\n\n\n\nCr√©ez une vue contenant le classement de chaque joueuse dans chaque tournoi\n\nincluez le nom du tournoi, de la joueuse, son nombre de points, la moyenne elo des adversaire\ncalculez son classement dans le tournoi (üí° voir RANK OVER PARTITION BY)\n\nAffichez la liste de toutes les gagnantes des tournois"
  },
  {
    "objectID": "doc/tp/tp4.html#qui-est-la-meilleure",
    "href": "doc/tp/tp4.html#qui-est-la-meilleure",
    "title": "Chess Unofficial Federation ‚ôï",
    "section": "8 Qui est la meilleure ?",
    "text": "8 Qui est la meilleure ?\n\n\n\n\n\n\nNous souhaitons calculer le pourcentage de points marqu√©s par chaque joueuse, ainsi que ses taux de victoires, matchs nuls et d√©faites.\n\n\n\nChoisissez une joueuse, par exemple Judith POLGAR\n\nEn utilisant une vue d√©j√† cr√©√©e, calculez son nombre de parties jou√©es et son nombre de points marqu√©s\nCalculez le ratio pour avoir son ratio de points par partie\nCalculez ses taux de victoires, matchs nuls et d√©faites\nAdaptez la requ√™te pour faire ces calculs pour toutes les joueuses\n\nclassez par ratio de points par partie d√©scroissant\n\n\n\n\n\n\n\n\nTipSolutions\n\n\n\n\n\n\nCorrection TP4"
  },
  {
    "objectID": "doc/tp/tp4.html#arr√™tez-vos-services",
    "href": "doc/tp/tp4.html#arr√™tez-vos-services",
    "title": "Chess Unofficial Federation ‚ôï",
    "section": "Arr√™tez vos services",
    "text": "Arr√™tez vos services\nC‚Äôest la fin du TP, vous pouvez maintenant sauvegarder votre travail et lib√©rer les ressources r√©serv√©es :\n\nCopiez-collez vos scripts SQL sur votre machine\nArr√™ter les services du Datalab"
  },
  {
    "objectID": "doc/tp/tp1.html",
    "href": "doc/tp/tp1.html",
    "title": "Premi√®res requ√™tes SQL ü¶Ü",
    "section": "",
    "text": "Vous allez r√©aliser ce TP sur un Datalab.\n\n\nConnectez-vous √† l‚Äôune des deux instances suivantes :\n\nDatalab SSPCloud de l‚ÄôINSEE\n\nen cr√©ant un compte avec votre mail prenom.nom@eleve.ensai.fr\nil est recommand√© d‚Äôutiliser en priorit√© le SSPCloud qui est plus stable\n\nDatalab du GENES\n\n\n\n\n\n\n\n\n\n\nImportantEn cas d‚Äôindisponibilit√© des Datalabs\n\n\n\n\n\nUniquement en cas d‚Äôindisponibilit√© des Datalabs, vous pouvez r√©aliser le TP directement sur la VM. Le logiciel DBeaver est install√©.\n\nLancez DBeaver\nOnglet Base de donn√©es ‚û°Ô∏è Nouvelle Connexion\n\nType de connexion : DuckDB\nSuivant\nPath : :memory:\nTerminer\n\nDans l‚Äôexplorer (√† gauche), clic droit sur la connexion que vous venez de cr√©er\n\nEditeur SQL ‚û°Ô∏è Script SQL (raccourci : F3)\n\n\nCela ouvre une fen√™tre dans laquelle vous pouvez saisir du SQL."
  },
  {
    "objectID": "doc/tp/tp1.html#introduction",
    "href": "doc/tp/tp1.html#introduction",
    "title": "Premi√®res requ√™tes SQL ü¶Ü",
    "section": "",
    "text": "Vous allez r√©aliser ce TP sur un Datalab.\n\n\nConnectez-vous √† l‚Äôune des deux instances suivantes :\n\nDatalab SSPCloud de l‚ÄôINSEE\n\nen cr√©ant un compte avec votre mail prenom.nom@eleve.ensai.fr\nil est recommand√© d‚Äôutiliser en priorit√© le SSPCloud qui est plus stable\n\nDatalab du GENES\n\n\n\n\n\n\n\n\n\n\nImportantEn cas d‚Äôindisponibilit√© des Datalabs\n\n\n\n\n\nUniquement en cas d‚Äôindisponibilit√© des Datalabs, vous pouvez r√©aliser le TP directement sur la VM. Le logiciel DBeaver est install√©.\n\nLancez DBeaver\nOnglet Base de donn√©es ‚û°Ô∏è Nouvelle Connexion\n\nType de connexion : DuckDB\nSuivant\nPath : :memory:\nTerminer\n\nDans l‚Äôexplorer (√† gauche), clic droit sur la connexion que vous venez de cr√©er\n\nEditeur SQL ‚û°Ô∏è Script SQL (raccourci : F3)\n\n\nCela ouvre une fen√™tre dans laquelle vous pouvez saisir du SQL."
  },
  {
    "objectID": "doc/tp/tp1.html#lancement-du-service",
    "href": "doc/tp/tp1.html#lancement-du-service",
    "title": "Premi√®res requ√™tes SQL ü¶Ü",
    "section": "1 Lancement du service",
    "text": "1 Lancement du service\n\nLancez le service CloudBeaver\n\nAllez dans Catalogue de services\nOnglet Databases\n\nOuvrez le service\n\nRenseignez username et password\n\n\n\n\n\n\n\n\nTipCloudBeaver\n\n\n\nCloudBeaver est une application web l√©g√®re d√©di√©e √† la gestion de bases de donn√©es. Elle permet de se connecter √† divers types de bases de donn√©es, qu‚Äôelles soient SQL, NoSQL ou h√©berg√©es dans le cloud, √† partir d‚Äôun seul point d‚Äôacc√®s via un navigateur. CloudBeaver facilite l‚Äôexploration, la modification et la visualisation des donn√©es sans n√©cessiter l‚Äôinstallation de logiciels locaux.\n\n\nPour ce premier TP, nous n‚Äôallons pas utiliser de base de donn√©es PostgreSQL. Nous allons simplement utiliser DuckDB pour lire des fichiers de donn√©es.\n\n\n\n\n\n\nTipDuckDB\n\n\n\nDuckDB est un moteur de base de donn√©es relationnelle con√ßu pour des analyses rapides et efficaces.\nDuckDB est id√©al pour les charges de travail analytiques en raison de sa simplicit√©, de sa rapidit√© et de son extensibilit√©, surtout pour traiter des fichiers volumineux localement.\n\n\n\n\n\n\n\nCaract√©ristique\nDescription\n\n\n\n\nSimplicit√©\nFonctionne sans serveur, int√©gr√© dans le processus h√¥te. Aucune d√©pendance externe pour la compilation ou l‚Äôex√©cution, simplifiant son d√©ploiement.\n\n\nRapidit√©\nOptimis√© pour l‚Äôanalytique (OLAP) avec un moteur d‚Äôex√©cution vectoris√© en colonnes, r√©duisant le temps de traitement pour les requ√™tes complexes.\n\n\nRichesse fonctionnelle\nSupporte des requ√™tes SQL complexes, fonctions de fen√™tre, index secondaires, et assure des garanties ACID gr√¢ce au contr√¥le de concurrence (MVCC).\n\n\nExtensibilit√©\nPermet l‚Äôajout de types de donn√©es, fonctions et formats de fichiers via des extensions (supporte Parquet, JSON, S3, HTTP(S)).\n\n\nGratuit et open-source\nLicence MIT, code source disponible et contributions ouvertes √† tous.\n\n\n\n\n\nNous allons cr√©er une base de donn√©es stock√©e en m√©moire vive. L‚Äôavantage est que c‚Äôest tr√®s rapide. L‚Äôinconv√©nient, c‚Äôest que rien ne sera sauvegard√©.\n\nCr√©ez une nouvelle connexion DuckDB\n\nEn haut √† gauche, cliquez sur le +, puis New connection\nS√©lectionner DuckDB\nDatabase : :memory:\nCliquez sur le bouton CREATE\n\nOuvrez un √©diteur SQL\n\nDans l‚Äôexplorer √† gauche, clic droit sur votre connexion DuckDB ‚û°Ô∏è SQL Editor\nvous pouvez maintenant saisir du code SQL\n\n\n\n\n\n\n\n\nCaution\n\n\n\nVotre connexion doit √™tre ouverte (rond vert).\nSi ce n‚Äôest pas le cas : clic droit &gt; Open.\nPuis r√©ouvrez une nouvelle fen√™tre SQL"
  },
  {
    "objectID": "doc/tp/tp1.html#les-pr√©noms",
    "href": "doc/tp/tp1.html#les-pr√©noms",
    "title": "Premi√®res requ√™tes SQL ü¶Ü",
    "section": "2 Les pr√©noms",
    "text": "2 Les pr√©noms\nLe fichier des pr√©noms contient des donn√©es sur les pr√©noms attribu√©s aux enfants n√©s en France depuis 1900. Ces donn√©es sont disponibles au niveau France et par d√©partement.\nDans ce TP, nous allons utiliser la version au format parquet.\n\n\n\n\n\n\nNoteFichier parquet\n\n\n\nLe format Parquet est un format de fichier de stockage de donn√©es optimis√© pour les syst√®mes de traitement analytique de grande √©chelle. Voici ses principales caract√©ristiques :\n\nStockage en colonnes : Parquet stocke les donn√©es par colonnes plut√¥t que par lignes, ce qui am√©liore l‚Äôefficacit√© de l‚Äôacc√®s aux donn√©es dans les charges de travail analytiques.\nCompression efficace : La compression par colonne permet un taux de compression moyen de 5 √† 10 fois par rapport aux formats CSV, voire plus pour de gros fichiers. Cela r√©duit significativement la taille des donn√©es stock√©es et le co√ªt de stockage.\nOptimis√© pour l‚Äôanalytique : Parquet est con√ßu pour les requ√™tes en lecture intensive, car il permet de charger uniquement les colonnes n√©cessaires pour une analyse, ce qui am√©liore les performances en particulier sur les donn√©es volumineuses.\nM√©tadonn√©es Riches et Auto-descriptives : Parquet inclut des m√©tadonn√©es d√©taill√©es (sch√©ma, types de donn√©es, statistiques min/max), permettant une lecture rapide et sans risque d‚Äôerreur. Ces m√©tadonn√©es facilitent √©galement le traitement des donn√©es par diff√©rents outils.\nLangage Ind√©pendant et Open Source : Le format Parquet est ind√©pendant du langage et peut √™tre utilis√© avec divers langages de programmation (Python, R, C++, Java). Il est aussi open source et compatible avec la plupart des frameworks de big data.\n\n\n\nPour en savoir plus sur le format Parquet :\n\nParquet, qu‚Äôest-ce que c‚Äôest ?, Databricks\nWhat is the Parquet File Format?, Upsolver blog\n\nPour des requ√™tes plus rapides, nous allons forcer le t√©l√©chargement en cache du fichier\n\nEx√©cutez SET force_download=true;\n\nIci le fichier est relativement modeste (10 Mo), nous pouvons nous permettre de le stocker int√©gralement en m√©moire.\n\nCr√©ez une table prenoms √† partir du contenu du fichier\n\nCREATE OR REPLACE TABLE prenoms AS\nFROM 'https://www.insee.fr/fr/statistiques/fichier/8595130/prenoms-2024.parquet'\nVous pourrez ensuite requ√™ter sur cette vue comme si c‚Äô√©tait une table.\n\n\n\n\n\n\nTip√âx√©cuter une requ√™te\n\n\n\nCliquez sur la requ√™te pour y positionner le pointeur de la souris, puis au choix :\n\nCliquez sur le petit triangle orange\nCTRL + ENTREE\n\n\n\n\n2.1 Premi√®res requ√™tes\n\n\n\n\n\n\nImportant\n\n\n\nPrenez le temps et l‚Äôhabitude d‚Äô√©crire de jolies requ√™tes bien align√©es !!!\n\n\nbien.sql\n\nSELECT c.nom AS club, \n       AVG(j.elo) AS moyenne_elo\n  FROM joueuse j \n INNER JOIN club c USING (id_club) \n WHERE j.mail IS NOT NULL \n GROUP BY c.nom \n ORDER BY 2 DESC;\n\n\n\n\npasbien.sql\n\nSELECT c.nom AS club, AVG(j.elo) AS moyenne_elo FROM joueuse j INNER JOIN club c USING (id_club) WHERE mail IS NOT NULL GROUP BY c.nom ORDER BY 2 DESC;\n\n\n\n\nListez tous les √©l√©ments de prenoms\nFiltrez pour n‚Äôafficher que le niveau g√©ographique FRANCE et le pr√©nom GINETTE\n\n\n\n\n\n\n\nTipSecret statistique\n\n\n\nVous remarquerez que les valeurs sont des multiples de 5.\n\nPour chaque pr√©nom, il est indiqu√©, pour chaque ann√©e de naissance et chaque sexe, le nombre de personnes inscrites √† l‚Äô√©tat civil sous ce pr√©nom, arrondi au multiple de 5 le plus proche\n\nVous remarquerez √©galement que certaines ann√©es sont manquantes.\n\nUn pr√©nom est diffus√© s‚Äôil a √©t√© attribu√© au moins 3 fois √† des personnes de sexe f√©minin ou √† des personnes de sexe masculin\n\nEn statistique publique, on exige au moins 3 individus pour garantir le secret statistique. Avec 1 ou 2 personnes, on peut identifier ou d√©duire leurs donn√©es.\n\n\nPour la suite du TP, nous allons uniquement nous interesser au niveau g√©ographique FRANCE :\n\n√Ä partir de la table prenoms, cr√©ez une table prenoms_fr conservant uniquement\n\nles lignes o√π le niveau g√©ographique est √©gal √† FRANCE\nles colonnes suivantes : sexe, prenom, periode, valeur\n\nCombien de lignes contient cette table ?\n\n\n\n2.2 Ann√©e 2022\n\nFiltrez sur l‚Äôann√©e 2022\n\n\nListez les pr√©noms de l‚Äôann√©e 2022\n\nClassez-les en d√©croissant par le nombre de fois o√π ils ont √©t√© donn√©s\n\nAffichez uniquement les colonnes sexe, prenom et valeur\n\nAffichez √©galement ces colonnes pour les questions suivantes\n\nListez les pr√©noms de l‚Äôann√©e 2022 donn√©s 2000 fois ou plus\nClassez-les d‚Äôabord par sexe, puis par nombre d√©croissant d‚Äôoccurrences\n\nQuels sont les pr√©noms masculins et f√©minins les plus donn√©s ?\n\nListez les pr√©noms f√©minins commen√ßant par la lettre Q\nListez les pr√©noms contenant exactement deux fois la lettre V\nComptez le nombre de pr√©noms commen√ßant par chaque lettre\n\n\n\n\n\n\n\nTip\n\n\n\nPour extraire la premi√®re lettre d‚Äôun pr√©nom, vous pouvez utiliser :\n\nla fonction SUBSTRING\nle slicing comme en R ou Python\n\n\n\n\nBonus : Comptez le nombre de pr√©noms commen√ßant par chaque lettre en diff√©renciant filles et gar√ßons\n\n\n\n2.3 Statistiques descriptives\n\nLancez la commande SUMMARIZE prenoms; pour avoir quelques stats sur la table\nAffichez pour l‚Äôann√©e 2003, les pr√©noms et leurs nombres de caract√®res\n\nTrouvez une fonction ad√©quate\n\nAffichez le nombres de caract√®res minimum, maximum et moyen parmi les pr√©noms de 2003\nListez les 3 pr√©noms de 2003 ayant le nombre de caract√®res maximum\n\nCommencez par √©crire une requ√™te donnant le nombre de caract√®res maximum\nUtilisez-l√† comme sous-requ√™te pour afficher les 3 pr√©noms\n\nModifiez cette derni√®re requ√™te pour afficher pour chaque ann√©e entre 2015 et 2022 le ou les pr√©noms avec le plus de caract√®res\n\nclassez par ann√©e\nDifficulty : ‚≠ê ‚≠ê ‚≠ê\n\nAffichez pour chaque ann√©e la taille moyenne des pr√©noms\n\nclassez par ann√©e\nutilisez la fonction ROUND(&lt;value&gt;, 2) pour arrondir les moyennes\nQue remarquez-vous ?\n\n\n\n\n2.4 J√©r√¥me, c‚Äôest moi\n\nListez les diff√©rentes ann√©es o√π le pr√©nom J√âR√îME a √©t√© donn√©\n\nClassez par ann√©e d√©croissante\nQue remarquez-vous ?\n\nQuelles sont les diff√©rentes mani√®res d‚Äô√©crire ce pr√©nom (avec des accents diff√©rents) ?\nListez √©galement les JEROME avec d‚Äôautres accents / sans accent\n\nRecherchez une fonction DuckDB qui permet de r√©pondre √† ce besoin\n\nAffichez pour chaque ann√©e le nombre de fois o√π le pr√©nom JEROME a √©t√© donn√©, quelle que soit l‚Äôaccentuation\n\n\n\n\n\n\n\nTipAide\n\n\n\n\n\n\nvoir Fonction DuckDB strip_accents()\nRegroupez par strip_accents(prenom) et periode\nAffichez strip_accents(prenom), periode et la somme de la colonne valeur\n\n\n\n\n\n\n2.5 V√©rifions le classement\nAvec cette histoire d‚Äôaccents, posons-nous la question si cela peut modifier le classement des top pr√©noms.\n\nAffichez le top 10 des pr√©noms f√©minins en 2023 ?\nQuel pr√©nom se classe onzi√®me ?\n\nY-a-t-il d‚Äôautres orthographes proches pour √©crire ce pr√©nom ?\n\nRefaites le classement en ignorant les accents\n\n\n\n2.6 Pr√©noms compos√©s\nNous allons maintenant nous interesser aux pr√©noms compos√©s entre 2000 et 2009\n\nListez les diff√©rents pr√©noms compos√©s donn√©s entre les ann√©es 2000 et 2009 incluses\nRegroupez-les par prenom, puis affichez √©galement le nombre de fois o√π ils ont √©t√© donn√©s\n\nTriez en d√©croissant par ce nombre\n\nFiltrez pour ne garder que les pr√©noms compos√©s contenant le pr√©nom JEAN\n\nQue remarquez-vous ? N‚Äôy a-t-il pas des intrus ?\n\nTrouvez une solution pour rem√©dier √† ce souci\n\n\n\n2.7 Cette ann√©e-l√†\nDifficulty : ‚≠ê ‚≠ê ‚≠ê\n\nFiltrez sur l‚Äôann√©e 1962.\n\n\nComptez le nombre de pr√©noms distincts donn√©s\nCompl√©tez en comptant le nombre de pr√©noms distincts donn√©s par sexe\nCompl√©tez en calculant le nombre total des pr√©noms distincts donn√©s, en prenant en compte la distinction entre les sexes\n\nexemple : ici Dominique (H) et Dominique (F) comptent pour deux pr√©noms\n\nDonnez la liste des pr√©noms donn√©s √† la fois √† des filles et des gar√ßons\n\naffichez le nombre de fois o√π ils ont √©t√© donn√©s √† chaque sexe\n\nAjoutez √† la derni√®re requ√™te une colonne contenant un bool√©en qui affiche\n\nTrue si le pr√©nom a √©t√© donn√© √† plus de filles que de gar√ßons\nFalse sinon\n\nAu lieu d‚Äôafficher ce bool√©en, ajoutez une condition pour n‚Äôafficher que lorsque le pr√©nom a √©t√© plus donn√© √† des filles"
  },
  {
    "objectID": "doc/tp/tp1.html#fichier-des-individus",
    "href": "doc/tp/tp1.html#fichier-des-individus",
    "title": "Premi√®res requ√™tes SQL ü¶Ü",
    "section": "3 Fichier des individus",
    "text": "3 Fichier des individus\n\nCr√©ez une vue qui pointe vers le fichier des individus du recensement de la population 2020\n\nCREATE OR REPLACE VIEW individus AS\nFROM 'https://static.data.gouv.fr/resources/recensement-de-la-population-fichiers-detail-individus-localises-au-canton-ou-ville-2020-1/20231023-122841/fd-indcvi-2020.parquet';\n\nComptez le nombre d‚Äôindividus\n\nPourquoi ce nombre d‚Äôindividus vivant en France para√Æt faible ?\n\n\n\n\n\n\n\n\nTipPoids de l‚Äôindividu\n\n\n\nDans de nombreuses bases de donn√©es de l‚ÄôINSEE, la variable ipondi repr√©sente le poids de l‚Äôindividu.\ni.e.¬†Si une ligne a un IPONDI √©gal √† 2, cela signifie qu‚Äôelle repr√©sente 2 individus.\n\n\n\nAu lieu de compter le nombre de lignes, sommez la variable ipondi\n\nVous pouvez suffixer votre somme par ::INT pour convertir ce nombre en entier\n\nAffichez 10 lignes\n\nQue remarquez-vous ?\n\n\n\n\n\n\n\n\nNoteCodification\n\n\n\nPourquoi utiliser une codification pour le fichier national individus localis√©s au canton-ou-ville du recensement de la population 2020 ?\n\nEspace de stockage r√©duit : Les codes courts remplacent des cha√Ænes de texte plus longues, ce qui diminue la taille du fichier et rend le stockage et le transfert de donn√©es plus efficaces. M√™me apr√®s codification, le fichier p√®se plus de 500 Mo\nStandardisation et uniformit√© : Utiliser des codes standardis√©s permet de garantir une structure homog√®ne et facilite l‚Äôint√©gration et la comparaison des donn√©es entre diff√©rents fichiers ou √©tudes.\nPerformances de traitement : Les codes sont plus rapides √† traiter que des textes longs, notamment pour des op√©rations de recherche, de tri, et de filtrage, ce qui est crucial pour les grands ensembles de donn√©es.\n\n\n\n\nPour s‚Äôy retrouver, cr√©ez une vue vers le dictionnaire des variables\n\nCREATE OR REPLACE VIEW variables_individus AS\nFROM 'https://static.data.gouv.fr/resources/recensement-de-la-population-fichiers-detail-individus-localises-au-canton-ou-ville-2020-1/20231025-082910/dictionnaire-variables-indcvi-2020.csv'\n\nAffichez tout le contenu de cette vue\nTrouvez la modalit√© repr√©sentant le d√©partement de r√©sidence de l‚Äôindividu\nAffichez le nombre d‚Äôhabitants par d√©partements\n\nordonnez par num√©ro de d√©partement\n\nCompl√©tez la requ√™te en :\n\nrestreignant sur les individus entre 25 et 29 ans\ndiff√©renciant les hommes et les femmes\n\n\n\n\n\n\n\n\nTipSolutions\n\n\n\n\n\n\nCorrection TP1"
  },
  {
    "objectID": "doc/tp/tp1.html#arr√™tez-votre-service",
    "href": "doc/tp/tp1.html#arr√™tez-votre-service",
    "title": "Premi√®res requ√™tes SQL ü¶Ü",
    "section": "Arr√™tez votre service",
    "text": "Arr√™tez votre service\nC‚Äôest la fin du TP, vous pouvez maintenant sauvegarder votre travail et lib√©rer les ressources r√©serv√©es :\n\nCopiez votre code et collez le sur votre machine dans un fichier .sql\n\npar exemple dans P:/Cours1A/UE3-Bases-de-donnees-relationnelles/TP1/tp1.sql\n\nRetournez sur la page d‚Äôaccueil du Datalab\nAllez dans Mes Services et supprimez votre service"
  },
  {
    "objectID": "doc/tp/tp1.html#pour-aller-plus-loin",
    "href": "doc/tp/tp1.html#pour-aller-plus-loin",
    "title": "Premi√®res requ√™tes SQL ü¶Ü",
    "section": "Pour aller plus loin",
    "text": "Pour aller plus loin\n\n3 explorations bluffantes avec DuckDB\nAvec DuckDB, gavez-vous d‚Äôopen data!\nDuckDB, un aper√ßu du futur !"
  },
  {
    "objectID": "doc/tp/tp3.html",
    "href": "doc/tp/tp3.html",
    "title": "Discographie üéµ",
    "section": "",
    "text": "Important\n\n\n\n\n√âcrivez des requ√™tes jolies !\n√Ä la fin du TP, exportez ou copiez vos requ√™tes dans un fichier de votre VM ou machine personnelle\n\n\n\nLes notions vues dans ce TP :\n\nagr√©gations\njointures\ninsertion de donn√©es\nutilisation de s√©quence\nbonus : CTE (vu au dernier cours)"
  },
  {
    "objectID": "doc/tp/tp3.html#introduction",
    "href": "doc/tp/tp3.html#introduction",
    "title": "Discographie üéµ",
    "section": "",
    "text": "Important\n\n\n\n\n√âcrivez des requ√™tes jolies !\n√Ä la fin du TP, exportez ou copiez vos requ√™tes dans un fichier de votre VM ou machine personnelle\n\n\n\nLes notions vues dans ce TP :\n\nagr√©gations\njointures\ninsertion de donn√©es\nutilisation de s√©quence\nbonus : CTE (vu au dernier cours)"
  },
  {
    "objectID": "doc/tp/tp3.html#lancement-des-services",
    "href": "doc/tp/tp3.html#lancement-des-services",
    "title": "Discographie üéµ",
    "section": "1 Lancement des services",
    "text": "1 Lancement des services\nPour plus de d√©tails, allez dans l‚Äôonglet Datalab.\n\nConnectez-vous √† un Datalab\nLancez un service PostgreSQL\nLancez un service cloudBeaver\n\nouvrez ce service\nv√©rifiez que vous √™tes connect√©s √† la base de donn√©es PostgreSQL"
  },
  {
    "objectID": "doc/tp/tp3.html#les-donn√©es",
    "href": "doc/tp/tp3.html#les-donn√©es",
    "title": "Discographie üéµ",
    "section": "2 Les donn√©es",
    "text": "2 Les donn√©es\nLe th√®me du jour sera la musique üéµ üé∏ üé∫\n\n2.1 Chargez les donn√©es\n\nCopiez le contenu de ces 2 scripts sql\n\ncr√©ation des tables\ninsertion des donn√©es\n\nCollez-les dans la fen√™tre SQL de CloudBeaver\nEx√©cutez les scripts\n\nCliquez sur la petite icone sous les triangles oranges qui ressemble √† üìú\nraccourci (ALT + X)\n\n\n\n\n2.2 Description\nLes tables sont les suivantes :\n\nartiste(id_artiste, nom, code_pays, date_naissance, actif)\nalbum(id_album, titre, annee, #id_artiste)\nchanson(id_chanson, #id_artiste_principal, titre, duree, #id_album, annee)\nplaylist(id_playlist, nom, date_creation, description)\nplaylist_chanson(#id_playlist, #id_chanson, ordre, date_ajout)\n\n\n\n2.3 Mod√®le de donn√©es"
  },
  {
    "objectID": "doc/tp/tp3.html#exercice",
    "href": "doc/tp/tp3.html#exercice",
    "title": "Discographie üéµ",
    "section": "3 Exercice",
    "text": "3 Exercice\n\n3.1 Exploration des tables\nLorsque vous prenez en main une base de donn√©es, la premi√®re chose √† faire est de regarder ce que contiennent les tables.\n\nListez toutes les chansons\nAffichez les colonnes titre et ann√©e ainsi que le nom de l‚Äôartiste principal\nOrdonnez par nom d‚Äôartiste, puis par titre\nAjoutez le titre de l‚Äôalbum si celui-ci est pr√©cis√©\nAjoutez le nom de l‚Äôartiste de l‚Äôalbum\nEst-ce qu‚Äôil y a des chansons o√π il y a une diff√©rence entre :\n\nl‚Äôartiste principal de la chanson\nl‚Äôartiste de l‚Äôalbum qui contient cette chanson\n\n\nFaisons quelques statistiques descriptives.\n\nQuelle sont les dur√©es minimum, maximum et moyenne des chansons\nAffichez le nombre de chansons par ann√©e\n\nordonnez par nombre de chansons d√©croissant\n\nQuelles sont les ann√©es avec au moins 10 chansons\nCompl√©tez la derni√®re requ√™te en ajoutant la dur√©e moyenne des chansons pour chaque ann√©e\n\nEst-ce qu‚Äôil y a plusieurs chansons ayant le m√™me titre ?\n\nPour chaque titre de chanson, comptez le nombre d‚Äôoccurences\nEst-ce qu‚Äôil y a des titres de chansons pr√©sents au moins deux fois ?\nEst-ce qu‚Äôil y a des chansons en doublon ?\n\ni.e.¬†m√™me titre et m√™me artiste\n\n\nSi vous en trouvez une, essayez de la supprimer. √Ä votre avis, pourquoi cela ne fonctionne pas ?\n\nCr√©ez une vue titre_frequent listant les titres des chansons pr√©sents au moins deux fois ?\nPour ces titres, affichez tous les d√©tails des chansons, ainsi que l‚Äôartiste principal\n\ntriez par titre\n\n\n\n\n3.2 Place aux artistes\n\nListez les noms d‚Äôartistes ainsi que les titres de leurs chansons\nComptez le nombre de chansons par artiste\nClassez par ordre d√©croissant\nConservez uniquement les artistes ayant 20 chansons ou plus\n\nIl y a des artistes solo et des groupes. Pour les groupe la date de naissance ne devrait pas √™tre renseign√©e.\n\nMettez √† jour la table pour supprimer les dates de naissance des groupes\n\nüò± si vous avez fait une b√©tise, pas de panique, il faut relancer les deux scripts du d√©but de TP (create and pop)\n\nQuel est le plus viel artiste solo en activit√© ?\n\nInteressons nous maintenant aux pays des artistes.\n\nComptez le nombre d‚Äôartistes par pays\n\n\n\n3.3 Cr√©ez votre playlist\n\nIns√©rez une nouvelle ligne dans la table playlist\nAjoutez 5 chansons dans votre playlist\n\n\n\n\n\n\n\nTip\n\n\n\nAucune de ces chansons ne correspond √† vos go√ªt musicaux‚Ä¶\nVous √™tes vraiment s√ªr ?\nAllez un petit effort, il y a des chansons et des artistes tr√®s sympas.\n\n\nNous allons maintenant ajouter √† votre playlist toutes les chansons de l‚Äôalbum Californian Soil.\nPour cr√©er votre requ√™te d‚Äôinsertion, vous allez avoir besoin des donn√©es suivantes :\n\nid_playlist : vous pouvez soit :\n\nins√©rer la valeur ‚Äúen dur‚Äù\nutiliser CURRVAL('playlist_id_playlist_seq') pour obtenir la derni√®re valeur de id_playlist i.e.¬†celui de la playlist que vous venez de cr√©er\n\nid_chanson : il va falloir une req√ªete pour les r√©cup√©rer\nordre : vous allez cr√©er et utiliser une s√©quence\ndate_ajout : vous utiliserez simplement : CURRENT_DATE\n\n\n\nCr√©ez une s√©quence nomm√©e seq_playlist_ordre\n\ncomme vous avez d√©j√† ins√©r√© 5 chansons, les valeurs de la colonne ordre de 1 √† 5 sont normalement d√©j√† prises\ncommencez votre s√©quence √† la valeur 6\n\nListez toutes les chansons de l‚Äôalbum Californian Soil\nIns√©rer dans votre playlist toutes les chansons de l‚Äôalbum Californian Soil\n\n\n\n\n\n\n\nTipUn peu d‚Äôaide\n\n\n\n\n\nPour trouver un peu d‚Äôinspiration, un exemple d‚ÄôINSERT en utilisant un SELECT :\nINSERT INTO joueuse_copy(nom, prenom, numero, date_creation)\nSELECT nom,\n       'pierre',\n       nextval('seq_numero'),\n       CURRENT_DATE\n  FROM joueuse;\n\n\n\nEst-ce que vous pouvez ajouter plusieurs fois la m√™me chanson dans une playlist ? Pourquoi ?\nComment pourrait-t-on faire pour s‚Äôaffranchir de cette contrainte ?\n\n\n3.4 Votez pour la meilleure playlist\nInteressons-nous maintenant aux playlists.\n\nAffichez les playlists\nAjoutez les titres des chansons de la playlist\n\nColonnes √† afficher : nom de la playlist, ordre, titre de la chanson\nClassez par noms de playlists, puis ordre\n\nAjoutez les noms des artistes\n\nVous remarquez qu‚Äô√† l‚Äôaffichage vous avez deux colonnes appel√©es ‚Äúnom‚Äù. Pour faire la diff√©rence, vous allez modifier l‚Äôaffichage de ces colonnes.\n\nModifiez le SELECT pour afficher les ent√™tes de colonnes Nom de la playlist, Titre de la chanson et Nom de l‚Äôartiste\n\n\n\nQuelle playlist a le plus de chansons ?\nQuelle playlist dure le plus longtemps ?\n\nNous allons maintenant rechercher les artistes mal-aim√©s i.e.¬†ceux qui ne sont dans aucune playlist.\nProc√©dons par √©tape:\n\nListez les artistes pr√©sents dans les playlists\nEnsuite, gardez uniquement les id_artiste sans doublons\nAffichez les artistes qui ne sont pr√©sents dans aucune playlist\n\nen utilisant NOT IN et une sous-requ√™te\nconservez uniquement les id_artiste qui ne sont pas dans la requ√™te pr√©c√©dente\n\nM√™me question avec NOT EXISTS\n\nla syntaxe est un peu moins intuitive mais la requ√™te est plus optimis√©e\n\n\nConcentrons-nous maintenant sur les artistes et les chansons les plus populaires.\nVous avez √©crit pr√©c√©demment une requ√™te listant les playlists avec les artistes et les chansons. Repartez de cette requ√™te.\n\nComptez combien de fois chaque chanson apparait dans une playlist\n\naffichez le titre de la chanson, le nom de l‚Äôartiste, et le nombre de playlists\nordonnez par nombre de playlists d√©croissant\n\nAu lieu de faire un simple JOIN avec la table playlist_chanson, faites un LEFT JOIN\n\nEst-ce que ¬´ Tu feras la diff√©rence. Ton coeur prend des vacances. Il danse avec les loups. ¬ª ?\n\nConservez uniquement celles qui apparaissent dans au moins 3 playlists\nCombien y-a-t-il de chansons dans toutes les playlists\nCombien y-a-t-il de chansons diff√©rentes dans toutes les playlists\n\n\n\n3.5 I‚Äôm WITH u\nLes CTE seront √©voqu√©es au dernier cours. Cela parait compliqu√© √† premi√®re vue mais le principe est tr√®s simple.\n\n\n\n\n\n\nNoteCTE\n\n\n\nUne CTE (Common Table Expression) est une table temporaire nomm√©e d√©finie au d√©but d‚Äôune requ√™te avec le mot-cl√© WITH.\n√Ä quoi √ßa sert ?\n\nRendre une requ√™te plus lisible (au lieu d‚Äôimbriquer des sous-requ√™tes)\nR√©utiliser un m√™me sous-r√©sultat plusieurs fois\nServir de base √† des requ√™tes r√©cursives\n\n\n\nQue fait cette requ√™te ?\nSELECT DISTINCT ON (code_pays) code_pays, \n       nom, \n       date_naissance\n  FROM music.artiste\n WHERE NOT groupe\n ORDER BY code_pays, \n          date_naissance ASC;\nNous allons ici construire pas √† pas une requ√™te donnant le m√™me r√©sultat en utilisant une CTE.\n\nListez les artistes qui ne sont pas des groupes\nAffichez pour chaque pays, la plus ancienne date de naissance (celle du plus vieil artiste)\n\nNous souhaitons maintenant r√©cup√©rer le nom du plus viel artiste de chaque pays.\nL‚Äôid√©e pour obtenir ce nom :\n\nstocker le r√©sultat de notre derni√®re requ√™te dans une table temporaire viel_artiste_pays\njoindre cette table √† la table artiste via les colonnes pays et date_naissance\n\nWITH viel_artiste_pays AS (\n...\n)\nSELECT ...\n  FROM ...\n  JOIN viel_artiste_pays pv ON ...\n  ...\n\nEn compl√©tant la requ√™te √† trous ci-dessus, donnez pour chaque pays l‚Äôartiste le plus vieux\n\n\n\n\n\n\n\nTipAutre exemple\n\n\n\nPour vous aider, voici un autre exemple.\nSi l‚Äôon veut les noms des artistes qui sont les seuls √† repr√©senter leur pays :\n\nnous commen√ßons par lister les pays avec un seul artiste\nnous joignons avec la table artiste pour r√©cup√©rer dans un second temps les noms\n\nWITH artiste_seul_dans_pays AS (\nSELECT code_pays,\n       COUNT(*) AS nb_artistes\n  FROM artiste\n GROUP BY code_pays\nHAVING COUNT(*) = 1\n)\nSELECT a.*\n  FROM artiste a\n  JOIN artiste_seul_dans_pays n ON a.code_pays = n.code_pays;\n\n\n\n\n\n\n\n\nTipSolutions\n\n\n\n\n\n\nCorrection TP3"
  },
  {
    "objectID": "doc/tp/tp3.html#arr√™tez-vos-services",
    "href": "doc/tp/tp3.html#arr√™tez-vos-services",
    "title": "Discographie üéµ",
    "section": "Arr√™tez vos services",
    "text": "Arr√™tez vos services\nC‚Äôest la fin du TP, vous pouvez maintenant sauvegarder votre travail et lib√©rer les ressources r√©serv√©es :\n\nCopiez-collez vos scripts SQL sur votre machine\nArr√™ter les services du Datalab"
  },
  {
    "objectID": "doc/outils/vm.html",
    "href": "doc/outils/vm.html",
    "title": "VM ENSAI",
    "section": "",
    "text": "Important\n\n\n\nLes TP peuvent √™tre effectu√©s sur la VM uniquement en cas d‚Äôindisponibilit√© des datalabs.\n\n\nSur la VM ENSAI, vous avez √† votre disposition :\n\nune base de donn√©es PostgreSQL\nle logiciel DBeaver"
  },
  {
    "objectID": "doc/outils/vm.html#introduction",
    "href": "doc/outils/vm.html#introduction",
    "title": "VM ENSAI",
    "section": "",
    "text": "Important\n\n\n\nLes TP peuvent √™tre effectu√©s sur la VM uniquement en cas d‚Äôindisponibilit√© des datalabs.\n\n\nSur la VM ENSAI, vous avez √† votre disposition :\n\nune base de donn√©es PostgreSQL\nle logiciel DBeaver"
  },
  {
    "objectID": "doc/outils/vm.html#base-de-donn√©es-postgresql",
    "href": "doc/outils/vm.html#base-de-donn√©es-postgresql",
    "title": "VM ENSAI",
    "section": "2 Base de donn√©es PostgreSQL",
    "text": "2 Base de donn√©es PostgreSQL\nUne base de donn√©es est d√©j√† cr√©√©e pour vous sur un serveur d√©di√© :\n\nHost : sgbd-eleves.domensai.ecole\nPort : 5432\nDatabase : idxxxx\nNom d‚Äôutilisateur : idxxxx\nMot de passe : idxxxx"
  },
  {
    "objectID": "doc/outils/vm.html#dbeaver",
    "href": "doc/outils/vm.html#dbeaver",
    "title": "VM ENSAI",
    "section": "3 DBeaver",
    "text": "3 DBeaver\nDBeaver va vous permettre de vous connecter √† cette base de donn√©es et lancer des requ√™tes SQL.\n\nOuvrez le logiciel DBeaver\n\nil est d√©j√† install√©\n\n\n\n3.1 Param√®trage\nCommen√ßons par modifier quelques param√©tres par d√©faut qui vous faciliterons la vie.\n\nAllez dans le menu Fen√™tre ‚û°Ô∏è Preference\n\nUtilisez la fonction de recherche pour acc√©der aux sections suivantes :\n\nAllez dans la section Formattage SQL\n\nCasse des mots clefs : UPPER\nInsert spaces for tabs\nAppliquer\n\nAllez dans Metadonn√©es\n\nOuvrir une connexion s√©par√©e pour la lecture des m√©tadonn√©es : NEVER\n\nAllez dans Editeur SQL\n\nOuvrir une connexion s√©par√©e pour chaque √©diteur : NEVER\n\nAppliquer et Fermer\n\n\n\n3.2 Connexion PostgreSQL\nCr√©ons maintenant la connexion vers la base de donn√©es\n\nCr√©ez une nouvelle connexion\n\nMenu Base de donn√©es ‚û°Ô∏è Nouvelle connexion\n\nS√©lectionnez PostgreSQL puis suivant\nRenseignez les param√®ters de connexion (Host, Port, Database, Username, Password)\n\nvoir section PostgreSQL ci-dessus pour les valeurs √† saisir\n\nTestez la connexion\nAcceptez les mises √† jour des pilotes\nCliquez sur Terminer\n\nLa connexion apparait alors dans votre explorer √† gauche.\n\nOuvrez la connexion\n\nclic droit sur la connexion ‚û°Ô∏è Se connecter\n\nOuvrez une fen√™tre SQL\n\nclic droit ‚û°Ô∏è Editeur SQL ‚û°Ô∏è Nouveau script\n\n\nVous pouvez lancer quelques requ√™tes simples pour v√©rifier que tout fonctionne.\nSELECT 1;\n\nSELECT NOW();\n\nSELECT current_database();\n\nSELECT version();"
  },
  {
    "objectID": "doc/outils/tp-datalab-correction.html",
    "href": "doc/outils/tp-datalab-correction.html",
    "title": "Nombres premiers",
    "section": "",
    "text": "def crible_eratosthene(n):\n    \"\"\"G√©n√®re une liste de bool√©ens o√π True indique qu'un nombre est premier.\"\"\"\n\n    est_premier = [True] * (n + 1)\n    est_premier[0] = est_premier[1] = False  # 0 et 1 ne sont pas premiers\n\n    for i in range(2, int(n**0.5) + 1):\n        if est_premier[i]:\n            for multiple in range(i * i, n + 1, i):\n                est_premier[multiple] = False\n\n    return est_premier\nl = crible_eratosthene(100000)\n\ncpt = 0\nfor i in l[10000:]:\n    if i:\n        cpt += 1\n\nprint(cpt)\nl[8363]"
  },
  {
    "objectID": "doc/outils/tp-datalab-correction.html#fichier-des-communes",
    "href": "doc/outils/tp-datalab-correction.html#fichier-des-communes",
    "title": "Nombres premiers",
    "section": "1 Fichier des communes",
    "text": "1 Fichier des communes\n\nimport pandas as pd\n\n\nimport duckdb\n\nduckdb.sql(\"\"\"\nCREATE OR REPLACE VIEW commune AS\nFROM 'https://www.insee.fr/fr/statistiques/fichier/7766585/v_commune_2024.csv';\n\"\"\")\n\n\nduckdb.sql(\"\"\"\nSELECT *\n  FROM commune\n\"\"\").to_df()\n\n\nduckdb.sql(\"\"\"\nSELECT reg\n  FROM commune\n WHERE NCC = 'MAMOUDZOU';\n\"\"\").to_df()\n\n\nduckdb.sql(\"\"\"\nSELECT COUNT(1)\n  FROM commune\n WHERE dep = '973';\n\"\"\").to_df()\n\n\nduckdb.sql(\"\"\"\nSELECT COUNT(1)\n  FROM commune\n WHERE dep IN ('02','60','80')\n   AND NCC LIKE '%L%L%L%L%';\n\"\"\").to_df()\n\n\nduckdb.sql(\"\"\"\nSELECT dep,\n       COUNT(1) AS nb_communes,\n       RANK() OVER (ORDER BY COUNT(1) DESC) AS rang\n  FROM commune\n WHERE dep IS NOT NULL\n GROUP BY dep\nHAVING nb_communes &gt;= 500\n ORDER BY 2 DESC;\n\"\"\").to_df()\n\n\nduckdb.sql(\"\"\"\nSELECT dep\n  FROM commune\n WHERE LENGTH(ncc) = (SELECT max(LENGTH(ncc))\n                        FROM commune);\n\"\"\").to_df()"
  },
  {
    "objectID": "doc/outils/tp-datalab-correction.html#polars",
    "href": "doc/outils/tp-datalab-correction.html#polars",
    "title": "Nombres premiers",
    "section": "2 Polars",
    "text": "2 Polars\n\nimport os\nimport polars as pl\n\ns3_endpoint = f'https://{os.environ[\"AWS_S3_ENDPOINT\"]}'\ns3_access_key = os.environ[\"AWS_ACCESS_KEY_ID\"]\ns3_secret_access_key = os.environ[\"AWS_SECRET_ACCESS_KEY\"]\ns3_session_token = os.environ[\"AWS_SESSION_TOKEN\"]\ns3_region = os.environ[\"AWS_DEFAULT_REGION\"]\n\ns3_username = os.environ[\"VAULT_TOP_DIR\"] # un peu bancal pour avoir le username\n\n\ns3_file_path = f\"s3://{s3_username}/ENSAI/SQL/tp3-longueur-fil.parquet\"\n\nstorage_options = {\n    \"aws_endpoint\":  s3_endpoint,\n    \"aws_access_key_id\": s3_access_key,\n    \"aws_secret_access_key\": s3_secret_access_key,\n    \"aws_token\": s3_session_token,\n    \"aws_region\": s3_region\n  }\n\nfile = pl.scan_parquet(source=s3_file_path, \n                     storage_options=storage_options)\n\n\ndf = file.collect()\n\n\nprint(df)\n\n\ndf.filter(pl.col(\"vetement\") == \"gilet\")"
  },
  {
    "objectID": "doc/outils/tp-datalab-correction.html#diffusion",
    "href": "doc/outils/tp-datalab-correction.html#diffusion",
    "title": "Nombres premiers",
    "section": "3 Diffusion",
    "text": "3 Diffusion\n\nfichier_prenoms = pl.scan_parquet(source=\"s3://ldeneuville-ensai/diffusion/ENSAI/SQL-TP/prenoms-nat2022.parquet\", \n                               storage_options=storage_options)\n\n\ntop10f2021 = fichier_prenoms\\\n    .filter((pl.col(\"sexe\") == 2) & \n            (pl.col(\"annais\") == \"2021\") & \n            (pl.col(\"preusuel\") != \"_PRENOMS_RARES\"))\\\n    .group_by(\"preusuel\")\\\n    .agg(pl.col(\"nombre\").sum().alias(\"nombre_total\"))\\\n    .sort(\"nombre_total\", descending=True)\\\n    .limit(10)\\\n    .collect()\n\n\ntop10f2021\n\n\ntop10f2021_sql = fichier_prenoms\\\n    .sql(\"\"\"\n      SELECT preusuel, \n             SUM(nombre) AS nombre_total\n        FROM self\n       WHERE preusuel &lt;&gt; '_PRENOMS_RARES'\n         AND annais = '2021'\n         AND sexe = 2\n       GROUP BY preusuel\n       ORDER BY nombre_total DESC\n       LIMIT 10\n    \"\"\")\\\n    .collect()\n\ntop10f2021_sql\n\n\nprenom = \"Katia\"\nannee_debut, annee_fin = 1960, 1980\n\ndf_prenom_annee = fichier_prenoms\\\n    .filter((pl.col(\"preusuel\") == prenom.upper()) & \n            (pl.col(\"annais\").str.to_integer(strict=False).is_not_null()) &  # Convertir et exclure les nulls\n            (pl.col(\"annais\").str.to_integer(strict=False) &gt;= annee_debut) & \n            (pl.col(\"annais\").str.to_integer(strict=False) &lt;= annee_fin))\\\n    .group_by(\"annais\")\\\n    .agg(pl.col(\"nombre\").sum().alias(\"nombre_total\"))\\\n    .sort(\"annais\")\\\n    .collect()\n\nprint(df_prenom_annee)\n\n\nfichier_prenoms.sql(f\"\"\"\nSELECT annais, \n       SUM(nombre) AS nombre_total\n  FROM self\n WHERE preusuel = 'KATIA'\n   AND annais != 'XXXX' \n   AND annais BETWEEN '{annee_debut}' AND '{annee_fin}'\n GROUP BY annais\n ORDER BY annais;\n \"\"\").collect()\n\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Set seaborn style for a cleaner, more appealing look\nsns.set_theme(style=\"whitegrid\")\n\n# Create the plot\nfig, ax = plt.subplots(figsize=(10, 6))\n\n# Data\nyears = df_prenom_annee[\"annais\"].to_list()         # Extracts years as a list\ncounts = df_prenom_annee[\"nombre_total\"].to_list()  # Extracts counts as a list\n\n# Bar plot with custom colors and transparency for better visuals\nax.bar(years, \n       counts, \n       color=\"#4C72B0\", \n       edgecolor=\"black\", \n       alpha=0.8)\n\n# Set labels and title with padding for readability\nax.set_xlabel(\"Ann√©e\", fontsize=12, labelpad=10)\nax.set_ylabel(\"Nombre d'occurences\", fontsize=12, labelpad=10)\nax.set_title(f\"Occurrences du pr√©nom {prenom} par ann√©e ({annee_debut}-{annee_fin})\", fontsize=14, pad=15)\n\n# Rotate x-axis labels, improve spacing, and format grid\nax.tick_params(axis='x', rotation=45)\nplt.tight_layout()  # Adjust layout for tight fit\n\n# Display the plot\nplt.show()"
  },
  {
    "objectID": "doc/outils/tp-datalab-correction.html#le-pr√©nom",
    "href": "doc/outils/tp-datalab-correction.html#le-pr√©nom",
    "title": "Nombres premiers",
    "section": "4 Le pr√©nom",
    "text": "4 Le pr√©nom\n\nprenoms_feminins = fichier_prenoms.sql(f\"\"\"\nSELECT preusuel, \n       SUM(nombre) AS nombre_total\n  FROM self\n WHERE preusuel != '_PRENOMS_RARES'\n   AND annais != 'XXXX' \n   AND sexe = 2\n   AND annais BETWEEN '1970' AND '2000'\n GROUP BY preusuel\n ORDER BY nombre_total DESC,\n          preusuel DESC;\n \"\"\").collect()\n\n\n(8363 - 3) / 5\n\n\nprenoms_feminins.row(1672)\n\n\nprenoms_feminins.with_row_index()[1670:1680]"
  },
  {
    "objectID": "doc/outils/tp-datalab-correction.html#export",
    "href": "doc/outils/tp-datalab-correction.html#export",
    "title": "Nombres premiers",
    "section": "5 Export",
    "text": "5 Export\n\nimport s3fs\n\nfs = s3fs.S3FileSystem(\n    client_kwargs={'endpoint_url': 'https://'+'minio-simple.lab.groupe-genes.fr'},\n    key = os.environ[\"AWS_ACCESS_KEY_ID\"], \n    secret = os.environ[\"AWS_SECRET_ACCESS_KEY\"], \n    token = os.environ[\"AWS_SESSION_TOKEN\"])\n\ndestination = f\"s3://{s3_username}/ENSAI/SQL/output.csv\"\n\nwith fs.open(destination, mode='wb') as f:\n    top10f2021.write_csv(f)"
  },
  {
    "objectID": "doc/ressources.html",
    "href": "doc/ressources.html",
    "title": "Ressources",
    "section": "",
    "text": "https://sql.sh/\n\nLe coin stat\nSQL pour d√©butant en 7 vid√©os par Natacha Njongwa Yepnga"
  }
]